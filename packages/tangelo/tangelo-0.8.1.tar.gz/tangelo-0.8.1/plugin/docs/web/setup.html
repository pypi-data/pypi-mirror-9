<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Setup and Administration &mdash; Tangelo Web Framework 0.8.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.8.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/tangelo.ico"/>
    <link rel="top" title="Tangelo Web Framework 0.8.1 documentation" href="index.html" />
    <link rel="next" title="Basic Usage" href="basic-usage.html" />
    <link rel="prev" title="Installation" href="installation.html" />
<link rel=stylesheet type=text/css href=_static/tangelo-sphinx.css />

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="basic-usage.html" title="Basic Usage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Tangelo Web Framework 0.8.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="setup-and-administration">
<h1>Setup and Administration<a class="headerlink" href="#setup-and-administration" title="Permalink to this headline">¶</a></h1>
<p>While the <a class="reference internal" href="index.html#quickstart"><em>Quick Start</em></a> instructions will get you exploring the Tangelo
examples in just two commands, Tangelo has a rich set of configuration options
that can be used to administer Tangelo effectively.  This page will discuss
configuration and deployment strategies, including suggestions for best
practices.</p>
<div class="section" id="configuring-and-launching-tangelo">
<h2>Configuring and Launching Tangelo<a class="headerlink" href="#configuring-and-launching-tangelo" title="Permalink to this headline">¶</a></h2>
<p>The simplest way to launch a Tangelo server is to use this command:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">tangelo</span>
</pre></div>
</div>
<p>Tangelo&#8217;s runtime behaviors are specified via configuration file and command
line options.  Tangelo configuration files are YAML files representing a
key-value store (&#8220;associative array&#8221; in YAML jargon) at the top level.  Each
options is specified as a key-value pair:  the line starts with the name of the
key, then a colon followed by a space, and then the value.</p>
<p>The example configuration found at
<tt class="docutils literal"><span class="pre">/usr/share/tangelo/conf/tangelo.local.conf</span></tt> reads something like the
following:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">hostname</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.0.0.0</span>
<span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span>     <span class="l-Scalar-Plain">8080</span>
</pre></div>
</div>
<p>This minimal configuration file specifies that Tangelo should listen on all
interfaces for connections on port 8080.  By contrast, <tt class="docutils literal"><span class="pre">tangelo.conf.global</span></tt>
looks like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">hostname</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">0.0.0.0</span>
<span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span>     <span class="l-Scalar-Plain">80</span>

<span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span>     <span class="l-Scalar-Plain">nobody</span>
<span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span>    <span class="l-Scalar-Plain">nobody</span>
</pre></div>
</div>
<p>This configuration file is meant for the case when Tangelo is to be installed as
a system-level service.  It will run on port 80 (the standard port for an HTTP
server) and, though it will need to be started with superuser privileges, it
will drop those privleges to run as user <tt class="docutils literal"><span class="pre">nobody</span></tt> in group <tt class="docutils literal"><span class="pre">nobody</span></tt> to
prevent damage to the system should the process be, e.g., hijacked by an
attacker.</p>
<p>To run Tangelo using a particular configuration file, <tt class="docutils literal"><span class="pre">tangelo</span></tt> can be invoked
with the <tt class="docutils literal"><span class="pre">-c</span></tt> or <tt class="docutils literal"><span class="pre">--config</span></tt> option:</p>
<div class="highlight-python"><div class="highlight"><pre>tangelo -c ~/myconfig.yaml
</pre></div>
</div>
<p>When the flag is omitted, Tangelo will use default values for all
configuration options (see <a class="reference internal" href="#config-options"><em>Configuration Options</em></a> below).</p>
<p>Finally, all configuration options can also be specified on the command line.
This has the effect of overriding whatever value may be set in the specified
configuration file.  This can be useful for, e.g., using a single configuration
file for multiple Tangelo instances, but varying the port number.</p>
<div class="section" id="configuration-options">
<span id="config-options"></span><h3>Configuration Options<a class="headerlink" href="#configuration-options" title="Permalink to this headline">¶</a></h3>
<p>The following tables, organized by section title, show what fields can be
included in the configuration file, what they mean, and their default values if
left unspecified.</p>
<table border="1" class="docutils">
<colgroup>
<col width="14%" />
<col width="56%" />
<col width="30%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Meaning</th>
<th class="head">Default value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>hostname</td>
<td>The hostname interface on which to listen for connections</td>
<td><tt class="docutils literal"><span class="pre">localhost</span></tt></td>
</tr>
<tr class="row-odd"><td>port</td>
<td>The port number on which to listen for connections</td>
<td><tt class="docutils literal"><span class="pre">8080</span></tt></td>
</tr>
<tr class="row-even"><td>root</td>
<td>The path to the directory to be served by Tangelo as the web root</td>
<td><tt class="docutils literal"><span class="pre">/usr/share/tangelo/www</span></tt> <a class="footnote-reference" href="#root" id="id1">[1]</a></td>
</tr>
<tr class="row-odd"><td>drop-privileges</td>
<td>Whether to drop privileges when started as the superuser</td>
<td><tt class="docutils literal"><span class="pre">True</span></tt></td>
</tr>
<tr class="row-even"><td>sessions</td>
<td>Wehther to enable server-side session tracking</td>
<td><tt class="docutils literal"><span class="pre">True</span></tt></td>
</tr>
<tr class="row-odd"><td>user</td>
<td>The user account to drop privileges to</td>
<td><tt class="docutils literal"><span class="pre">nobody</span></tt> <a class="footnote-reference" href="#usergroup" id="id2">[2]</a></td>
</tr>
<tr class="row-even"><td>group</td>
<td>The user group to drop privileges to</td>
<td><tt class="docutils literal"><span class="pre">nobody</span></tt> <a class="footnote-reference" href="#usergroup" id="id3">[2]</a></td>
</tr>
<tr class="row-odd"><td>access-auth</td>
<td>Whether to protect directories containing a <tt class="docutils literal"><span class="pre">.htaccess</span></tt> file</td>
<td><tt class="docutils literal"><span class="pre">True</span></tt></td>
</tr>
<tr class="row-even"><td>key</td>
<td>The path to the SSL key</td>
<td><tt class="docutils literal"><span class="pre">None</span></tt> <a class="footnote-reference" href="#https" id="id4">[3]</a> <a class="footnote-reference" href="#unset" id="id5">[4]</a></td>
</tr>
<tr class="row-odd"><td>cert</td>
<td>The path to the SSL certificate</td>
<td><tt class="docutils literal"><span class="pre">None</span></tt> <a class="footnote-reference" href="#https" id="id6">[3]</a> <a class="footnote-reference" href="#unset" id="id7">[4]</a></td>
</tr>
</tbody>
</table>
<p class="rubric">Footnotes</p>
<table class="docutils footnote" frame="void" id="root" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The first component of this path may vary by platform.  Technically,
the path begins with the Python value stored in <tt class="docutils literal"><span class="pre">sys.prefix</span></tt>; in a Unix
system, this value is <em>/usr</em>, yielding the default path shown here.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="usergroup" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>)</em> Your Unix system may already have a user named &#8220;nobody&#8221; which
has the least possible level of permissions.  The theory is that system daemons
can be run as this user, limiting the damage a rogue process can do.  However,
if multiple daemons are run this way, any rogue daemon can theoretically gain
control of the others.  Therefore, the recommendation is to create a new user
named &#8220;tangelo&#8221;, that also has minimal permissions, but is only used to run
Tangelo in privilege drop mode.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="https" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id6">2</a>)</em> You must also specify both <em>key</em> and <em>cert</em> to serve content over
https.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="unset" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[4]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id7">2</a>)</em> That is to say, the option is simply unset by default, the
equivalent of not mentioning the option at all in a configuration file.</td></tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="administering-a-tangelo-installation">
<h2>Administering a Tangelo Installation<a class="headerlink" href="#administering-a-tangelo-installation" title="Permalink to this headline">¶</a></h2>
<p>Administering Tangelo on a particular system requires making some decisions
about how Tangelo ought to behave, then implementing those decisions in a
configuration file.</p>
<p>For example, as the system administrator you might create a directory on the web
server machine at <tt class="docutils literal"><span class="pre">/srv/tangelo</span></tt> which would serve as the web root, containing
the website front page and supporting materials.</p>
<p>You should then prepare a plugin configuration file that, at the very least,
activates the Tangelo plugin:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="l-Scalar-Plain">enabled</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">true</span>
<span class="l-Scalar-Plain">path</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/usr/share/tangelo/plugins/tangelo</span>
</pre></div>
</div>
<p>This file can be saved to <tt class="docutils literal"><span class="pre">/etc/tangelo/plugin.conf</span></tt>.</p>
<p>It remains to configure Tangelo itself.  The hostname should reflect the desired
external identity of the Tangelo server - perhaps <em>excelsior.starfleet.mil</em>.  As
this is a &#8220;global&#8221; deployment, we want to listen on port 80 for connections.
Since we will need to start Tangelo as root (to gain access to the low-numbered
ports), we should also specify a user and group to drop privileges to:  these
can be the specially created user and group <em>tangelo</em>.</p>
<p>The corresponding configuration file might look like this:</p>
<div class="highlight-yaml"><div class="highlight"><pre><span class="c1"># Network options.</span>
<span class="l-Scalar-Plain">hostname</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">excelsior.starfleet.mil</span>
<span class="l-Scalar-Plain">port</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">80</span>

<span class="c1"># Privilege drop options.</span>
<span class="l-Scalar-Plain">user</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tangelo</span>
<span class="l-Scalar-Plain">group</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">tangelo</span>

<span class="c1"># Runtime resources.</span>
<span class="l-Scalar-Plain">root</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">/srv/tangelo</span>
</pre></div>
</div>
<p>This file should be saved to <tt class="docutils literal"><span class="pre">/etc/tangelo.conf</span></tt>, and then Tangelo can be
launched with a command like <tt class="docutils literal"><span class="pre">tangelo</span> <span class="pre">-c</span> <span class="pre">/etc/tangelo.conf</span></tt> (the <tt class="docutils literal"><span class="pre">sudo</span></tt> may
be necessary to allow for port 80 to be bound).</p>
</div>
<div class="section" id="running-tangelo-as-a-system-service">
<h2>Running Tangelo as a System Service<a class="headerlink" href="#running-tangelo-as-a-system-service" title="Permalink to this headline">¶</a></h2>
<p>Tangelo does not include any mechanisms to self-daemonize, instead running in,
e.g., a terminal, putting all logging output on <tt class="docutils literal"><span class="pre">stdout</span></tt>, and offering no
facilities to track multiple instances by PID, etc.  However, the Tangelo
package includes some scripts and configurations for various system service
managers.  This section contains some instructions on working with the supported
managers.  If you would like a different system supported, send a message to
<cite>tangelo-users&#64;public.kitware.com</cite> or fork the <a class="reference external" href="https://github.com/Kitware/tangelo">GitHub repository</a> and send a pull request.</p>
<div class="section" id="systemd">
<h3>systemd<a class="headerlink" href="#systemd" title="Permalink to this headline">¶</a></h3>
<p><cite>systemd</cite> is a Linux service manager daemon for which a <cite>unit file</cite> corresponds
to each service.  Tangelo supplies such a unit file, along with supporting
scripts, at <tt class="docutils literal"><span class="pre">/usr/share/tangelo/daemon/systemd</span></tt>.  To install Tangelo as a
service, the files in this directory need to be copied or symlinked to a location
from which <cite>systemd</cite> can access them.  An example follows, though your particular
system may require some changes from what is shown here; see the <a class="reference external" href="http://www.freedesktop.org/wiki/Software/systemd/">systemd
documentation</a> for more
information.</p>
<p>Go to the place where systemd unit files are installed:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">systemd</span><span class="o">/</span><span class="n">system</span>
</pre></div>
</div>
<p>Place an appropriate symlink there:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo ln -s /usr/share/tangelo/daemon/systemd/system/tangelo@.service
</pre></div>
</div>
<p>Go to the systemd auxiliary scripts directory:</p>
<div class="highlight-python"><div class="highlight"><pre>cd ../scripts
</pre></div>
</div>
<p>Install a symlink to the launcher script:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo ln -s /usr/share/tangelo/daemon/systemd/scripts/launch-tangelo.sh
</pre></div>
</div>
<p>Now you will be able to control Tangelo via the <tt class="docutils literal"><span class="pre">systemctl</span></tt> command.
Note that the unit file defines Tangelo as an <cite>instantiated service</cite>, meaning
that multiple Tangelo instances can be launched independently by specifying an
instantiation name.  For example:</p>
<div class="highlight-python"><div class="highlight"><pre>sudo systemctl start tangelo@localhost:8080
</pre></div>
</div>
<p>will launch Tangelo to run on the <cite>localhost</cite> interface, on port 8080.  The way
this works is that <tt class="docutils literal"><span class="pre">systemctl</span></tt> takes the instantiation name (i.e., all the
text after the <tt class="docutils literal"><span class="pre">&#64;</span></tt> symbol - <em>localhost:8080</em>) and passes it to
<tt class="docutils literal"><span class="pre">launch-tangelo.sh</span></tt>.  It in turn parses the hostname (<em>localhost</em>) and port
number (<em>8080</em>) from the name, then launches Tangelo using whatever
configuration file is found at <tt class="docutils literal"><span class="pre">/etc/tangelo.conf</span></tt>, but overriding the
hostname and port with those parsed from the name.  This allows for a unique
name for each Tangelo instance that corresponds to its unique web interface.</p>
</div>
</div>
<div class="section" id="a-note-on-version-numbers">
<span id="versioning"></span><h2>A Note on Version Numbers<a class="headerlink" href="#a-note-on-version-numbers" title="Permalink to this headline">¶</a></h2>
<p>Tangelo uses <a class="reference external" href="http://semver.org/">semantic versioning</a> for its version
numbers, meaning that each release&#8217;s version number establishes a promise about
the levels of functionality and backwards compatibility present in that release.
Tangelo&#8217;s version numbers come in two forms: <em>x.y</em> and <em>x.y.z</em>.  <em>x</em> is a <em>major
version number</em>, <em>y</em> is a <em>minor version number</em>, and <em>z</em> is a <em>patch level</em>.</p>
<p>Following the semantic versioning approach, major versions represent a stable
API for the software as a whole.  If the major version number is incremented, it
means you can expect a discontinuity in backwards compatibility.  That is to
say, a setup that works for, e.g., version 1.3 will work for versions 1.4, 1.5,
and 1.10, but should not be expected to work with version 2.0.</p>
<p>The minor versions indicate new features or functionality added to the previous
version.  So, version 1.1 can be expected to contain some feature not found in
version 1.0, but backwards compatibility is ensured.</p>
<p>The patch level is incremented when a bug fix or other correction to the
software occurs.</p>
<p>Major version 0 is special: essentially, there are no guarantees about
compatibility in the 0.<em>y</em> series.  The stability of APIs and behaviors begins
with version 1.0.</p>
<p>In addition to the standard semantic versioning practices, Tangelo also tags the
current version number with &#8220;dev&#8221; in the Git repository, resulting in version
numbers like &#8220;1.1dev&#8221; for the Tangelo package that is built from source.  The
release protocol deletes this tag from the version number before uploading a
package to the Python Package Index.</p>
<p>The <tt class="xref js js-func docutils literal"><span class="pre">tangelo.requireCompatibleVersion()</span></tt> function returns a boolean
expressing whether the version number passed to it is compatible with Tangelo&#8217;s
current version.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Setup and Administration</a><ul>
<li><a class="reference internal" href="#configuring-and-launching-tangelo">Configuring and Launching Tangelo</a><ul>
<li><a class="reference internal" href="#configuration-options">Configuration Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#administering-a-tangelo-installation">Administering a Tangelo Installation</a></li>
<li><a class="reference internal" href="#running-tangelo-as-a-system-service">Running Tangelo as a System Service</a><ul>
<li><a class="reference internal" href="#systemd">systemd</a></li>
</ul>
</li>
<li><a class="reference internal" href="#a-note-on-version-numbers">A Note on Version Numbers</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="installation.html"
                        title="previous chapter">Installation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="basic-usage.html"
                        title="next chapter">Basic Usage</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/setup.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="basic-usage.html" title="Basic Usage"
             >next</a> |</li>
        <li class="right" >
          <a href="installation.html" title="Installation"
             >previous</a> |</li>
        <li><a href="index.html">Tangelo Web Framework 0.8.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Kitware, Inc..
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>