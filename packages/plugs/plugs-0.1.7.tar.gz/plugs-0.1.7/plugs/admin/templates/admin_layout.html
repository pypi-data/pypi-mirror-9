{{extend "layout.html"}}

{{block content}}
{{link "admin/admin.css"}}
{{
menu_items = [
    {'name': 'systems', 'title':'系统', 'link':'/systems'},
    {'name': 'assignments', 'title':'任务书', 'link':'/assignments?notcomplete=1'},
    {
    'name': 'target',
    'title':'目标管理',
    'subs':[
            {'name': 'requirements', 'title':'准开发需求', 'link':'/requirements'},
            {'name': 'assessment', 'title':'需求预评估单', 'link':'/assessment/list?status=1'},
            {'name': 'reviewsheet', 'title':'评审单', 'link':'/reviewsheet/list?status=1'},
            ]
    },
]
}}
{{def _sub_menu(menu_items, collapse=None, in_flag=False, id=None, items=()):
    if len(items) > 0:
        first = items[0]
        items = items[1:]
    else:
        first = None
        items = ()
    pass
    
    if collapse:
        attr = ' collapse'
        if in_flag:
            attr += ' in'
        pass
    else:
        attr = ''
    pass
    if id:
        id_attr = ' id="menu_%s"' % id
    else:
        id_attr = ''
    pass
    
    out.xml('<ul class="nav nav-list%s"%s>\n' % (attr, id_attr))
    for x in menu_items:
        if x['name'] == first:
            if not items:
                attr = ' class="active"'
                icon_white = ' icon-white'
                in_flag = False
            else:
                attr = ''
                icon_white = ''
                in_flag = True
            pass
        else:
            attr = ''
        pass
        if x.get('icon', ''):
            icon = '<i class="icon-%s %s"></i>' % (x.get('icon'), icon_white)
        else:
            icon = ''
        pass
        if x.get('subs', None):
            a_attr = ' data-toggle="collapse" data-target="#menu_%s"' % x['name']
            sub = '<i class="icon-chevron-right pull-right"></i>'
            link = '#'
        else:
            a_attr = ''
            sub = ''
            link = x.get('link', '#')
        pass
        out.xml('<li%s><a href="%s"%s>%s%s%s</a>' % (attr, link, a_attr, icon, x['title'], sub))
        if x.get('subs', None):
            _sub_menu(x['subs'], collapse=True, id=x['name'], in_flag=in_flag, items=items)
        pass
        out.xml('</li>\n')
    pass
    out.xml('</ul>\n')
    
pass
def sub_menu(menu_items, *items):
    _sub_menu(menu_items, items=items)
pass}}
<div class="row-fluid">
  <div class="span3">
    <div class="menu">
        <ul class="nav nav-list">
          <li class="active"><a href="#"><i class="icon-white"></i> Home</a></li>
          <li><a href="#"><i class="icon-book"></i> Library</a></li>
          <li><a href="#"><i class="icon-pencil"></i> Applications</a></li>
          <li><a href="#" data-toggle="collapse" data-target="#demo"> Misc<i class="icon-chevron-right pull-right"></i></a>
            <ul class="nav nav-list collapse" id="demo">
              <li class="active"><a href="#"><i class="icon-home icon-white"></i> Home</a></li>
              <li><a href="#"><i class="icon-book"></i> Library</a></li>
              <li><a href="#"><i class="icon-pencil"></i> Applications</a></li>
              <li><a href="#"><i class="i"></i> Misc</a></li>
            </ul>
          </li>
        </ul>
        {{sub_menu(menu_items, 'systems')}}
    </div>
  </div>
  <div class="span9">
    <div class="content-outter">
    xxxxxx
    </div>
  </div>
</div>
{{end}}