tinymce.PluginManager.add("preview",function(e){var d=e.settings,f=!tinymce.Env.ie;e.addCommand("mcePreview",function(){e.windowManager.open({title:"Preview",width:parseInt(e.getParam("plugin_preview_width","650"),10),height:parseInt(e.getParam("plugin_preview_height","500"),10),html:'<iframe src="javascript:\'\'" frameborder="0"'+(f?' sandbox="allow-scripts"':"")+"></iframe>",buttons:{text:"Close",onclick:function(){this.parent().parent().close()}},onPostRender:function(){var l,k="";k+='<base href="'+e.documentBaseURI.getURI()+'">',tinymce.each(e.contentCSS,function(g){k+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(g)+'">'});var j=d.body_id||"tinymce";-1!=j.indexOf("=")&&(j=e.getParam("body_id","","hash"),j=j[e.id]||j);var c=d.body_class||"";-1!=c.indexOf("=")&&(c=e.getParam("body_class","","hash"),c=c[e.id]||"");var b=e.settings.directionality?' dir="'+e.settings.directionality+'"':"";if(l="<!DOCTYPE html><html><head>"+k+'</head><body id="'+j+'" class="mce-content-body '+c+'"'+b+">"+e.getContent()+"</body></html>",f){this.getEl("body").firstChild.src="data:text/html;charset=utf-8,"+encodeURIComponent(l)}else{var a=this.getEl("body").firstChild.contentWindow.document;a.open(),a.write(l),a.close()}}})}),e.addButton("preview",{title:"Preview",cmd:"mcePreview"}),e.addMenuItem("preview",{text:"Preview",cmd:"mcePreview",context:"view"})});