!function(i,h){function n(g,e){for(var q,p=[],o=0;o<g.length;++o){if(q=j[g[o]]||l(g[o]),!q){throw"module definition dependecy not found: "+g[o]}p.push(q)}e.apply(null,p)}function m(b,f,c){if("string"!=typeof b){throw"invalid module definition, module id must be defined and be a string"}if(f===h){throw"invalid module definition, dependencies must be specified"}if(c===h){throw"invalid module definition, definition function must be specified"}n(f,function(){j[b]=c.apply(null,arguments)})}function l(a){for(var o=i,g=a.split(/[.\/]/),f=0;f<g.length;++f){if(!o[g[f]]){return}o=o[g[f]]}return o}function k(q){for(var p=0;p<q.length;p++){for(var o=i,g=q[p],b=g.split(/[.\/]/),a=0;a<b.length-1;++a){o[b[a]]===h&&(o[b[a]]={}),o=o[b[a]]}o[b[b.length-1]]=j[g]}}var j={};m("tinymce/spellcheckerplugin/DomTextMatcher",[],function(){return function(ab,aa){function Z(d,c){if(!d[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}return{start:d.index,end:d.index+d[0].length,text:d[0],data:c}}function Y(d){var c;if(3===d.nodeType){return d.data}if(D[d.nodeName]&&!E[d.nodeName]){return""}if(c="",(E[d.nodeName]||C[d.nodeName])&&(c+="\n"),d=d.firstChild){do{c+=Y(d)}while(d=d.nextSibling)}return c}function X(z,y,x){var w,v,u,t,s,r=[],q=0,p=z,o=0;y=y.slice(0),y.sort(function(d,c){return d.start-c.start}),s=y.shift();z:for(;;){if((E[p.nodeName]||C[p.nodeName])&&q++,3===p.nodeType&&(!v&&p.length+q>=s.end?(v=p,t=s.end-q):w&&r.push(p),!w&&p.length+q>s.start&&(w=p,u=s.start-q),q+=p.length),w&&v){if(p=x({startNode:w,startNodeIndex:u,endNode:v,endNodeIndex:t,innerNodes:r,match:s.text,matchIndex:o}),q-=v.length-t,w=null,v=null,r=[],s=y.shift(),o++,!s){break}}else{if((!D[p.nodeName]||E[p.nodeName])&&p.firstChild){p=p.firstChild;continue}if(p.nextSibling){p=p.nextSibling;continue}}for(;;){if(p.nextSibling){p=p.nextSibling;break}if(p.parentNode===z){break z}p=p.parentNode}}}function W(d){function c(a,o){var g=B[o];g.stencil||(g.stencil=d(g));var f=g.stencil.cloneNode(!1);return f.setAttribute("data-mce-index",o),a&&f.appendChild(L.doc.createTextNode(a)),f}return function(ai){var ah,ag,af,ae=ai.startNode,ad=ai.endNode,ac=ai.matchIndex,A=L.doc;if(ae===ad){var z=ae;af=z.parentNode,ai.startNodeIndex>0&&(ah=A.createTextNode(z.data.substring(0,ai.startNodeIndex)),af.insertBefore(ah,z));var y=c(ai.match,ac);return af.insertBefore(y,z),ai.endNodeIndex<z.length&&(ag=A.createTextNode(z.data.substring(ai.endNodeIndex)),af.insertBefore(ag,z)),z.parentNode.removeChild(z),y}ah=A.createTextNode(ae.data.substring(0,ai.startNodeIndex)),ag=A.createTextNode(ad.data.substring(ai.endNodeIndex));for(var x=c(ae.data.substring(ai.startNodeIndex),ac),w=[],v=0,u=ai.innerNodes.length;u>v;++v){var t=ai.innerNodes[v],s=c(t.data,ac);t.parentNode.replaceChild(s,t),w.push(s)}var b=c(ad.data.substring(0,ai.endNodeIndex),ac);return af=ae.parentNode,af.insertBefore(ah,ae),af.insertBefore(x,ae),af.removeChild(ae),af=ad.parentNode,af.insertBefore(b,ad),af.insertBefore(ag,ad),af.removeChild(ad),b}}function V(d){var c=d.parentNode;c.insertBefore(d.firstChild,d),d.parentNode.removeChild(d)}function U(a){var s=ab.getElementsByTagName("*"),r=[];a="number"==typeof a?""+a:null;for(var q=0;q<s.length;q++){var p=s[q],o=p.getAttribute("data-mce-index");null!==o&&o.length&&(o===a||null===a)&&r.push(p)}return r}function T(d){for(var c=B.length;c--;){if(B[c]===d){return c}}return -1}function S(d){var c=[];return R(function(b,a){d(b,a)&&c.push(b)}),B=c,this}function R(e){for(var d=0,f=B.length;f>d&&e(B[d],d)!==!1;d++){}return this}function Q(a){return B.length&&X(ab,B,W(a)),this}function P(d,c){if(F&&d.global){for(;G=d.exec(F);){B.push(Z(G,c))}}return this}function O(e){var d,f=U(e?T(e):null);for(d=f.length;d--;){V(f[d])}return this}function N(b){return B[b.getAttribute("data-mce-index")]}function M(b){return U(T(b))[0]}function K(e,d,f){return B.push({start:e,end:e+d,text:F.substr(e,d),data:f}),this}function J(b){var f=U(T(b)),e=aa.dom.createRng();return e.setStartBefore(f[0]),e.setEndAfter(f[f.length-1]),e}function I(b,f){var e=J(b);return e.deleteContents(),f.length>0&&e.insertNode(aa.dom.doc.createTextNode(f)),e}function H(){return B.splice(0,B.length),O(),this}var G,F,E,D,C,B=[],L=aa.dom;return E=aa.schema.getBlockElements(),D=aa.schema.getWhiteSpaceElements(),C=aa.schema.getShortEndedElements(),F=Y(ab),{text:F,matches:B,each:R,filter:S,reset:H,matchFromElement:N,elementFromMatch:M,find:P,add:K,wrap:Q,unwrap:O,replace:I,rangeFromMatch:J,indexOf:T}}}),m("tinymce/spellcheckerplugin/Plugin",["tinymce/spellcheckerplugin/DomTextMatcher","tinymce/PluginManager","tinymce/util/Tools","tinymce/ui/Menu","tinymce/dom/DOMUtils","tinymce/util/XHR","tinymce/util/URI","tinymce/util/JSON"],function(p,o,v,u,t,s,r,q){o.add("spellchecker",function(ac,ab){function aa(){return L.textMatcher||(L.textMatcher=new p(ac.getBody(),ac)),L.textMatcher}function Z(x,w){var y=[];return v.each(w,function(b){y.push({selectable:!0,text:b.name,data:b.value})}),y}function Y(x){for(var w in x){return !1}return !0}function X(b,B){var A=[],z=T[b];v.each(z,function(C){A.push({text:C,onclick:function(){ac.insertContent(ac.dom.encode(C)),ac.dom.remove(B),Q()}})}),A.push({text:"-"}),N&&A.push({text:"Add to Dictionary",onclick:function(){O(b,B)}}),A.push.apply(A,[{text:"Ignore",onclick:function(){M(b,B)}},{text:"Ignore all",onclick:function(){M(b,B,!0)}}]),P=new u({items:A,context:"contextmenu",onautohide:function(C){-1!=C.target.className.indexOf("spellchecker")&&C.preventDefault()},onhide:function(){P.remove(),P=null}}),P.renderTo(document.body);var y=t.DOM.getPos(ac.getContentAreaContainer()),x=ac.dom.getPos(B[0]),w=ac.dom.getRoot();"BODY"==w.nodeName?(x.x-=w.ownerDocument.documentElement.scrollLeft||w.scrollLeft,x.y-=w.ownerDocument.documentElement.scrollTop||w.scrollTop):(x.x-=w.scrollLeft,x.y-=w.scrollTop),y.x+=x.x,y.y+=x.y,P.moveTo(y.x,y.y+B[0].offsetHeight)}function W(){return ac.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`\xa7\xa9\xab\xae\xb1\xb6\xb7\xb8\xbb\xbc\xbd\xbe\xbf\xd7\xf7\xa4\u201d\u201c\u201e\xa0\u2002\u2003\u2009]+',"g")}function V(x,w,B,A){var z={method:x},y="";"spellcheck"==x&&(z.text=w,z.lang=J.spellchecker_language),"addToDictionary"==x&&(z.word=w),v.each(z,function(D,C){y&&(y+="&"),y+=C+"="+encodeURIComponent(D)}),s.send({url:new r(ab).toAbsolute(J.spellchecker_rpc_url),type:"post",content_type:"application/x-www-form-urlencoded",data:y,success:function(b){b=q.parse(b),b?b.error?A(b.error):B(b):A("Sever response wasn't proper JSON.")},error:function(D,C){A("Spellchecker request error: "+C.status)}})}function U(x,w,A,z){var y=J.spellchecker_callback||V;y.call(L,x,w,A,z)}function S(){function b(w){ac.windowManager.alert(w),ac.setProgressState(!1),K()}return R?void K():(K(),ac.setProgressState(!0),U("spellcheck",aa().text,c,b),void ac.focus())}function Q(){ac.dom.select("span.mce-spellchecker-word").length||K()}function O(b,w){ac.setProgressState(!0),U("addToDictionary",b,function(){ac.setProgressState(!1),ac.dom.remove(w,!0),Q()},function(x){ac.windowManager.alert(x),ac.setProgressState(!1)})}function M(b,x,w){ac.selection.collapse(),w?v.each(ac.dom.select("span.mce-spellchecker-word"),function(y){y.getAttribute("data-mce-word")==b&&ac.dom.remove(y,!0)}):ac.dom.remove(x,!0),Q()}function K(){aa().reset(),L.textMatcher=null,R&&(R=!1,ac.fire("SpellcheckEnd"))}function I(x){var w=x.getAttribute("data-mce-index");return"number"==typeof w?""+w:w}function f(b){var z,y=[];if(z=v.toArray(ac.getBody().getElementsByTagName("span")),z.length){for(var x=0;x<z.length;x++){var w=I(z[x]);null!==w&&w.length&&w===b.toString()&&y.push(z[x])}}return y}function d(x){var w=J.spellchecker_language;x.control.items().each(function(b){b.active(b.settings.data===w)})}function c(b){var w;return b.words?(N=!!b.dictionary,w=b.words):w=b,ac.setProgressState(!1),Y(w)?(ac.windowManager.alert("No misspellings found"),void (R=!1)):(T=w,aa().find(W()).filter(function(x){return !!w[x.text]}).wrap(function(x){return ac.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1,"data-mce-word":x.text})}),R=!0,void ac.fire("SpellcheckStart"))}var a,T,R,P,N,L=this,J=ac.settings,g=J.spellchecker_languages||"English=en,Danish=da,Dutch=nl,Finnish=fi,French=fr_FR,German=de,Italian=it,Polish=pl,Portuguese=pt_BR,Spanish=es,Swedish=sv";a=Z("Language",v.map(g.split(","),function(b){return b=b.split("="),{name:b[0],value:b[1]}})),ac.on("click",function(b){var y=b.target;if("mce-spellchecker-word"==y.className){b.preventDefault();var x=f(I(y));if(x.length>0){var w=ac.dom.createRng();w.setStartBefore(x[0]),w.setEndAfter(x[x.length-1]),ac.selection.setRng(w),X(y.getAttribute("data-mce-word"),x)}}}),ac.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:S,selectable:!0,onPostRender:function(){var b=this;b.active(R),ac.on("SpellcheckStart SpellcheckEnd",function(){b.active(R)})}});var e={tooltip:"Spellcheck",onclick:S,onPostRender:function(){var b=this;ac.on("SpellcheckStart SpellcheckEnd",function(){b.active(R)})}};a.length>1&&(e.type="splitbutton",e.menu=a,e.onshow=d,e.onselect=function(b){J.spellchecker_language=b.control.settings.data}),ac.addButton("spellchecker",e),ac.addCommand("mceSpellCheck",S),ac.on("remove",function(){P&&(P.remove(),P=null)}),ac.on("change",Q),this.getTextMatcher=aa,this.getWordCharPattern=W,this.markErrors=c,this.getLanguage=function(){return J.spellchecker_language},J.spellchecker_language=J.spellchecker_language||J.language||"en"})}),k(["tinymce/spellcheckerplugin/DomTextMatcher"])}(this);