!function(i,h){function n(g,e){for(var q,p=[],o=0;o<g.length;++o){if(q=j[g[o]]||l(g[o]),!q){throw"module definition dependecy not found: "+g[o]}p.push(q)}e.apply(null,p)}function m(b,f,c){if("string"!=typeof b){throw"invalid module definition, module id must be defined and be a string"}if(f===h){throw"invalid module definition, dependencies must be specified"}if(c===h){throw"invalid module definition, definition function must be specified"}n(f,function(){j[b]=c.apply(null,arguments)})}function l(a){for(var o=i,g=a.split(/[.\/]/),f=0;f<g.length;++f){if(!o[g[f]]){return}o=o[g[f]]}return o}function k(q){for(var p=0;p<q.length;p++){for(var o=i,g=q[p],b=g.split(/[.\/]/),a=0;a<b.length-1;++a){o[b[a]]===h&&(o[b[a]]={}),o=o[b[a]]}o[b[b.length-1]]=j[g]}}var j={};m("tinymce/pasteplugin/Utils",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema"],function(o,g,s){function r(a,d){return o.each(d,function(b){a=b.constructor==RegExp?a.replace(b,""):a.replace(b[0],b[1])}),a}function q(w){function v(f){var e=f.name,x=f;if("br"===e){return void (d+="\n")}if(c[e]&&(d+=" "),b[e]){return void (d+=" ")}if(3==f.type&&(d+=f.value),!f.shortEnded&&(f=f.firstChild)){do{v(f)}while(f=f.next)}a[e]&&x.next&&(d+="\n","p"==e&&(d+="\n"))}var u=new s,t=new g({},u),d="",c=u.getShortEndedElements(),b=o.makeMap("script noscript style textarea video audio iframe object"," "),a=u.getBlockElements();return w=r(w,[/<!\[[^\]]+\]>/g]),v(t.parse(w)),d}function p(d){function c(f,e,t){return e||t?"\xa0":" "}return d=r(d,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,c],/<br>$/i])}return{filter:r,innerText:q,trimHtml:p}}),m("tinymce/pasteplugin/Clipboard",["tinymce/Env","tinymce/util/VK","tinymce/pasteplugin/Utils"],function(e,d,f){return function(P){function O(o){var g,q=P.dom;if(g=P.fire("BeforePastePreProcess",{content:o}),g=P.fire("PastePreProcess",g),o=g.content,!g.isDefaultPrevented()){if(P.hasEventListeners("PastePostProcess")&&!g.isDefaultPrevented()){var p=q.add(P.getBody(),"div",{style:"display:none"},o);g=P.fire("PastePostProcess",{node:p}),q.remove(p),o=g.node.innerHTML}g.isDefaultPrevented()||P.insertContent(o,{merge:P.settings.paste_merge_formats!==!1})}}function N(p){p=P.dom.encode(p).replace(/\r\n/g,"\n");var o,r=P.dom.getParent(P.selection.getStart(),P.dom.isBlock),q=P.settings.forced_root_block;q&&(o=P.dom.createHTML(q,P.settings.forced_root_block_attrs),o=o.substr(0,o.length-3)+">"),r&&/^(PRE|DIV)$/.test(r.nodeName)||!q?p=f.filter(p,[[/\n/g,"<br>"]]):(p=f.filter(p,[[/\n\n/g,"</p>"+o],[/^(.*<\/p>)(<p>)$/,o+"$1"],[/\n/g,"<br />"]]),-1!=p.indexOf("<p>")&&(p=o+p)),O(p)}function M(){function w(x){var g,S,R,Q=x.startContainer;if(g=x.getClientRects(),g.length){return g[0]}if(x.collapsed&&1==Q.nodeType){for(R=Q.childNodes[A.startOffset];R&&3==R.nodeType&&!R.data.length;){R=R.nextSibling}if(R){return"BR"==R.tagName&&(S=u.doc.createTextNode("\ufeff"),R.parentNode.insertBefore(S,R),x=u.createRng(),x.setStartBefore(S),x.setEndAfter(S),g=x.getClientRects(),u.remove(S)),g.length?g[0]:void 0}}}var v,u=P.dom,t=P.getBody(),s=P.dom.getViewPort(P.getWin()),r=s.y,q=20;if(A=P.selection.getRng(),P.inline&&(v=P.selection.getScrollContainer(),v&&v.scrollTop>0&&(r=v.scrollTop)),A.getClientRects){var p=w(A);if(p){q=r+(p.top-u.getPos(t).y)}else{q=r;var o=A.startContainer;o&&(3==o.nodeType&&o.parentNode!=t&&(o=o.parentNode),1==o.nodeType&&(q=u.getPos(o,v||t).y))}}B=u.add(P.getBody(),"div",{id:"mcepastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: absolute; top: "+q+"px;width: 10px; height: 10px; overflow: hidden; opacity: 0"},a),(e.ie||e.gecko)&&u.setStyle(B,"left","rtl"==u.getStyle(t,"direction",!0)?65535:-65535),u.bind(B,"beforedeactivate focusin focusout",function(g){g.stopPropagation()}),B.focus(),P.selection.select(B,!0)}function L(){if(B){for(var g;g=P.dom.get("mcepastebin");){P.dom.remove(g),P.dom.unbind(g)}A&&P.selection.setRng(A)}B=A=null}function K(){var o,g,r,q,p="";for(o=P.dom.select("div[id=mcepastebin]"),g=0;g<o.length;g++){r=o[g],r.firstChild&&"mcepastebin"==r.firstChild.id&&(r=r.firstChild),q=r.innerHTML,p!=a&&(p+=q)}return p}function J(o){var g={};if(o){if(o.getData){var r=o.getData("Text");r&&r.length>0&&(g["text/plain"]=r)}if(o.types){for(var q=0;q<o.types.length;q++){var p=o.types[q];g[p]=o.getData(p)}}}return g}function I(g){return J(g.clipboardData||P.getDoc().dataTransfer)}function H(o,g){function q(v){function u(){g&&(P.selection.setRng(g),g=null),O('<img src="'+r.result+'">')}var t,s,r;if(v){for(t=0;t<v.length;t++){if(s=v[t],/^image\/(jpeg|png|gif)$/.test(s.type)){return r=new FileReader,r.onload=u,r.readAsDataURL(s.getAsFile?s.getAsFile():s),o.preventDefault(),!0}}}}var p=o.clipboardData||o.dataTransfer;return P.settings.paste_data_images&&p?q(p.items)||q(p.files):void 0}function G(o){var g=o.clipboardData;return -1!=navigator.userAgent.indexOf("Android")&&g&&g.items&&0===g.items.length}function F(o){var g,r,q=P.getDoc();if(q.caretPositionFromPoint){r=q.caretPositionFromPoint(o.clientX,o.clientY),g=q.createRange(),g.setStart(r.offsetNode,r.offset),g.collapse(!0)}else{if(q.caretRangeFromPoint){g=q.caretRangeFromPoint(o.clientX,o.clientY)}else{if(q.body.createTextRange){g=q.body.createTextRange();try{g.moveToPoint(o.clientX,o.clientY),g.collapse(!0)}catch(p){g.collapse(o.clientY<q.body.clientHeight)}}}}return g}function E(o,g){return g in o&&o[g].length>0}function D(g){return d.metaKeyPressed(g)&&86==g.keyCode||g.shiftKey&&45==g.keyCode}function C(){P.on("keydown",function(g){function o(p){D(p)&&!p.isDefaultPrevented()&&L()}if(D(g)&&!g.isDefaultPrevented()){if(z=g.shiftKey&&86==g.keyCode,z&&e.webkit&&-1!=navigator.userAgent.indexOf("Version/")){return}if(g.stopImmediatePropagation(),c=(new Date).getTime(),e.ie&&z){return g.preventDefault(),void P.fire("paste",{ieFake:!0})}L(),M(),P.once("keyup",o),P.once("paste",function(){P.off("keyup",o)})}}),P.on("paste",function(g){var o=(new Date).getTime(),v=I(g),u=(new Date).getTime()-o,t=(new Date).getTime()-c-u<1000,r="text"==y.pasteFormat||z;return z=!1,g.isDefaultPrevented()||G(g)?void L():H(g)?void L():(t||g.preventDefault(),!e.ie||t&&!g.ieFake||(M(),P.dom.bind(B,"paste",function(p){p.stopPropagation()}),P.getDoc().execCommand("Paste",!1,null),v["text/html"]=K()),void setTimeout(function(){var p;return E(v,"text/html")?p=v["text/html"]:(p=K(),p==a&&(r=!0)),p=f.trimHtml(p),B&&B.firstChild&&"mcepastebin"===B.firstChild.id&&(r=!0),L(),p.length||(r=!0),r&&(p=E(v,"text/plain")&&-1==p.indexOf("</p>")?v["text/plain"]:f.innerText(p)),p==a?void (t||P.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents.")):void (r?N(p):O(p))},0))}),P.on("dragstart dragend",function(g){b="dragstart"==g.type}),P.on("drop",function(p){var o=F(p);if(!p.isDefaultPrevented()&&!b&&!H(p,o)&&o&&P.settings.paste_filter_drop!==!1){var r=J(p.dataTransfer),q=r["mce-internal"]||r["text/html"]||r["text/plain"];q&&(p.preventDefault(),P.undoManager.transact(function(){r["mce-internal"]&&P.execCommand("Delete"),P.selection.setRng(o),q=f.trimHtml(q),r["text/html"]?O(q):N(q)}))}}),P.on("dragover dragend",function(o){var g,p=o.dataTransfer;if(P.settings.paste_data_images&&p){for(g=0;g<p.types.length;g++){if("Files"==p.types[g]){return o.preventDefault(),!1}}}})}var B,A,z,y=this,c=0,b=!1,a="%MCEPASTEBIN%";y.pasteHtml=O,y.pasteText=N,P.on("preInit",function(){C(),P.parser.addNodeFilter("img",function(g){if(!P.settings.paste_data_images){for(var p=g.length;p--;){var o=g[p].attributes.map.src;o&&/^(data:image|webkit\-fake\-url)/.test(o)&&(g[p].attr("data-mce-object")||o===e.transparentSrc||g[p].remove())}}})})}}),m("tinymce/pasteplugin/WordFilter",["tinymce/util/Tools","tinymce/html/DomParser","tinymce/html/Schema","tinymce/html/Serializer","tinymce/html/Node","tinymce/pasteplugin/Utils"],function(x,w,v,u,t,s){function r(b){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(b)||/class="OutlineElement/.test(b)||/id="?docs\-internal\-guid\-/.test(b)}function q(a){var f,e;return e=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],a=a.replace(/^[\u00a0 ]+/,""),x.each(e,function(b){return b.test(a)?(f=!0,!1):void 0}),f}function p(b){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u00d8\u25CF]\s*/.test(b)}function o(b){var a=b.settings;b.on("BeforePastePreProcess",function(z){function y(Q){function P(R){var S="";if(3===R.type){return R.value}if(R=R.firstChild){do{S+=P(R)}while(R=R.next)}return S}function O(S,R){if(3===S.type&&R.test(S.value)){return S.value=S.value.replace(R,""),!1}if(S=S.firstChild){do{if(!O(S,R)){return !1}}while(S=S.next)}return !0}function N(R){if(R._listIgnore){return void R.remove()}if(R=R.firstChild){do{N(R)}while(R=R.next)}}function M(S,R,U){var T=S._listLevel||J;T!=J&&(J>T?L&&(L=L.parent.parent):(K=L,L=null)),L&&L.name==R?L.append(S):(K=K||L,L=new t(R,1),U>1&&L.attr("start",""+U),S.wrap(L)),S.name="li",T>J&&K&&K.lastChild.append(L),J=T,N(S),O(S,/^\u00a0+/),O(S,/^\s*([\u2022\u00b7\u00a7\u00d8\u25CF]|\w+\.)/),O(S,/^\u00a0+/)}for(var L,K,J=1,I=[],H=Q.firstChild;"undefined"!=typeof H&&null!==H;){if(I.push(H),H=H.walk(),null!==H){for(;"undefined"!=typeof H&&H.parent!==Q;){H=H.walk()}}}for(var G=0;G<I.length;G++){if(Q=I[G],"p"==Q.name&&Q.firstChild){var F=P(Q);if(p(F)){M(Q,"ul");continue}if(q(F)){var E=/([0-9]+)\./.exec(F),D=1;E&&(D=parseInt(E[1],10)),M(Q,"ol",D);continue}if(Q._listLevel){M(Q,"ul",1);continue}L=null}else{K=L,L=null}}}function g(D,H){var G,F={},E=b.dom.parseStyle(H);return x.each(E,function(I,J){switch(J){case"mso-list":G=/\w+ \w+([0-9]+)/i.exec(H),G&&(D._listLevel=parseInt(G[1],10)),/Ignore/i.test(I)&&D.firstChild&&(D._listIgnore=!0,D.firstChild._listIgnore=!0);break;case"horiz-align":J="text-align";break;case"vert-align":J="vertical-align";break;case"font-color":case"mso-foreground":J="color";break;case"mso-background":case"mso-highlight":J="background";break;case"font-weight":case"font-style":return void ("normal"!=I&&(F[J]=I));case"mso-element":if(/^(comment|comment-list)$/i.test(I)){return void D.remove()}}return 0===J.indexOf("mso-comment")?void D.remove():void (0!==J.indexOf("mso-")&&("all"==f||e&&e[J])&&(F[J]=I))}),/(bold)/i.test(F["font-weight"])&&(delete F["font-weight"],D.wrap(new t("b",1))),/(italic)/i.test(F["font-style"])&&(delete F["font-style"],D.wrap(new t("i",1))),F=b.dom.serializeStyle(F,D.name),F?F:null}var f,e,d=z.content;if(f=a.paste_retain_style_properties,f&&(e=x.makeMap(f.split(/[, ]/))),a.paste_enable_default_filters!==!1&&r(z.content)){z.wordContent=!0,d=s.filter(d,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\xa0"],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(E,D){return D.length>0?D.replace(/./," ").slice(Math.floor(D.length/2)).split("").join("\xa0"):""}]]);var c=a.paste_word_valid_elements;c||(c="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");var C=new v({valid_elements:c,valid_children:"-li[p]"});x.each(C.elements,function(D){D.attributes["class"]||(D.attributes["class"]={},D.attributesOrder.push("class")),D.attributes.style||(D.attributes.style={},D.attributesOrder.push("style"))});var B=new w({},C);B.addAttributeFilter("style",function(E){for(var D,F=E.length;F--;){D=E[F],D.attr("style",g(D,D.attr("style"))),"span"==D.name&&D.parent&&!D.attributes.length&&D.unwrap()}}),B.addAttributeFilter("class",function(E){for(var D,G,F=E.length;F--;){D=E[F],G=D.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel|MsoCaption)$/i.test(G)&&D.remove(),D.attr("class",null)}}),B.addNodeFilter("del",function(E){for(var D=E.length;D--;){E[D].remove()}}),B.addNodeFilter("a",function(E){for(var D,H,G,F=E.length;F--;){if(D=E[F],H=D.attr("href"),G=D.attr("name"),H&&-1!=H.indexOf("#_msocom_")){D.remove()}else{if(H&&0===H.indexOf("file://")&&(H=H.split("#")[1],H&&(H="#"+H)),H||G){if(G&&!/^_?(?:toc|edn|ftn)/i.test(G)){D.unwrap();continue}D.attr({href:H,name:G})}else{D.unwrap()}}}});var A=B.parse(d);a.paste_convert_word_fake_lists!==!1&&y(A),z.content=new u({},C).serialize(A)}})}return o.isWordContent=r,o}),m("tinymce/pasteplugin/Quirks",["tinymce/Env","tinymce/util/Tools","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Utils"],function(f,e,o,g){return function(d){function c(p){d.on("BeforePastePreProcess",function(q){q.content=p(q.content)})}function b(p){if(!o.isWordContent(p)){return p}var r=[];e.each(d.schema.getBlockElements(),function(t,s){r.push(s)});var q=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+r.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return p=g.filter(p,[[q,"$1"]]),p=g.filter(p,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function a(q){if(o.isWordContent(q)){return q}var p=d.settings.paste_webkit_styles;if(d.settings.paste_remove_styles_if_webkit===!1||"all"==p){return q}if(p&&(p=p.split(/[, ]/)),p){var s=d.dom,r=d.selection.getNode();q=q.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(B,A,z,y){var x=s.parseStyle(z,"span"),w={};if("none"===p){return A+y}for(var v=0;v<p.length;v++){var u=x[p[v]],t=s.getStyle(r,p[v],!0);/color/.test(p[v])&&(u=s.toHex(u),t=s.toHex(t)),t!=u&&(w[p[v]]=u)}return w=s.serializeStyle(w,"span"),w?A+' style="'+w+'"'+y:A+y})}else{q=q.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3")}return q=q.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(u,t,w,v){return t+' style="'+w+'"'+v})}f.webkit&&c(a),f.ie&&c(b)}}),m("tinymce/pasteplugin/Plugin",["tinymce/PluginManager","tinymce/pasteplugin/Clipboard","tinymce/pasteplugin/WordFilter","tinymce/pasteplugin/Quirks"],function(g,f,q,p){var o;g.add("paste",function(b){function r(){"text"==e.pasteFormat?(this.active(!1),e.pasteFormat="html"):(e.pasteFormat="text",this.active(!0),o||(b.windowManager.alert("Paste is now in plain text mode. Contents will now be pasted as plain text until you toggle this option off."),o=!0))}var e,d=this,c=b.settings;d.clipboard=e=new f(b),d.quirks=new p(b),d.wordFilter=new q(b),b.settings.paste_as_text&&(d.clipboard.pasteFormat="text"),c.paste_preprocess&&b.on("PastePreProcess",function(s){c.paste_preprocess.call(d,d,s)}),c.paste_postprocess&&b.on("PastePostProcess",function(s){c.paste_postprocess.call(d,d,s)}),b.addCommand("mceInsertClipboardContent",function(t,s){s.content&&d.clipboard.pasteHtml(s.content),s.text&&d.clipboard.pasteText(s.text)}),b.paste_block_drop&&b.on("dragend dragover draggesture dragdrop drop drag",function(s){s.preventDefault(),s.stopPropagation()}),b.settings.paste_data_images||b.on("drop",function(t){var s=t.dataTransfer;s&&s.files&&s.files.length>0&&t.preventDefault()}),b.addButton("pastetext",{icon:"pastetext",tooltip:"Paste as text",onclick:r,active:"text"==d.clipboard.pasteFormat}),b.addMenuItem("pastetext",{text:"Paste as text",selectable:!0,active:e.pasteFormat,onclick:r})})}),k(["tinymce/pasteplugin/Utils","tinymce/pasteplugin/WordFilter"])}(this);