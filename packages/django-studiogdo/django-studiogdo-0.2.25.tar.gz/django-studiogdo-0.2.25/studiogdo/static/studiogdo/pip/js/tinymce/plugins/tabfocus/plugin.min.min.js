tinymce.PluginManager.add("tabfocus",function(h){function g(b){9!==b.keyCode||b.ctrlKey||b.altKey||b.metaKey||b.preventDefault()}function l(a){function o(q){function p(c){return"BODY"===c.nodeName||"hidden"!=c.type&&"none"!=c.style.display&&"hidden"!=c.style.visibility&&p(c.parentNode)}function b(c){return/INPUT|TEXTAREA|BUTTON/.test(c.tagName)&&tinymce.get(a.id)&&-1!=c.tabIndex&&p(c)}if(m=k.select(":input:enabled,*[tabindex]:not(iframe)"),j(m,function(r,s){return r.id==h.id?(n=s,!1):void 0}),q>0){for(e=n+1;e<m.length;e++){if(b(m[e])){return m[e]}}}else{for(e=n-1;e>=0;e--){if(b(m[e])){return m[e]}}}return null}var n,m,f,e;if(!(9!==a.keyCode||a.ctrlKey||a.altKey||a.metaKey||a.isDefaultPrevented())&&(f=i(h.getParam("tab_focus",h.getParam("tabfocus_elements",":prev,:next"))),1==f.length&&(f[1]=f[0],f[0]=":prev"),m=a.shiftKey?":prev"==f[0]?o(-1):k.get(f[0]):":next"==f[1]?o(1):k.get(f[1]))){var d=tinymce.get(m.id||m.name);m.id&&d?d.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),m.focus()},10),a.preventDefault()}}var k=tinymce.DOM,j=tinymce.each,i=tinymce.explode;h.on("init",function(){h.inline&&tinymce.DOM.setAttrib(h.getBody(),"tabIndex",null),h.on("keyup",g),tinymce.Env.gecko?h.on("keypress keydown",l):h.on("keydown",l)})});