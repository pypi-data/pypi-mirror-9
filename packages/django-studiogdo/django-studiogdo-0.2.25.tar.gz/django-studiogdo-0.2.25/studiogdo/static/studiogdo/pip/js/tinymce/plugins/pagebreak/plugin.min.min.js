tinymce.PluginManager.add("pagebreak",function(g){var f="mce-pagebreak",j=g.getParam("pagebreak_separator","<!-- pagebreak -->"),i=new RegExp(j.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(b){return"\\"+b}),"gi"),h='<img src="'+tinymce.Env.transparentSrc+'" class="'+f+'" data-mce-resize="false" />';g.addCommand("mcePageBreak",function(){g.insertContent(g.settings.pagebreak_split_block?"<p>"+h+"</p>":h)}),g.addButton("pagebreak",{title:"Page break",cmd:"mcePageBreak"}),g.addMenuItem("pagebreak",{text:"Page break",icon:"pagebreak",cmd:"mcePageBreak",context:"insert"}),g.on("ResolveName",function(a){"IMG"==a.target.nodeName&&g.dom.hasClass(a.target,f)&&(a.name="pagebreak")}),g.on("click",function(a){a=a.target,"IMG"===a.nodeName&&g.dom.hasClass(a,f)&&g.selection.select(a)}),g.on("BeforeSetContent",function(b){b.content=b.content.replace(i,h)}),g.on("PreInit",function(){g.serializer.addNodeFilter("img",function(a){for(var m,l,k=a.length;k--;){if(m=a[k],l=m.attr("class"),l&&-1!==l.indexOf("mce-pagebreak")){var c=m.parent;if(g.schema.getBlockElements()[c.name]&&g.settings.pagebreak_split_block){c.type=3,c.value=j,c.raw=!0,m.remove();continue}m.type=3,m.value=j,m.raw=!0}}})})});