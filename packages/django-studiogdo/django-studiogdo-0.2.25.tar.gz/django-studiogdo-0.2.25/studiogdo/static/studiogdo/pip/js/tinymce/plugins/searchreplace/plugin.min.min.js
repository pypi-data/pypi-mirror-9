!function(){function d(H,G,F,E,D){function C(f,e){if(e=e||0,!f[0]){throw"findAndReplaceDOMText cannot handle zero-length matches"}var h=f.index;if(e>0){var g=f[e];if(!g){throw"Invalid capture group"}h+=f[0].indexOf(g),f[0]=g}return[h,h+f[0].length,[f[0]]]}function B(f){var e;if(3===f.nodeType){return f.data}if(u[f.nodeName]&&!v[f.nodeName]){return""}if(e="",(v[f.nodeName]||t[f.nodeName])&&(e+="\n"),f=f.firstChild){do{e+=B(f)}while(f=f.nextSibling)}return e}function A(O,N,M){var L,K,J,I,q=[],p=0,o=O,n=N.shift(),m=0;O:for(;;){if((v[o.nodeName]||t[o.nodeName])&&p++,3===o.nodeType&&(!K&&o.length+p>=n[1]?(K=o,I=n[1]-p):L&&q.push(o),!L&&o.length+p>n[0]&&(L=o,J=n[0]-p),p+=o.length),L&&K){if(o=M({startNode:L,startNodeIndex:J,endNode:K,endNodeIndex:I,innerNodes:q,match:n[2],matchIndex:m}),p-=K.length-I,L=null,K=null,q=[],n=N.shift(),m++,!n){break}}else{if((!u[o.nodeName]||v[o.nodeName])&&o.firstChild){o=o.firstChild;continue}if(o.nextSibling){o=o.nextSibling;continue}}for(;;){if(o.nextSibling){o=o.nextSibling;break}if(o.parentNode===O){break O}o=o.parentNode}}}function z(f){var e;if("function"!=typeof f){var g=f.nodeType?f:w.createElement(f);e=function(i,h){var j=g.cloneNode(!1);return j.setAttribute("data-mce-index",h),i&&j.appendChild(w.createTextNode(i)),j}}else{e=f}return function(V){var U,T,S,R=V.startNode,Q=V.endNode,P=V.matchIndex;if(R===Q){var O=R;S=O.parentNode,V.startNodeIndex>0&&(U=w.createTextNode(O.data.substring(0,V.startNodeIndex)),S.insertBefore(U,O));var N=e(V.match[0],P);return S.insertBefore(N,O),V.endNodeIndex<O.length&&(T=w.createTextNode(O.data.substring(V.endNodeIndex)),S.insertBefore(T,O)),O.parentNode.removeChild(O),N}U=w.createTextNode(R.data.substring(0,V.startNodeIndex)),T=w.createTextNode(Q.data.substring(V.endNodeIndex));for(var M=e(R.data.substring(V.startNodeIndex),P),L=[],K=0,J=V.innerNodes.length;J>K;++K){var I=V.innerNodes[K],l=e(I.data,P);I.parentNode.replaceChild(l,I),L.push(l)}var b=e(Q.data.substring(0,V.endNodeIndex),P);return S=R.parentNode,S.insertBefore(U,R),S.insertBefore(M,R),S.removeChild(R),S=Q.parentNode,S.insertBefore(b,Q),S.insertBefore(T,Q),S.removeChild(Q),b}}var y,x,w,v,u,t,s=[],r=0;if(w=G.ownerDocument,v=D.getBlockElements(),u=D.getWhiteSpaceElements(),t=D.getShortEndedElements(),x=B(G)){if(H.global){for(;y=H.exec(x);){s.push(C(y,E))}}else{y=x.match(H),s.push(C(y,E))}return s.length&&(r=s.length,A(G,s,z(F))),r}}function c(t){function s(){function b(){f.statusbar.find("#next").disabled(!o(a+1).length),f.statusbar.find("#prev").disabled(!o(a-1).length)}function h(){tinymce.ui.MessageBox.alert("Could not find the specified string.",function(){f.find("#find")[0].focus()})}var g={},f=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){t.focus(),l.done()},onSubmit:function(e){var v,u,k,j;return e.preventDefault(),u=f.find("#case").checked(),j=f.find("#words").checked(),k=f.find("#find").value(),k.length?g.text==k&&g.caseState==u&&g.wholeWord==j?0===o(a+1).length?void h():(l.next(),void b()):(v=l.find(k,u,j),v||h(),f.statusbar.items().slice(1).disabled(0===v),b(),void (g={text:k,caseState:u,wholeWord:j})):(l.done(!1),void f.statusbar.items().slice(1).disabled(!0))},buttons:[{text:"Find",onclick:function(){f.submit()}},{text:"Replace",disabled:!0,onclick:function(){l.replace(f.find("#replace").value())||(f.statusbar.items().slice(1).disabled(!0),a=-1,g={})}},{text:"Replace all",disabled:!0,onclick:function(){l.replace(f.find("#replace").value(),!0,!0),f.statusbar.items().slice(1).disabled(!0),g={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){l.prev(),b()}},{text:"Next",name:"next",disabled:!0,onclick:function(){l.next(),b()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:t.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow()}function r(f){var e=f.getAttribute("data-mce-index");return"number"==typeof e?""+e:e}function q(g){var f,b;return b=t.dom.create("span",{"data-mce-bogus":1}),b.className="mce-match-marker",f=t.getBody(),l.done(!1),d(g,f,b,!1,t.schema)}function p(f){var e=f.parentNode;f.firstChild&&e.insertBefore(f.firstChild,f),f.parentNode.removeChild(f)}function o(b){var k,j=[];if(k=tinymce.toArray(t.getBody().getElementsByTagName("span")),k.length){for(var i=0;i<k.length;i++){var h=r(k[i]);null!==h&&h.length&&h===b.toString()&&j.push(k[i])}}return j}function n(b){var h=a,g=t.dom;b=b!==!1,b?h++:h--,g.removeClass(o(a),"mce-match-marker-selected");var f=o(h);return f.length?(g.addClass(o(h),"mce-match-marker-selected"),t.selection.scrollIntoView(f[0]),h):-1}function m(b){b.parentNode.removeChild(b)}var l=this,a=-1;l.init=function(b){b.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:s,separator:"before",context:"edit"}),b.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:s}),b.addCommand("SearchReplace",s),b.shortcuts.add("Ctrl+F","",s)},l.find=function(f,e,h){f=f.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),f=h?"\\b"+f+"\\b":f;var g=q(new RegExp(f,e?"g":"gi"));return g&&(a=-1,a=n(!0)),g},l.next=function(){var b=n(!0);-1!==b&&(a=b)},l.prev=function(){var b=n(!1);-1!==b&&(a=b)},l.replace=function(y,x,w){var v,u,k,j,i,g,f=a;for(x=x!==!1,k=t.getBody(),u=tinymce.toArray(k.getElementsByTagName("span")),v=0;v<u.length;v++){var b=r(u[v]);if(null!==b&&b.length){if(j=i=parseInt(b,10),w||j===a){for(y.length?(u[v].firstChild.nodeValue=y,p(u[v])):m(u[v]);u[++v];){if(j=r(u[v]),null!==b&&b.length){if(j!==i){v--;break}m(u[v])}}x&&f--}else{i>a&&u[v].setAttribute("data-mce-index",i-1)}}}return t.undoManager.add(),a=f,x?(g=o(f+1).length>0,l.next()):(g=o(f-1).length>0,l.prev()),!w&&g},l.done=function(b){var x,w,v,u;for(w=tinymce.toArray(t.getBody().getElementsByTagName("span")),x=0;x<w.length;x++){var k=r(w[x]);null!==k&&k.length&&(k===a.toString()&&(v||(v=w[x].firstChild),u=w[x].firstChild),p(w[x]))}if(v&&u){var f=t.dom.createRng();return f.setStart(v,0),f.setEnd(u,u.data.length),b!==!1&&t.selection.setRng(f),f}}}tinymce.PluginManager.add("searchreplace",c)}();