(function(){var a=function(b,c){return function(){return b.apply(c,arguments)}};define(function(){var b;return b=(function(){function c(f,e,d){this.list=f;this.value=e;this.form=d;this.hideForm=a(this.hideForm,this);this.showForm=a(this.showForm,this);this.close=a(this.close,this);this.firstFocus=a(this.firstFocus,this);this.enter=a(this.enter,this);this.removeEventListenerOnInputs=a(this.removeEventListenerOnInputs,this);this.addEventListenerOnInputs=a(this.addEventListenerOnInputs,this);this.changed=a(this.changed,this);this.cancelChange=a(this.cancelChange,this);this.commitChange=a(this.commitChange,this);this.cancel=a(this.cancel,this);this.commit=a(this.commit,this);this.inputs=this.form.querySelectorAll("input");this.selects=this.form.querySelectorAll("select");this.editionMode=true;this.showForm()}c.prototype.commit=function(d,e){return alert("edition committing to be done")};c.prototype.cancel=function(d,e){return e.editForm=null};c.prototype.commitChange=function(d){if(!this.editionMode){return}if(d!=null){d.preventDefault()}this.close();if(this.changed()){return this.commit(d,this.list)}else{return this.cancel(d,this.list)}};c.prototype.cancelChange=function(d){if(d!=null){d.preventDefault()}this.close();return this.cancel(d,this.list)};c.prototype.changed=function(){var j,m,i,l,g,f,k,d,h,e;h=this.inputs;for(g=0,k=h.length;g<k;g++){j=h[g];if(j.type==="checkbox"){return true}m=j.value;i=j.getAttribute("value");if(m!==i){return true}}e=this.selects;for(f=0,d=e.length;f<d;f++){l=e[f];m=l.value;i=l.getAttribute("value");if(m!==i){return true}}return false};c.prototype.addEventListenerOnInputs=function(){var h,e,k,i,g,f,j,d;j=this.inputs;for(k=0,g=j.length;k<g;k++){h=j[k];if(h.type==="checkbox"){h.addEventListener("click",this.commitChange);h.addEventListener("keydown",this.enter)}else{h.addEventListener("blur",this.commitChange);h.addEventListener("keydown",this.enter)}}d=this.selects;for(i=0,f=d.length;i<f;i++){e=d[i];e.addEventListener("change",this.commitChange);e.addEventListener("keydown",this.enter)}return this.form.addEventListener("submit",this.commitChange)};c.prototype.removeEventListenerOnInputs=function(){var h,e,k,i,g,f,j,d;j=this.inputs;for(k=0,g=j.length;k<g;k++){h=j[k];if(h.type==="checkbox"){h.removeEventListener("click",this.commitChange);h.removeEventListener("keydown",this.enter)}else{h.removeEventListener("blur",this.commitChange);h.removeEventListener("keydown",this.enter)}}d=this.selects;for(i=0,f=d.length;i<f;i++){e=d[i];e.removeEventListener("change",this.commitChange);e.removeEventListener("keydown",this.enter)}return this.form.removeEventListener("submit",this.commitChange)};c.prototype.enter=function(d){if(d.keyCode===27){d.preventDefault();return this.cancelChange()}};c.prototype.firstFocus=function(){var d;d=this.form.querySelector("input");if(d){d.focus();if(d.type!=="checkbox"){return d.select()}}};c.prototype.close=function(){this.hideForm();return this.editionMode=false};c.prototype.showForm=function(){addClassName(this.value,"hidden");removeClassName(this.form,"hidden");return this.addEventListenerOnInputs()};c.prototype.hideForm=function(){this.removeEventListenerOnInputs();removeClassName(this.value,"hidden");return addClassName(this.form,"hidden")};return c})()})}).call(this);