<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="jalon.content">

<body>

<metal:core fill-slot="content"
            tal:define="plan context/getPlan;
                        page string:cours_plan_view;
                        section string:plan;
                        mtool context/@@plone_tools/membership;
                        mode_etudiant request/mode_etudiant | nothing;
                        personnel python:context.isPersonnel(user, mode_etudiant);
                        perso_mode_etu python:personnel or mode_etudiant;
                        anonymous python:user.has_role('Anonymous');
                        actualites context/getActualitesCours;
                        annonces python:context.getAnnonces(user, request, perso_mode_etu);
                        dicoForums context/getDicoForums;
                        aidePlan context/getAidePlan;
                        formations context/getAffichageFormation;
                        nbEtuFormation python:context.getNbEtuFormation(formations);">

    <metal:macro use-macro="context/macro_navigation/macros/fil_d_ariane">
        encart d'affichage du fil d'ariane
    </metal:macro>

    <div id="reveal-main" class="reveal-modal medium" data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>
    <div id="reveal-main-large" class="reveal-modal large" data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>
    <div id="reveal-main_second" class="reveal-modal medium" data-reveal="data-reveal" data-options="close_on_background_click: true;"></div>

    <main id="mes_cours-plan" class="row" role="main" aria-labelledby="page_title">

        <tal:block
             tal:define="message request/message | nothing"
             tal:condition="message">
            <metal:macro use-macro="context/macro_messages/macros/messages">
                encart d'affichage des messages de feedback
            </metal:macro>
        </tal:block>
        <metal:macro use-macro="here/macro_global_statusmessage/macros/portal_message">Message de session</metal:macro>

        <section id="course_plan" class="medium-8 small-12 columns">
            <tal:condition condition="personnel">
            <a class="button small radius dropdown right" data-options="align:bottom" data-dropdown="course-options">
                <i class="fa fa-cogs"></i><tal:block i18n:translate="">Options du cours</tal:block>
            </a>
            <ul id="course-options" data-dropdown-content class="f-dropdown">
                <li>
                    <a data-reveal-ajax="true" data-reveal-id="reveal-main"
                       tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours&amp;formulaire=modifier-titre">
                        <i class="fa fa-book fa-fw"></i><tal:block i18n:translate="">Titre</tal:block>
                    </a>
                </li>
                <li>
                    <a data-reveal-ajax="true" data-reveal-id="reveal-main"
                       tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_form&amp;formulaire=modifier-attribut&amp;attribut=description"
                       tal:condition="personnel">
                        <i class="fa fa-info-circle fa-fw"></i><tal:block i18n:translate="">Description</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-acces-etu">
                        <i class="fa fa-users fa-fw"></i><tal:block i18n:translate="">Accès étudiants</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-acces-ens">
                        <i class="fa fa-user fa-fw"></i><tal:block i18n:translate="">Partage enseignants</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-preferences">
                        <i class="fa fa-cogs fa-fw"></i><tal:block i18n:translate="">Options</tal:block>
                    </a>
                </li>

                <li>
                    <a data-reveal-id="reveal-main" data-reveal-ajax="true"
                       tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_mescours&amp;formulaire=purger&amp;came_from=cours_plan_view">
                        <i class="fa fa-filter fa-fw"></i><tal:block i18n:translate="">Purger</tal:block>
                    </a>
                </li>
                <!--li>
                    <a tal:attributes="href string:${context/absolute_url}?mode_etudiant=true">
                        <i class="fa fa-child fw"></i><tal:block i18n:translate="">Mode étudiant</tal:block>
                    </a>
                </li-->
            </ul>
            </tal:condition>
        <h1>
            <i class="fa fa-book no-pad"></i>
            <tal:replace replace="here/Title" />
        </h1>

        <tal:condition condition="personnel">

            <h2 class="show-for-medium-up">
                <i class="fa fa-plus-circle"></i><tal:block i18n:translate="">Ajouter des éléments</tal:block>
            </h2>

            <nav id="item-adder" class="show-for-medium-up">
                <ul class="button-group radius"
                    tal:define="menu_cours context/getMenuCours">
                    <li>
                        <a class="button small course-title dropdown" data-options="align:bottom" data-dropdown="add-title-text">
                            <i class="fa fa-paragraph"></i><tal:block i18n:translate="">Titre / texte</tal:block>
                        </a>
                        <ul id="add-title-text" data-dropdown-content class="f-dropdown">
                            <li>
                                <a tal:attributes="href string:${context/absolute_url}/cours_plan_form?typeElement=Titre"
                                   data-reveal-id="reveal-main" data-reveal-ajax="true">
                                    <i class="fa fa-paragraph fa-fw"></i>
                                    <tal:block i18n:translate="">Titre</tal:block>
                                </a>
                            </li>
                            <li>
                                <a tal:attributes="href string:${context/absolute_url}/cours_plan_form?typeElement=TexteLibre"
                                   data-reveal-id="reveal-main" data-reveal-ajax="true">
                                    <i class="fa fa-align-justify fa-fw"></i>
                                    <tal:block i18n:translate="">Texte libre</tal:block>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a class="button small course-space_el dropdown" data-options="align:bottom" data-dropdown="add-space_el">
                            <i class="fa fa-home"></i><tal:block i18n:translate="">De mon espace</tal:block>
                        </a>
                        <ul id="add-space_el" data-dropdown-content class="f-dropdown">
                            <li tal:repeat="menu menu_cours/espace">
                                <a data-reveal-id="reveal-main-large" data-reveal-ajax="true"
                                   tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours&amp;formulaire=ajout-supports&amp;ajout=Supports&amp;espace=${menu/rubrique}">
                                    <i tal:attributes="class menu/icone"></i><tal:replace replace="menu/titre" i18n:translate="">Élément de mon espace</tal:replace>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a class="button small course-activity dropdown" data-options="align:bottom" data-dropdown="add-activity">
                            <i class="fa fa-random"></i><tal:block i18n:translate="">Activité</tal:block>
                        </a>
                        <ul id="add-activity" data-dropdown-content class="f-dropdown">
                            <li tal:repeat="menu menu_cours/activites">
                                <a data-reveal-id="reveal-main" data-reveal-ajax="true"
                                   tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours&amp;formulaire=creer-activites&amp;ajout=Activites&amp;espace=${menu/rubrique}">
                                    <i tal:attributes="class menu/icone"></i><tal:replace replace="menu/titre" i18n:translate="">Activité pédagogique</tal:replace>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a class="button small course-direct dropdown" data-options="align:bottom" data-dropdown="add-direct">
                            <i class="fa fa-cloud-upload"></i><tal:block i18n:translate="">Ajout rapide</tal:block>
                        </a>
                        <ul id="add-direct" data-dropdown-content class="f-dropdown">
                            <li tal:repeat="menu menu_cours/rapide">
                                <a data-reveal-id="reveal-main" data-reveal-ajax="true"
                                   tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours&amp;formulaire=ajout-elements&amp;ajout=Rapide&amp;espace=${menu/rubrique}">
                                    <i tal:attributes="class menu/icone"></i><tal:replace replace="menu/titre" i18n:translate="">Ajout rapide</tal:replace>
                                </a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </nav>

        </tal:condition>

            <h2 id="js-update_title">
                <i class="fa fa-sitemap no-pad"></i>
                <tal:block i18n:translate="">Plan du cours</tal:block>
            </h2>

    <tal:condition condition="not:plan">
            <div class="panel callout radius">
        <tal:condition condition="personnel">
            <ol id="course_plan-plan">
                <li class="js-course_empty">
                    <h4 i18n:translate="">Aucune ressource n'est accessible dans ce cours.</h4>
                </li>
                <li class="js-course_empty"
                    tal:condition="aidePlan/activer_aide_plan"
                    tal:content="structure aidePlan/lien_aide_plan" />
            </ol>
        </tal:condition>
            </div>
    </tal:condition>

    <tal:condition condition="plan"
                   define="plancours python:context.getPlanCours(personnel, user.getId(), actualites['listeActu'])">

            <span class="title-legend show-for-medium-up"
                  tal:condition="personnel">
                <i class="fa fa-info-circle no-pad"></i>
                <tal:block i18n:translate="aide_plan">Pour organiser votre plan, faites glisser les éléments et déposez-les à l'emplacement souhaité.</tal:block>
            </span>

            <div class="panel callout radius">
                <ol id="course_plan-plan"
                    tal:condition="plancours"
                    tal:attributes="class python:context.test(personnel, 'sortable', '')">
                    <metal:macro use-macro="context/macro_cours_plan/macros/afficher-plan">
                        Affichage du plan du cours
                    </metal:macro>
                </ol>

        <tal:comment replace="nothing">
        <!--
        <tal:condition condition="python:context.getActiver_dll_fichier() and context.getFichiersCours()">
                <a class="button tiny expand radius show-for-small-only"
                   tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours_telecharge&amp;formulaire=telecharge"
                   data-reveal-id="reveal-main" data-reveal-ajax="true"
                   i18n:translate="">Télécharger les fichiers du cours</a>
                <a class="button tiny expand radius show-for-medium-up"
                   tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_cours_telecharge&amp;formulaire=telecharge"
                   data-reveal-id="reveal-main" data-reveal-ajax="true"
                   i18n:translate="">Télécharger une archive contenant l'ensemble des fichiers du cours</a>
        </tal:condition>
        -->
        </tal:comment>

                <h4 tal:condition="not:plancours"
                    i18n:translate="">Aucune ressource n'est accessible dans ce cours.</h4>

            </div>

            <div id="course_plan-legend" class="panel bkgrnd radius"
                 tal:condition="plancours">

                <h4>
                    <i class="fa fa-info-circle"></i><tal:block i18n:translate="legende">Légende</tal:block>
                </h4>

                <dl class="typeElement type_Titre">
                    <dt i18n:translate="">Titre</dt>
                </dl>
                <dl class="typeElement type_Activite">
                    <dt i18n:translate="">Activité pédagogique</dt>
                        <dd class="type_Examen" i18n:translate="">Examen</dd>
                        <dd class="type_AutoEvaluation" i18n:translate="">Auto-évaluation</dd>
                        <dd class="type_BoiteDepot" i18n:translate="">Boite de dépôt</dd>
                        <dd class="type_SalleVirtuelle" i18n:translate="">Salle virtuelle</dd>
                </dl>
                <dl class="typeElement type_Mon_Espace">
                    <dt i18n:translate="">Ressource ou complément</dt>
                        <dd class="type_File" i18n:translate="">Fichier</dd>
                        <dd class="type_Image" i18n:translate="">Image</dd>
                        <dd class="type_Lienweb" i18n:translate="">Ressource externe</dd>
                        <dd class="type_Lecteurexportable" i18n:translate="">Lecteur exportable</dd>
                        <dd class="type_CatalogueBU" i18n:translate="">Catalogue BU</dd>
                        <dd class="type_Presentationssonorisees" i18n:translate="">Présentation sonorisée</dd>
                        <dd class="type_Webconference" i18n:translate="">Webconférence</dd>
                </dl>
                <dl>
        <tal:condition condition="personnel">
                    <dt>
                        <i class="fa fa-eye-slash fa-lg fa-fw"></i><tal:block i18n:translate="">Élément non visible par les étudiants</tal:block>
                    </dt>
                    <dt>
                        <i class="fa fa-calendar-o success fa-lg fa-fw"></i><tal:block i18n:translate="">Affichage programmé (date au survol de l'icône)</tal:block>
                    </dt>
                    <dt>
                        <i class="fa fa-calendar-o alert fa-lg fa-fw"></i><tal:block i18n:translate="">Masquage programmé (date au survol de l'icône)</tal:block>
                    </dt>
                    <dt>
                        <i class="fa fa-hand-o-left fa-lg fa-fw"></i><tal:block i18n:translate="">Élément signalé aux étudiants (indication au survol de l'icône)</tal:block>
                    </dt>
        </tal:condition>
        <tal:condition condition="python:not personnel and not anonymous">
                    <dt>
                        <i class="fa fa-check-square-o fa-lg fa-fw"></i><tal:block i18n:translate="">Élément marqué comme "lu"</tal:block>
                    </dt>
                    <dt>
                        <i class="fa fa-hand-o-left fa-lg fa-fw"></i><tal:block i18n:translate="">Élément signalé par l'enseignant (indication au survol de l'icône)</tal:block>
                    </dt>
        </tal:condition>
        <tal:condition condition="not:anonymous">
                    <dt>
                        <i class="fa fa-bell-o fa-lg fa-fw"></i><tal:block i18n:translate="">Nouveauté depuis votre dernière connexion</tal:block>
                    </dt>
        </tal:condition>
                </dl>

            </div>

    </tal:condition>

        <metal:macro use-macro="context/macro_cours_plan/macros/affichage_biblio">
            Affichage de la bibliographie
        </metal:macro>

        <metal:macro use-macro="context/macro_cours_plan/macros/affichage_glossaire">
            Affichage du glossaire
        </metal:macro>

        </section>

        <aside id="course_life" class="medium-4 small-12 columns">
            <tal:comment replace="nothing">
            <!--a class="button expand small success radius"
               tal:attributes="href context/absolute_url"
               tal:condition="python:context.test(mode_etudiant == 'true' and context.isAuteurs(user.getId()), 1, 0)">
                <i class="fa fa-user"></i><tal:block i18n:translate="">Retour au mode enseignant</tal:block>
            </a-->
        <!--tal:condition condition="personnel">
            <a class="button expand small radius dropdown" data-options="align:bottom" data-dropdown="course-options">
                <i class="fa fa-cogs"></i><tal:block i18n:translate="">Options du cours</tal:block>
            </a>
            <ul id="course-options" data-dropdown-content class="f-dropdown">
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-acces-etu">
                        <i class="fa fa-users fw"></i><tal:block i18n:translate="">Accès étudiants</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-acces-ens">
                        <i class="fa fa-user fw"></i><tal:block i18n:translate="">Partage enseignants</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}/cours_acces_view?onglet=gestion-preferences">
                        <i class="fa fa-cogs fw"></i><tal:block i18n:translate="">Préférences</tal:block>
                    </a>
                </li>
                <li>
                    <a tal:attributes="href string:${context/absolute_url}?mode_etudiant=true">
                        <i class="fa fa-child fw"></i><tal:block i18n:translate="">Mode étudiant</tal:block>
                    </a>
                </li>
            </ul>
        </tal:condition-->
            </tal:comment>

            <tal:condition condition="python:context.test(context.isAuteurs(user.getId()), 1, 0)">

                <metal:macro use-macro="context/macro_cours_life/macros/mode_affichage">
                    Mode Enseignant / Etudiant
                </metal:macro>
            </tal:condition>

            <div id="js-course_life-actus"
                 tal:define="nbActu actualites/nbActu"
                 tal:condition="nbActu">
                <metal:macro use-macro="context/macro_cours_life/macros/afficher-actus">
                    Affichage des actus du cours
                </metal:macro>
            </div>


            <div id="js-tab-course_life">
                <metal:macro use-macro="context/macro_cours_life/macros/course_life">
                    Affichage de la vie du cours
                </metal:macro>
            </div>

    <tal:condition condition="context/Description">
            <a class="button radius tiny right" 
               data-reveal-ajax="true" data-reveal-id="reveal-main"
               tal:attributes="href string:${context/absolute_url}/folder_form?macro=macro_form&amp;formulaire=modifier-attribut&amp;attribut=description"
               tal:condition="personnel">
                <i class="fa fa-pencil"></i>
                <tal:block i18n:translate="">Modifier</tal:block>
            </a>
            <h2>
                <i class="fa fa-info-circle"></i><tal:block i18n:translate="">Description du cours</tal:block>
            </h2>
            <div class="panel bkgrnd radius">
                <p tal:content="context/Description" />
            </div>
    </tal:condition>

        </aside>

    <tal:block tal:condition="not:personnel"
               define="script string:readSwitcher()">
        <tal:jsBuffer define="addJsContent python:jsBuffer.addJS(script)" />
    </tal:block>

    <tal:block tal:condition="personnel"
               define="script string:setSortablePlan()">
        <tal:jsBuffer define="addJsContent python:jsBuffer.addJS(script)" />
    </tal:block>

    <tal:define define="script string:setPlanLegend()">
        <tal:jsBuffer define="addJsContent python:jsBuffer.addJS(script)" />
    </tal:define>

    </main>

</metal:core>
</body>
</html>