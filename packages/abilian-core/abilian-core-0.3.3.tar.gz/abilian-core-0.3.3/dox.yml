#
# Playing w/ dox (cf. http://blog.chmouel.com/2014/09/08/dox-a-tool-that-run-python-or-others-tests-in-a-docker-container/)
# NB: dox itself is unreleased.
#
testing:
  image: infra/trusty
  add:
    - requirements.txt
    - dev-requirements.txt
    - Makefile
  prep:
    - apt-get update
    - apt-get install -y "default-jre" "imagemagick" "libjpeg-dev" "libpq-dev" "libxslt1-dev" "libzmq-dev" "poppler-utils" "python-dev" "python-pip" "libffi-dev" "libenchant-dev"
    # skip for now as they aren't currently used by the tests.
    #- apt-get install -y "unoconv" "redis-server"
    - pip install -U -r requirements.txt -r etc/dev-requirements.txt
    - make clean
  commands:
    - py.test

