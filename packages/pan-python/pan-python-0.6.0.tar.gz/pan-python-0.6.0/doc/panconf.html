<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8: http://docutils.sourceforge.net/" />
<title>panconf.py</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="panconf-py">
<h1 class="title">panconf.py</h1>
<h2 class="subtitle" id="command-line-program-for-managing-pan-os-xml-configurations">command line program for managing PAN-OS XML configurations</h2>

<!-- Copyright (c) 2012, 2013 Kevin Steves <kevin.steves@pobox.com>

Permission to use, copy, modify, and distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. -->
<div class="section" id="name">
<h1>NAME</h1>
<blockquote>
panconf.py - command line program for managing PAN-OS XML configurations</blockquote>
</div>
<div class="section" id="synopsis">
<h1>SYNOPSIS</h1>
<blockquote>
<dl class="docutils">
<dt>panconf.py [options] [pseudo-xpath]</dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">--config <var>path</var></span></kbd></td>
<td>path to XML config or '-' for stdin</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--xml</span></kbd></td>
<td>print XML</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--py</span></kbd></td>
<td>print XML in Python</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--json</span></kbd></td>
<td>print XML in JSON</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--flat</span></kbd></td>
<td>print XML flatly</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--set</span></kbd></td>
<td>print XML as set CLI</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--mlist</span></kbd></td>
<td>print set CLI members as a list</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--compact</span></kbd></td>
<td>print compactly</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--debug <var>level</var></span></kbd></td>
<td>enable debug level up to 3</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--version</span></kbd></td>
<td>display version</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--help</span></kbd></td>
<td>display usage</td></tr>
</tbody>
</table>
</dd>
</dl>
</blockquote>
</div>
<div class="section" id="description">
<h1>DESCRIPTION</h1>
<blockquote>
<p><strong>panconf.py</strong> is used to manage PAN-OS XML configurations.  It can be
used to query nodes in an XML configuration by XPath (currently a
pseudo-xpath, see below) and convert the configuration to Python, JSON
and other formats for reporting and further manipulation.</p>
<p>It uses the <strong>pan.config</strong> module which is currently a private
interface (it is subject to change and not documented).</p>
<p>The options are:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">--config</span></tt> <em>path</em></dt>
<dd>Specify path to PAN-OS XML configuration or '-' to read from
<strong>stdin</strong>.  This can be a complete (e.g., <tt class="docutils literal"><span class="pre">running-config.xml</span></tt>)
or partial (<tt class="docutils literal">rulebase security rules</tt>) XML configuration.</dd>
<dt><tt class="docutils literal"><span class="pre">--xml</span></tt></dt>
<dd>Print configuration in XML.</dd>
<dt><tt class="docutils literal"><span class="pre">--py</span></tt></dt>
<dd>Print configuration as a Python object.</dd>
<dt><tt class="docutils literal"><span class="pre">--json</span></tt></dt>
<dd>Print configuration as a JSON object.</dd>
<dt><tt class="docutils literal"><span class="pre">--flat</span></tt></dt>
<dd><p class="first">Print configuration flatly in an XPath-like format.  This is useful
for search with document node context and to identify a node's XPath.</p>
<p class="last">When <tt class="docutils literal"><span class="pre">pseudo-xpath</span></tt> is not specified a default set of XPath
expressions is used to match nodes in the XML configuration.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--set</span></tt></dt>
<dd><p class="first">Print configuration in set CLI format.  This is intended to be the
same format as seen when using <tt class="docutils literal">set cli <span class="pre">config-output-format</span> set</tt>.</p>
<p>When <tt class="docutils literal"><span class="pre">pseudo-xpath</span></tt> is not specified a default set of XPath
expressions is used to match nodes in the XML configuration.</p>
<p class="last">When <tt class="docutils literal"><span class="pre">pseudo-xpath</span></tt> is specified, it should specify a top-level
node (what <tt class="docutils literal"># set ?</tt> allows) or results are unspecified.</p>
</dd>
<dt><tt class="docutils literal"><span class="pre">--mlist</span></tt></dt>
<dd><p class="first">Print set CLI members as a list by enclosing multiple <em>member</em>
element text in square brackets.  By default each member terminates
a single set statement.  Member list format is used by default when
a PAN-OS version of 5.0 or greater is obtained from the config file
via the <em>config</em> element <em>version</em> attribute.</p>
<p>Member list format:</p>
<pre class="literal-block">
set network virtual-router stx_1234 interface [ ethernet1/5.100 ethernet1/6.100 ]
</pre>
<p>Default format:</p>
<pre class="last literal-block">
set network virtual-router stx_1234 interface ethernet1/5.100
set network virtual-router stx_1234 interface ethernet1/6.100
</pre>
</dd>
<dt><tt class="docutils literal"><span class="pre">--compact</span></tt></dt>
<dd>Print output compactly.  This currently applies to JSON
output only, and can be used to eliminate spaces in the JSON
object.</dd>
<dt><tt class="docutils literal"><span class="pre">--debug</span></tt> <em>level</em></dt>
<dd>Enable debugging in <strong>panconf.py</strong> and the <strong>pan.config</strong> module.
<em>level</em> is an integer in the range 0-3; 0 specifies no
debugging and 3 specifies maximum debugging.</dd>
<dt><tt class="docutils literal"><span class="pre">--version</span></tt></dt>
<dd>Display version.</dd>
<dt><tt class="docutils literal"><span class="pre">--help</span></tt></dt>
<dd>Display <strong>panconf.py</strong> command options.</dd>
<dt><tt class="docutils literal"><span class="pre">pseudo-xpath</span></tt></dt>
<dd><tt class="docutils literal"><span class="pre">pseudo-xpath</span></tt> is currently the XPath as supported by the
<strong>xml.etree.ElementTree</strong> module, which provides limited support for
XPath expressions for locating elements in a tree.  For more information
see the examples below and the documentation at:
<a class="reference external" href="http://docs.python.org/dev/library/xml.etree.elementtree.html#elementtree-xpath">http://docs.python.org/dev/library/xml.etree.elementtree.html#elementtree-xpath</a>.</dd>
</dl>
</blockquote>
</div>
<div class="section" id="files">
<h1>FILES</h1>
<blockquote>
None.</blockquote>
</div>
<div class="section" id="exit-status">
<h1>EXIT STATUS</h1>
<blockquote>
<strong>panconf.py</strong> exits with 0 on success and 1 if an error occurs.</blockquote>
</div>
<div class="section" id="examples">
<h1>EXAMPLES</h1>
<blockquote>
<p><tt class="docutils literal">config.xml</tt> in the examples below is a <tt class="docutils literal"><span class="pre">running-config.xml</span></tt>
exported from a PAN-OS device.</p>
<p>Print XML node for <tt class="docutils literal">adminr</tt> user.</p>
<pre class="literal-block">
$ panconf.py --config config.xml --xml &quot;./mgt-config/users/entry[&#64;name='adminr']&quot;
&lt;entry name=&quot;adminr&quot;&gt;
      &lt;permissions&gt;
        &lt;role-based&gt;
          &lt;superreader&gt;yes&lt;/superreader&gt;
        &lt;/role-based&gt;
      &lt;/permissions&gt;
      &lt;phash&gt;$1$panetwrx$xQpDOQuAP3v8bFzJz.l7j0&lt;/phash&gt;
    &lt;/entry&gt;
</pre>
<p>Print JSON object for <tt class="docutils literal">adminr</tt> user.</p>
<pre class="literal-block">
$ panconf.py --config config.xml --json &quot;./mgt-config/users/entry[&#64;name='adminr']&quot;
{
  &quot;entry&quot;: {
    &quot;name&quot;: &quot;adminr&quot;,
    &quot;permissions&quot;: {
      &quot;role-based&quot;: {
        &quot;superreader&quot;: true
      }
    },
    &quot;phash&quot;: &quot;$1$panetwrx$xQpDOQuAP3v8bFzJz.l7j0&quot;
  }
}
</pre>
<p>Print flatly for admin users.</p>
<pre class="literal-block">
$ panconf.py --config config.xml --flat &quot;./mgt-config&quot;
./mgt-config
./mgt-config/users
./mgt-config/users/entry
./mgt-config/users/entry[&#64;name='admin']
./mgt-config/users/entry[&#64;name='admin']/phash=&quot;$1$dgfkmfpe$/OGLAdsxd/zzjq51vLoeR0&quot;
./mgt-config/users/entry[&#64;name='admin']/permissions
./mgt-config/users/entry[&#64;name='admin']/permissions/role-based
./mgt-config/users/entry[&#64;name='admin']/permissions/role-based/superuser=&quot;yes&quot;
./mgt-config/users/entry
./mgt-config/users/entry[&#64;name='adminr']
./mgt-config/users/entry[&#64;name='adminr']/permissions
./mgt-config/users/entry[&#64;name='adminr']/permissions/role-based
./mgt-config/users/entry[&#64;name='adminr']/permissions/role-based/superreader=&quot;yes&quot;
./mgt-config/users/entry[&#64;name='adminr']/phash=&quot;$1$panetwrx$xQpDOQuAP3v8bFzJz.l7j0&quot;
</pre>
<p>Print set CLI for admin users.</p>
<pre class="literal-block">
$ panconf.py --config config.xml --set &quot;./mgt-config&quot;
set mgt-config users admin phash $1$dgfkmfpe$/OGLAdsxd/zzjq51vLoeR0
set mgt-config users admin permissions role-based superuser yes
set mgt-config users adminr permissions role-based superreader yes
set mgt-config users adminr phash $1$panetwrx$xQpDOQuAP3v8bFzJz.l7j0
</pre>
</blockquote>
</div>
<div class="section" id="see-also">
<h1>SEE ALSO</h1>
<blockquote>
panxapi.py</blockquote>
</div>
<div class="section" id="authors">
<h1>AUTHORS</h1>
<blockquote>
Kevin Steves &lt;<a class="reference external" href="mailto:kevin.steves&#64;pobox.com">kevin.steves&#64;pobox.com</a>&gt;</blockquote>
</div>
<div class="section" id="miscellany">
<h1>MISCELLANY</h1>
<blockquote>
<p>Configurations with <tt class="docutils literal"><span class="pre">multi-vsys:</span> on</tt> are identified when multiple
nodes match the xpath
<tt class="docutils literal"><span class="pre">&quot;/config/devices/entry[&#64;name='localhost.localdomain']/vsys/entry&quot;</span></tt>,
which is not perfect.</p>
<p>Configurations for Panorama are identified by matching the xpath
<tt class="docutils literal">&quot;/config/panorama&quot;</tt> or
<tt class="docutils literal"><span class="pre">&quot;/config/devices/entry[&#64;name='localhost.localdomain']/device-group&quot;</span></tt>,
which is also not perfect.</p>
<p><tt class="docutils literal"><span class="pre">--debug</span> 1</tt> can be used to display configuration version and types
identified:</p>
<pre class="literal-block">
$ panconf.py --config panorama.xml --debug 1
config_root: &lt;Element 'config' at 0x207e1af90&gt;
config_version: 4.1.0
config_panorama: True
config_multi_vsys: False
</pre>
<p>When performing a top level configuration mode <tt class="docutils literal"># show</tt> command
with no arguments a default set of XPath expressions is used by
PAN-OS to match the configuration to be displayed.  These paths are
stored internally in the <strong>pan.config</strong> module for different PAN-OS
versions (4.1, 5.0, 5.1 (Panorama), 6.0 and 6.1) in order to duplicate
the order and set of configuration nodes displayed.</p>
<p>PAN-OS may place a trailing space on some set statements;
<strong>panconf.py</strong> never ends a statement with a space.</p>
</blockquote>
</div>
</div>
</body>
</html>
