<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8: http://docutils.sourceforge.net/" />
<title>pan.xapi</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="pan-xapi">
<h1 class="title">pan.xapi</h1>
<h2 class="subtitle" id="python-interface-to-the-pan-os-xml-api">Python interface to the PAN-OS XML API</h2>

<!-- NOTE: derived from documentation in PAN-perl

Copyright (c) 2011 Palo Alto Networks, Inc. <info@paloaltonetworks.com>
Copyright (c) 2013-2015 Kevin Steves <kevin.steves@pobox.com>

Permission to use, copy, modify, and distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE. -->
<div class="section" id="name">
<h1>NAME</h1>
<blockquote>
pan.xapi - Python interface to the PAN-OS XML API</blockquote>
</div>
<div class="section" id="synopsis">
<h1>SYNOPSIS</h1>
<pre class="literal-block">
import pan.xapi

try:
    xapi = pan.xapi.PanXapi(tag='pa-200')
except pan.xapi.PanXapiError as msg:
    print('pan.xapi.PanXapi:', msg, file=sys.stderr)
    sys.exit(1)

xpath = &quot;/config/devices/entry/vsys/entry/rulebase/security/rules/&quot;
xpath += &quot;entry[&#64;name='rule7']/disabled&quot;
element = &quot;&lt;disabled&gt;yes&lt;/disabled&gt;&quot;

try:
    xapi.edit(xpath=xpath,
              element=element)
except pan.xapi.PanXapiError as msg:
    print('edit:', msg, file=sys.stderr)
    sys.exit(1)

print('policy disabled')
</pre>
</div>
<div class="section" id="description">
<h1>DESCRIPTION</h1>
<blockquote>
<p>The pan.xapi module defines the PanXapi class, which provides an
interface to the PAN-OS XML API.</p>
<p>PanXapi provides an interface to the following API request types:</p>
<ul class="simple">
<li>key generation: <tt class="docutils literal">type=keygen</tt></li>
<li>device configuration: <tt class="docutils literal">type=config</tt></li>
<li>commit configuration: <tt class="docutils literal">type=commit</tt></li>
<li>operational command: <tt class="docutils literal">type=op</tt></li>
<li>export file: <tt class="docutils literal">type=export</tt></li>
<li>dynamic object update: <tt class="docutils literal"><span class="pre">type=user-id</span></tt></li>
<li>log retrieval: <tt class="docutils literal">type=log</tt></li>
</ul>
</blockquote>
<div class="section" id="pan-xapi-constants">
<h2>pan.xapi Constants</h2>
<blockquote>
<dl class="docutils">
<dt><strong>__version__</strong></dt>
<dd>pan package version string.</dd>
<dt><strong>DEBUG1</strong>, <strong>DEBUG2</strong>, <strong>DEBUG3</strong></dt>
<dd>Python <tt class="docutils literal">logging</tt> module debug levels (see <strong>Debugging and
Logging</strong> below).</dd>
</dl>
</blockquote>
</div>
<div class="section" id="pan-xapi-constructor-and-exception-class">
<h2>pan.xapi Constructor and Exception Class</h2>
<div class="section" id="class-pan-xapi-panxapi">
<h3>class pan.xapi.PanXapi()</h3>
<blockquote>
<pre class="literal-block">
class pan.xapi.PanXapi(tag=None,
                       api_username=None,
                       api_password=None,
                       api_key=None,
                       hostname=None,
                       port=None,
                       serial=None,
                       use_http=False,
                       use_get=False,
                       timeout=None,
                       ssl_context=None)
</pre>
<dl class="docutils">
<dt><strong>tag</strong></dt>
<dd>.panrc tagname.</dd>
<dt><strong>api_username</strong></dt>
<dd><strong>user</strong> argument for <tt class="docutils literal">type=keygen</tt> request.</dd>
<dt><strong>api_password</strong></dt>
<dd><strong>password</strong> argument for <tt class="docutils literal">type=keygen</tt> request.</dd>
<dt><strong>api_key</strong></dt>
<dd><strong>key</strong> argument for API requests.</dd>
<dt><strong>hostname</strong></dt>
<dd>PAN-OS hostname or IP address. Used to construct request URI.</dd>
<dt><strong>port</strong></dt>
<dd>Port number used in the URL.  This can be used to
perform port forwarding using for example ssh(1).</dd>
</dl>
<p><strong>api_username</strong>, <strong>api_password</strong>, <strong>hostname</strong>, <strong>port</strong> and
<strong>api_key</strong> can be passed as function arguments, or specified using a
.panrc file as described below.  Either <strong>api_username</strong> and
<strong>api_password</strong> or <strong>api_key</strong> must be provided.  When
<strong>api_username</strong> and <strong>api_password</strong> are provided the <strong>api_key</strong>
will be generated automatically using the API <tt class="docutils literal">type=keygen</tt> request
and used as the key for API requests</p>
<dl class="docutils">
<dt><strong>serial</strong></dt>
<dd><p class="first">Serial number used for Panorama to device redirection.
This sets the <strong>target</strong> argument to the serial number specified in
device configuration, commit configuration, key generation, dynamic
object update and operational command API requests.</p>
<p class="last">When an API request is made on Panorama and the serial number is
specified, Panorama will redirect the request to the managed device
with the serial number.</p>
</dd>
<dt><strong>use_http</strong></dt>
<dd>Use the <em>http</em> URL scheme for API requests.  The default is to use
the <em>https</em> URL scheme.</dd>
<dt><strong>use_get</strong></dt>
<dd>Use the HTTP <em>GET</em> method for API requests.  The default is to use
the HTTP <em>POST</em> method with Content-Type
application/x-www-form-urlencoded.</dd>
<dt><strong>timeout</strong></dt>
<dd>The <tt class="docutils literal">timeout</tt> value for urlopen().</dd>
<dt><strong>ssl_context</strong></dt>
<dd><p class="first">An ssl.SSLContext() to use for HTTPS requests.  An SSL context holds
data such as SSL configuration options and certificates.</p>
<p>This can be used to specify the <tt class="docutils literal">cafile</tt>, <tt class="docutils literal">capath</tt> and other SSL
configuration options.</p>
<p>SSL contexts are supported starting in Python versions 2.7.9
and 3.2.</p>
<p class="last">Starting with Python versions 2.7.9 and 3.4.3 SSL server certificate
verification is performed by default as described in PEP 476.
Because many PAN-OS systems use a self-signed certificate, pan.xapi
will disable the default starting with these versions.
<strong>ssl_context</strong> can be used to enable verification.</p>
</dd>
</dl>
</blockquote>
</div>
<div class="section" id="exception-pan-xapi-panxapierror">
<h3>exception pan.xapi.PanXapiError</h3>
<blockquote>
Exception raised by the PanXapi class when an error occurs.  The
string representation of an instance of this exception will contain a
user-friendly error message.</blockquote>
</div>
</div>
<div class="section" id="pan-xapi-panxapi-methods">
<h2>pan.xapi.PanXapi Methods</h2>
<div class="section" id="keygen">
<h3>keygen()</h3>
<blockquote>
The keygen() method performs the <tt class="docutils literal">type=keygen</tt> key generation API
request with the <strong>api_username</strong> and <strong>api_password</strong> arguments, and
returns the <em>key</em> element in the response and sets the <strong>api_key</strong>
data attribute (instance variable).</blockquote>
</div>
<div class="section" id="ad-hoc-qs-none-xpath-none-modify-qs-false">
<h3>ad_hoc(qs=None, xpath=None, modify_qs=False)</h3>
<blockquote>
<p>The ad_hoc() method performs an ad hoc (custom) API request using
the request parameters in <strong>qs</strong>.</p>
<p><strong>qs</strong> is either a query string with field=value pairs separated by
ampersand (<strong>&amp;</strong>) or a dictionary of field, value pairs.  The
parameters will be URL-encoded before performing the API request.
<strong>modify_qs</strong> can be set to <em>True</em> to insert known fields into the
query string; the known fields that can be inserted are:</p>
<ul class="simple">
<li>xpath</li>
<li>key (api_key)</li>
<li>user (api_username)</li>
<li>password (api_password)</li>
<li>target (serial)</li>
</ul>
<p>ad_hoc() can be used to construct API requests that are not
directly supported by PanXapi.</p>
</blockquote>
</div>
<div class="section" id="show-xpath-none">
<h3>show(xpath=None)</h3>
<blockquote>
The show() method performs the <tt class="docutils literal">action=show</tt> device configuration
API request with the optional <strong>xpath</strong> argument.  show() is used to
retrieve the <em>active</em> configuration on the firewall.</blockquote>
</div>
<div class="section" id="get-xpath-none">
<h3>get(xpath=None)</h3>
<blockquote>
The get() method performs the <tt class="docutils literal">action=get</tt> device configuration
API request with the optional <strong>xpath</strong> argument.  get() is used to
retrieve the <em>candidate</em> configuration on the firewall.</blockquote>
</div>
<div class="section" id="delete-xpath-none">
<h3>delete(xpath=None)</h3>
<blockquote>
The delete() method performs the <tt class="docutils literal">action=delete</tt> device
configuration API request with the <strong>xpath</strong> argument. delete() is
used to remove an existing object at the node specified by <strong>xpath</strong>.</blockquote>
</div>
<div class="section" id="set-xpath-none-element-none">
<h3>set(xpath=None, element=None)</h3>
<blockquote>
The set() method performs the <tt class="docutils literal">action=set</tt> device configuration API
request with the <strong>xpath</strong> and <strong>element</strong> arguments. set() is
used to create a new object at the node specified by <strong>xpath</strong>.</blockquote>
</div>
<div class="section" id="edit-xpath-none-element-none">
<h3>edit(xpath=None, element=None)</h3>
<blockquote>
The edit() method performs the <tt class="docutils literal">action=edit</tt> device configuration
API request with the <strong>xpath</strong> and <strong>element</strong> arguments.  edit()
is used to replace an existing object at the node specified by
<strong>xpath</strong>.</blockquote>
</div>
<div class="section" id="move-xpath-none-where-none-dst-none">
<h3>move(xpath=None, where=None, dst=None)</h3>
<blockquote>
<p>The move() method performs the <tt class="docutils literal">action=move</tt> device configuration
API request with the <strong>xpath</strong>, <strong>where</strong> and <strong>dst</strong> arguments.</p>
<p>This moves the location of an existing node in the configuration
specified by <strong>xpath</strong>.  <strong>where</strong> is used to specify the location of
the node and can be <em>after</em>, <em>before</em>, <em>bottom</em> or <em>top</em>.  <strong>dst</strong> is
used to specify the relative destination node name when <strong>where</strong> is
<em>after</em> or <em>before</em>.</p>
<p>move() is most frequently used to reorder rules (security, nat, qos,
etc.) within the rulebase, however can be used to move other nodes in
the configuration.</p>
</blockquote>
</div>
<div class="section" id="rename-xpath-none-newname-none">
<h3>rename(xpath=None, newname=None)</h3>
<blockquote>
<p>The rename() method performs the <tt class="docutils literal">action=rename</tt> device
configuration API request with the <strong>xpath</strong> and <strong>newname</strong>
arguments.</p>
<p>This renames an existing node in the configuration specified by
<strong>xpath</strong>.  <strong>newname</strong> is used to specify the new name for the node.</p>
</blockquote>
</div>
<div class="section" id="clone-xpath-none-xpath-from-none-newname-none">
<h3>clone(xpath=None, xpath_from=None, newname=None)</h3>
<blockquote>
<p>The clone() method performs the <tt class="docutils literal">action=clone</tt> device configuration
API request with the <strong>xpath</strong>, <strong>from</strong> (<em>xpath_from</em> function
argument) and <strong>newname</strong> arguments.</p>
<p>This clones (copies) an existing node in the configuration specified
by <strong>xpath</strong>.  <strong>xpath_from</strong> is used to specify the source XPath and
<strong>newname</strong> is used to specify the new name for the cloned node.</p>
</blockquote>
</div>
<div class="section" id="override-xpath-none-element-none">
<h3>override(xpath=None, element=None)</h3>
<blockquote>
The override() method performs the <tt class="docutils literal">action=override</tt> device
configuration API request with the <strong>xpath</strong> and <strong>element</strong>
arguments. override() is used to create a new object at a node
that is part of a template from Panorama specified by <strong>xpath</strong>.
Only certain nodes in the Network and Device categories can
be overridden.</blockquote>
</div>
<div class="section" id="user-id-cmd-none-vsys-none">
<h3>user_id(cmd=None, vsys=None)</h3>
<blockquote>
The user_id() method performs the <tt class="docutils literal"><span class="pre">type=user-id</span></tt> dynamic object
update API request with the <strong>cmd</strong> argument and optional <strong>vsys</strong>
argument.  This is used to update dynamic objects including ip-user
mappings and address objects.  <strong>vsys</strong> can be used to target the
dynamic update to a specific Virtual System.</blockquote>
</div>
<div class="section" id="commit-cmd-none-action-none-sync-false-interval-none-timeout-none">
<h3>commit(cmd=None, action=None, sync=False, interval=None, timeout=None)</h3>
<blockquote>
<p>The commit() method performs the <tt class="docutils literal">type=commit</tt> commit configuration
API request with the <strong>cmd</strong> argument and optional <strong>action</strong>
argument.  This schedules a job to execute a configuration mode
<strong>commit</strong> command to commit the candidate configuration.</p>
<p><strong>cmd</strong> is an XML document used to specify commit arguments.</p>
<p><strong>action</strong> can be set to &quot;all&quot; to perform a <tt class="docutils literal"><span class="pre">commit-all</span></tt> on
Panorama.</p>
<p>Additional arguments include:</p>
<ul>
<li><p class="first"><strong>sync</strong></p>
<p>Perform a synchronous commit when set to <em>True</em>.</p>
<p>The XML API schedules a job to perform the commit operation; the
commit() method will then periodically perform an API request to
determine if the job ID returned in the initial request is complete
and return with the job status.  Additional arguments to control
the polling include:</p>
<ul class="simple">
<li><strong>interval</strong></li>
</ul>
<blockquote>
<p>A floating point number specifying the query interval in seconds
between each non-finished job status response.</p>
<p>The default is 0.5 seconds.</p>
</blockquote>
<ul class="simple">
<li><strong>timeout</strong></li>
</ul>
<blockquote>
<p>The maximum number of seconds to wait for the job to finish.</p>
<p>The default is to try forever (<strong>timeout</strong> is set to <em>None</em> or 0).</p>
</blockquote>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="op-cmd-none-vsys-none-cmd-xml-false">
<h3>op(cmd=None, vsys=None, cmd_xml=False)</h3>
<blockquote>
<p>The op() method performs the <tt class="docutils literal">type=op</tt> operational command API
request with the <strong>cmd</strong> argument and optional <strong>vsys</strong> argument.
<strong>cmd</strong> is an XML document which represents the command to be executed.
Commands and command options are XML elements, and command arguments
are XML data.  <strong>vsys</strong> can be to to target the command to a specific
Virtual System.</p>
<p>When <strong>cmd_xml</strong> is <em>True</em> a CLI-style <strong>cmd</strong> argument is converted to
XML.  This works by converting all unquoted arguments in <strong>cmd</strong> to
start and end elements and treating double quoted arguments as text
after removing the quotes.  For example:</p>
<ul class="simple">
<li>show system info<ul>
<li>&lt;show&gt;&lt;system&gt;&lt;info&gt;&lt;/info&gt;&lt;/system&gt;&lt;/show&gt;</li>
</ul>
</li>
<li>show interface &quot;ethernet1/1&quot;<ul>
<li>&lt;show&gt;&lt;interface&gt;ethernet1/1&lt;/interface&gt;&lt;/show&gt;</li>
</ul>
</li>
</ul>
</blockquote>
</div>
<div class="section" id="export-category-none-from-name-none">
<h3>export(category=None, from_name=None)</h3>
</div>
<div class="section" id="export-category-none-pcapid-none-search-time-none-serialno-none">
<h3>export(category=None, pcapid=None, search_time=None, serialno=None)</h3>
<blockquote>
<p>The export() method performs the <tt class="docutils literal">type=export</tt> export file API
request with the <strong>category</strong> argument and optional <strong>from</strong> argument
(<em>from_name</em> function argument).  If the request is successful, the
<strong>export_result</strong> data attribute is a dictionary containing the
following keys:</p>
<ul class="simple">
<li>file: content-disposition response header filename</li>
<li>content: file contents</li>
<li>category: export category string</li>
</ul>
<p>The <strong>category</strong> argument specifies the type of file to export.  The
<strong>from_name</strong> argument is used to specify the source for a file list
or file export.</p>
</blockquote>
<div class="section" id="threat-pcap-export">
<h4>Threat PCAP export</h4>
<blockquote>
<p>In PAN-OS 6.0 the extended packet capture feature was added and is
used for threat PCAPs.  As a result the <strong>from</strong> argument is no
longer used to specify the source file, and it is not possible to
obtain a file list.</p>
<p>The PCAP is specified using the <strong>pcapid</strong>, <strong>search_time</strong> and
<strong>serialno</strong> arguments.</p>
<p><strong>pcapid</strong> is a unique numeric identifier for the extended PCAP
and is obtained from the <strong>pcap_id</strong> field in the THREAT log.</p>
<p><strong>search_time</strong> is used to narrow the search for the PCAP ID and is
used to set a time window in the range <em>-5 minutes</em> to <em>+2 hours</em> of
the time specified.  The search time is typically set to the
<strong>receive_time</strong> field in the THREAT log.  The PAN-OS log time string
format is used, for example: 2015/01/20 10:51:09.</p>
<p><strong>search_time</strong> is required in the API request; if not specified in
the export() method it will be set to the threat epoch time which is
part of the <strong>pcapid</strong>.</p>
<p><strong>serialno</strong> is required when exporting from Panorama and is used to
specify the device of the PCAP.  It is also currently required when
exporting from firewall devices, however this requirement will be
removed in a future version of PAN-OS.</p>
</blockquote>
</div>
</div>
<div class="section" id="log-self-log-type-none-nlogs-none-skip-none-filter-none-interval-none-timeout-none">
<h3>log(self, log_type=None, nlogs=None, skip=None, filter=None, interval=None, timeout=None)</h3>
<blockquote>
<p>The log() method performs the <tt class="docutils literal">type=log</tt> retrieve log API request
with the <strong>log-type</strong> argument.</p>
<p><strong>log-type</strong> specifies the type of log to retrieve and can be:</p>
<ul class="simple">
<li>config</li>
<li>hipmatch</li>
<li>system</li>
<li>threat</li>
<li>traffic</li>
<li>url</li>
<li>wildfire</li>
</ul>
<p>Additional API request arguments include:</p>
<ul class="simple">
<li><strong>nlogs</strong></li>
</ul>
<blockquote>
<p>Specify the number of logs to retrieve.</p>
<p>The default is 20 and the maximum is 5000.</p>
<p><strong>pan.xapi</strong> currently loads the entire XML document into memory
using the <strong>ElementTree</strong> module.  A large number of log entries can
cause a memory exception which may not be possible to catch.  If you
see exceptions when using a large <strong>nlog</strong> value try reducing it.</p>
</blockquote>
<ul class="simple">
<li><strong>skip</strong></li>
</ul>
<blockquote>
<p>Specify the number of logs to skip. This can be used to retrieve log
entries in batches by skipping previously retrieved logs.</p>
<p>The default is 0.</p>
</blockquote>
<ul class="simple">
<li><strong>filter</strong></li>
</ul>
<blockquote>
<p>Specify the log query selection filter.  This is a set of log
filter expressions as can be specified in the Monitor tab in the
Web UI.</p>
<p>This is the <strong>query</strong> argument in the API request.</p>
</blockquote>
<p>The XML API schedules a job to create the log data; the log() method
will then periodically perform an API request to determine if the
job ID returned in the initial request is complete and receive the log
data.  Additional arguments to control the polling include:</p>
<ul class="simple">
<li><strong>interval</strong></li>
</ul>
<blockquote>
<p>A floating point number specifying the query interval in seconds
between each non-finished job status response.</p>
<p>The default is 0.5 seconds.</p>
</blockquote>
<ul class="simple">
<li><strong>timeout</strong></li>
</ul>
<blockquote>
<p>The maximum number of seconds to wait for the job to finish.</p>
<p>The default is to try forever (<strong>timeout</strong> is set to <em>None</em> or 0).</p>
</blockquote>
</blockquote>
</div>
<div class="section" id="extra-qs-none">
<h3>extra_qs=None</h3>
<blockquote>
<p>All API methods have an additional argument that can be used to
modify (replace) and augment (add to) the standard parameters in the
request.</p>
<p><strong>extra_qs</strong> is either a query string with field=value pairs
separated by ampersand (<strong>&amp;</strong>) or a dictionary of field, value pairs.
The parameters will be URL-encoded before performing the API request.</p>
</blockquote>
</div>
<div class="section" id="xml-root">
<h3>xml_root()</h3>
<blockquote>
The xml_root() method returns the XML document from the previous
request as a string starting at the root node.</blockquote>
</div>
<div class="section" id="xml-result">
<h3>xml_result()</h3>
<blockquote>
The xml_root() method returns the XML document from the previous
request as a string starting at the child of the result element.</blockquote>
</div>
<div class="section" id="status">
<h3>status</h3>
<blockquote>
<p>The status data attribute contains the XML response element status
attribute received from the previous API request.  Possible values
are:</p>
<ul class="simple">
<li>success</li>
<li>error</li>
<li>unauth</li>
</ul>
</blockquote>
</div>
<div class="section" id="status-code">
<h3>status_code</h3>
<blockquote>
The status_code data attribute contains the XML response element
code attribute from the previous API request if one is available.</blockquote>
</div>
<div class="section" id="status-detail">
<h3>status_detail</h3>
<blockquote>
The status_detail data attribute contains the XML status message
received from the previous API request if one is available.  This is
the value within a msg or line element.</blockquote>
</div>
<div class="section" id="text-document">
<h3>text_document</h3>
<blockquote>
The text_document data attribute contains the message body from the
previous API request when the response content-type is text/plain.</blockquote>
</div>
<div class="section" id="export-result">
<h3>export_result</h3>
<blockquote>
<p>The export_result data attribute is a dictionary containing the
result of the previous export() method request when the response
content-disposition is attachment.  The dictionary contains the
following keys:</p>
<ul class="simple">
<li>file: content-disposition response header filename</li>
<li>content: file contents</li>
<li>category: export category string</li>
</ul>
</blockquote>
</div>
<div class="section" id="element-root">
<h3>element_root</h3>
<blockquote>
The element_root data attribute is set to the root element of the
parsed response document XML tree; it is an <strong>Element</strong> object and is
set using etree.ElementTree.fromstring().</blockquote>
</div>
</div>
<div class="section" id="debugging-and-logging">
<h2>Debugging and Logging</h2>
<blockquote>
<p>The Python standard library <tt class="docutils literal">logging</tt> module is used to log debug
output; by default no debug output is logged.</p>
<p>In order to obtain debug output the <tt class="docutils literal">logging</tt> module must be
configured: the logging level must be set to one of <strong>DEBUG1</strong>,
<strong>DEBUG2</strong>, or <strong>DEBUG3</strong> and a handler must be configured.
<strong>DEBUG1</strong> enables basic debugging output and <strong>DEBUG2</strong> and
<strong>DEBUG3</strong> specify increasing levels of debug output.</p>
<p>For example, to configure debug output to <strong>stderr</strong>:</p>
<pre class="literal-block">
import logging

if options['debug']:
    logger = logging.getLogger()
    if options['debug'] == 3:
        logger.setLevel(pan.xapi.DEBUG3)
    elif options['debug'] == 2:
        logger.setLevel(pan.xapi.DEBUG2)
    elif options['debug'] == 1:
        logger.setLevel(pan.xapi.DEBUG1)

    handler = logging.StreamHandler()
    logger.addHandler(handler)
</pre>
</blockquote>
</div>
<div class="section" id="set-and-edit">
<h2>set and edit</h2>
<blockquote>
<p>set and edit are similar, and have subtle differences.</p>
<p>set can be described as a merge operation at the XPath node:</p>
<ul class="simple">
<li>set will create new objects</li>
<li>set will update existing objects</li>
<li>set will not delete existing objects</li>
</ul>
<p>edit can be described as a replace operation at the Xpath node:</p>
<ul class="simple">
<li>edit will create new objects</li>
<li>edit will update existing objects</li>
<li>edit will delete existing objects</li>
</ul>
</blockquote>
</div>
<div class="section" id="get-and-show">
<h2>get and show</h2>
<blockquote>
<p>get is used to retrieve the <em>candidate</em> configuration and show
is used to retrieve the <em>active</em> configuration.</p>
<p>XPath matching for get and show has differences.</p>
<p>get:</p>
<ul class="simple">
<li>return values even if the XPath matches multiple nodes</li>
<li>return values only if the resulting nodes are not text nodes and
are actual elements in the XML</li>
</ul>
<p>show:</p>
<ul class="simple">
<li>return values only if the XPath results in exactly one node</li>
<li>return the result even if the matched node is a text node</li>
</ul>
</blockquote>
</div>
<div class="section" id="panrc">
<h2>.panrc</h2>
<blockquote>
<p>.panrc files contain hostname, port, serial number, username,
password and key variables for XML API access on PAN-OS firewalls.  A
.panrc file consists of lines with the format:</p>
<pre class="literal-block">
varname[%tagname]=value
</pre>
<p>Empty lines and lines starting with pound (<strong>#</strong>) are ignored.  For
example:</p>
<pre class="literal-block">
api_username=api
api_password=admin
hostname=192.168.1.1

# admin API key
api_key=C2M1P2h1tDEz8zF3SwhF2dWC1gzzhnE1qU39EmHtGZM=
hostname=192.168.1.1
</pre>
<p><em>tagname</em> is optional and can be appended to <em>varname</em> with percent
(<strong>%</strong>).  This form is used to allow a single .panrc file to contain
variables for multiple systems.  The PanXapi constructor has an
optional <strong>tag</strong> argument to specify that only a <em>varname</em> with the
given <em>tagname</em> be used.  For example:</p>
<pre class="literal-block">
# no tag
hostname=172.29.9.122
api_username=admin
api_password=goodpw

# fw-test
hostname%fw-test=172.29.9.123
api_username%fw-test=admin
api_password%fw-test=admin

# eng-fw
hostname%eng-fw=172.29.9.124
api_key%eng-fw=C2M1P2h1tDEz8zF3SwhF2dWC1gzzhnE1qU39EmHtGZM=
</pre>
<p><em>tagname</em> must match the regular expression <strong>/^[w-]+$/</strong> (1 or more
alphanumeric characters plus &quot;-&quot; and &quot;_&quot;).</p>
</blockquote>
<div class="section" id="recognized-varname-values">
<h3>Recognized varname Values</h3>
<blockquote>
<p>The following <em>varname</em> values are recognized:</p>
<ul class="simple">
<li><strong>hostname</strong></li>
<li><strong>port</strong></li>
<li><strong>serial</strong></li>
<li><strong>api_username</strong></li>
<li><strong>api_password</strong></li>
<li><strong>api_key</strong></li>
</ul>
</blockquote>
</div>
<div class="section" id="panrc-locations-and-variable-merging">
<h3>.panrc Locations and Variable Merging</h3>
<blockquote>
A .panrc file can reside in the current working directory
($PWD/.panrc) and in the user's home directory ($HOME/.panrc).
.panrc variables can also be specified in the PanXapi constructor.
When a variable exists from multiple sources, the priority for
merging variables is: __init__(), $PWD/.panrc, $HOME/.panrc.</blockquote>
</div>
</div>
</div>
<div class="section" id="files">
<h1>FILES</h1>
<blockquote>
<dl class="docutils">
<dt><tt class="docutils literal">.panrc</tt></dt>
<dd>.panrc file</dd>
</dl>
</blockquote>
</div>
<div class="section" id="examples">
<h1>EXAMPLES</h1>
<blockquote>
The <strong>panxapi.py</strong> command line program calls each available
PanXapi method and can be reviewed for sample usage.</blockquote>
</div>
<div class="section" id="see-also">
<h1>SEE ALSO</h1>
<blockquote>
<p>panxapi.py</p>
<dl class="docutils">
<dt>PAN-OS 6.1 XML API Reference</dt>
<dd><a class="reference external" href="https://www.paloaltonetworks.com/documentation/61/pan-os.html">https://www.paloaltonetworks.com/documentation/61/pan-os.html</a></dd>
</dl>
</blockquote>
</div>
<div class="section" id="authors">
<h1>AUTHORS</h1>
<blockquote>
Kevin Steves &lt;<a class="reference external" href="mailto:kevin.steves&#64;pobox.com">kevin.steves&#64;pobox.com</a>&gt;</blockquote>
</div>
<div class="section" id="caveats">
<h1>CAVEATS</h1>
<blockquote>
The XML API provides no version mechanism.  PanXapi does not obtain
the PAN-OS version in order to determine API features and relies on
the API to return errors for requests not supported on a PAN-OS
version.</blockquote>
</div>
</div>
</body>
</html>
