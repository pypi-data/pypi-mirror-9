<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Other Providers &mdash; Flask Dance 0.4.1 documentation</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.4.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Flask Dance 0.4.1 documentation" href="index.html" />
    <link rel="next" title="Token Storage" href="token-storage.html" />
    <link rel="prev" title="Pre-set Configurations" href="contrib.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body>
  
  

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="token-storage.html" title="Token Storage"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="contrib.html" title="Pre-set Configurations"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Flask Dance 0.4.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="other-providers">
<h1>Other Providers<a class="headerlink" href="#other-providers" title="Permalink to this headline">Â¶</a></h1>
<p>Flask-Dance allows you to build authentication blueprints for any OAuth
provider, not just the <a class="reference internal" href="contrib.html"><em>pre-set configurations</em></a>.
For these examples, we&#8217;ll reimplement the Github provider,
but you could use whatever values you want.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">flask</span> <span class="kn">import</span> <span class="n">Flask</span>
<span class="kn">from</span> <span class="nn">flask_dance.consumer</span> <span class="kn">import</span> <span class="n">OAuth2ConsumerBlueprint</span>

<span class="n">app</span> <span class="o">=</span> <span class="n">Flask</span><span class="p">(</span><span class="n">__name__</span><span class="p">)</span>
<span class="n">github_blueprint</span> <span class="o">=</span> <span class="n">OAuth2ConsumerBlueprint</span><span class="p">(</span>
    <span class="s">&quot;github&quot;</span><span class="p">,</span> <span class="n">__name__</span><span class="p">,</span>
    <span class="n">client_key</span><span class="o">=</span><span class="s">&quot;my-key-here&quot;</span><span class="p">,</span>
    <span class="n">client_secret</span><span class="o">=</span><span class="s">&quot;my-secret-here&quot;</span><span class="p">,</span>
    <span class="n">scope</span><span class="o">=</span><span class="s">&quot;user:email&quot;</span><span class="p">,</span>
    <span class="n">base_url</span><span class="o">=</span><span class="s">&quot;https://api.github.com&quot;</span><span class="p">,</span>
    <span class="n">access_token_url</span><span class="o">=</span><span class="s">&quot;https://github.com/login/oauth/access_token&quot;</span><span class="p">,</span>
    <span class="n">authorize_url</span><span class="o">=</span><span class="s">&quot;https://github.com/login/oauth/authorize&quot;</span><span class="p">,</span>
    <span class="n">redirect_to</span><span class="o">=</span><span class="s">&quot;index&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">app</span><span class="o">.</span><span class="n">register_blueprint</span><span class="p">(</span><span class="n">github_blueprint</span><span class="p">,</span> <span class="n">url_prefix</span><span class="o">=</span><span class="s">&quot;/login&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, in your page template, you can do something like:</p>
<div class="highlight-jinja"><div class="highlight"><pre><span class="x">&lt;a href=&quot;</span><span class="cp">{{</span> <span class="nv">url_for</span><span class="o">(</span><span class="s2">&quot;github.login&quot;</span><span class="o">)</span> <span class="cp">}}</span><span class="x">&quot;&gt;Login with Github&lt;/a&gt;</span>
</pre></div>
</div>
<p><tt class="docutils literal"><span class="pre">url_for(&quot;github.login&quot;)</span></tt> will resolve to <tt class="docutils literal"><span class="pre">/login/github</span></tt> by default,
which will kick off the OAuth dance. The application will fetch an access token
from the configured <tt class="docutils literal"><span class="pre">access_token_url</span></tt>, then redirect the user to the
<tt class="docutils literal"><span class="pre">authorize_token_url</span></tt>. When the user authorizes with the OAuth provider,
the user will be redirected back to <tt class="docutils literal"><span class="pre">/login/github/authorized</span></tt>, which
will save the OAuth tokens and redirect the user back to the home page.
Of course, all of the details of this process can be configured and overriden
to make sure that you dance the OAuth dance precisely the way <em>you</em> want.</p>
<p>Once you&#8217;ve got your OAuth credentials, making authenticated requests couldn&#8217;t
be easier!</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">github</span> <span class="o">=</span> <span class="n">github_blueprint</span><span class="o">.</span><span class="n">session</span>
<span class="n">resp</span> <span class="o">=</span> <span class="n">github</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&quot;/user&quot;</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">resp</span><span class="o">.</span><span class="n">ok</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;Hi, @{login}!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">login</span><span class="o">=</span><span class="n">resp</span><span class="o">.</span><span class="n">json</span><span class="p">()[</span><span class="s">&quot;login&quot;</span><span class="p">]))</span>
</pre></div>
</div>
<p>The <tt class="xref py py-attr docutils literal"><span class="pre">session</span></tt> object attached to the blueprint
is a <a class="reference external" href="http://docs.python-requests.org/en/latest/api/#requests.Session" title="(in Requests v2.5.3)"><tt class="xref py py-class docutils literal"><span class="pre">requests.Session</span></tt></a> object that is already properly configured
with your OAuth credentials. The fact that you are using OAuth is
completely transparent &#8211; you don&#8217;t even have to think about it!</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper"><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="contrib.html" title="previous chapter">Pre-set Configurations</a></li>
      <li>Next: <a href="token-storage.html" title="next chapter">Token Storage</a></li>
  </ul></li>
</ul>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/consumers.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  
    <a href="http://github.com/singingwolfboy/flask-dance" class="github"><img src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" /></a>
  

  <div class="footer">
    &copy; Copyright 2014, David Baumgold.
    Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
  </div>
  
  </body>
</html>