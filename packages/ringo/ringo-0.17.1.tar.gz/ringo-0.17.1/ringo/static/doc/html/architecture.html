<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Architecture &mdash; Ringo 0.15.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.15.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Ringo 0.15.1 documentation" href="index.html" />
    <link rel="next" title="Development" href="development.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Ringo 0.15.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="architecture">
<h1>Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h1>
<p>The architecture of ringo is shown below.</p>
<img alt="Schema of a modul." src="_images/applayers.png" />
<p>Ringo is a Pyramid based application which can be extended to build your own
applications. This is a layered architecture where Pyramid brings in the basic
functionality like session handling and handling requests and responses in web
applications.  Ringo sits on top of Pyramid and provides commonly used
functionality often used in modern web applications. See <a class="reference internal" href="overview.html#features"><em>Features</em></a> for
an overview.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ringo is also a standalone application. You do not need to build another
application on top of ringo to get something working to get an impression
of ringo or start developing. Ringo is under steady development. This is a
benefit if you use Ringo as base for your application. Your application
will get bug fixes, new features or improved functionality in most cases by
simply updating Ringo to a new version.</p>
</div>
<p>Ringo itself uses some external libraries to provide some of its
functionality. E.g the formbar library is used to build all forms and do
validation. The access to the database is done with the ORM SQLAlchemy.</p>
<p>A ringo based application is another pyramid based application which basically
extends ringo. See <a class="reference external" href="http://docs.pylonsproject.org/projects/pyramid/en/latest/narr/extending.html">Exending An Existing Pyramid Application</a>
for more details on how this is done.</p>
<p>All this magic is already done in a pyramid scaffold which comes with ringo.
Using this scaffold will create an application which uses ringo functionality
by simply importing it at the right places and take care the basic
configuration is done in the proper way. See
<a class="reference internal" href="development.html#create-ringo-based-application"><em>General</em></a> for information on how to create an
application using this scaffold.</p>
<div class="section" id="filesystem">
<h2>Filesystem<a class="headerlink" href="#filesystem" title="Permalink to this headline">¶</a></h2>
<p>Ringo is organised in the following file layout:</p>
<div class="highlight-python"><div class="highlight"><pre>.
├── alembic
├── docs
└── ringo
   ├── lib
   ├── locale
   ├── model
   ├── scaffolds
   ├── scripts
   ├── static
   │   ├── bootstrap
   │   ├── css
   │   ├── images
   │   └── js
   ├── templates
   │   ├── auth
   │   ├── default
   │   ├── internal
   │   ├── mails
   │   └── users
   ├── tests
   ├── teens
   └── views
       ├── forms
       └── tables
</pre></div>
</div>
<dl class="docutils">
<dt>alembic</dt>
<dd>Migration scripts for the database.</dd>
<dt>docs</dt>
<dd>Documentation of ringo. This documentation.</dd>
<dt>ringo</dt>
<dd>The ringo application.</dd>
<dt>ringo/lib</dt>
<dd>Helper libraries. lenderers, validators, security related functions.</dd>
<dt>ringo/locale</dt>
<dd>i18n Internationalisation</dd>
<dt>ringo/model</dt>
<dd>Models for users, usergroups, modules, roles etc.</dd>
<dt>ringo/scaffolds</dt>
<dd>A scaffolds includes the boilerplate code to create a ringo based application.</dd>
<dt>ringo/scripts</dt>
<dd>Administration commands and scripts.</dd>
<dt>ringo/static</dt>
<dd>Static files like images or CSS and JS scripts.</dd>
<dt>ringo/templates</dt>
<dd>Templates for various parts of the application. Templates in the internal
folder are used internally by customs form or overview renderers. The
default folder has the templates for default CRUD actions and confirmation dialogs.</dd>
<dt>ringo/tests</dt>
<dd>Unit tests and behaviour driven tests. See <em class="xref std std-ref">tests</em> for more details.</dd>
<dt>ringo/tweens</dt>
<dd>Middleware like code. Used to modify headers in response objects.</dd>
<dt>ringo/views</dt>
<dd>Views with the business logic for the application.</dd>
<dt>ringo/views/forms</dt>
<dd>Configuration of forms for each modul.</dd>
<dt>ringo/views/tables</dt>
<dd>Configuration of overview tables for each modul.</dd>
</dl>
</div>
<div class="section" id="database">
<h2>Database<a class="headerlink" href="#database" title="Permalink to this headline">¶</a></h2>
<p>Below you see the basic schema of the ringo database. The schema only lists
some central tables which help to understand how the things are wired together
in ringo. The table colored orange <cite>example</cite> table in the top left is an
example for any other table which will store items of a modul.
Every item of an item has a reference to the module it belogs to. Further the
current example has a reference to a user and a usergroup which defines the
ownership <a class="footnote-reference" href="#id2" id="id1">[1]</a> per item is is important for the authorisation.</p>
<img alt="Basic database model." src="_images/database.png" />
<p>Let us begin with the <cite>modules</cite> table. This table will store information on
all available modules in the system. It basically stores the configuration per
modul.  As described in the <a class="reference internal" href="ui.html#modules"><em>Overviews</em></a> section each modul has
(<em class="xref std std-ref">module_actions</em>) which are stored in the <cite>actions</cite> table. The NM-table
<cite>nm_actions_roles</cite> define which <cite>roles</cite> are allowed to use the actions in the
module. See <em class="xref std std-ref">permissionsystem</em> for more information on how the
<a class="reference internal" href="#authorisation"><em>Authorisation</em></a> is implemented in ringo.</p>
<p>The <cite>users</cite> table stores all the users in ringo. The users table only holds
minimal data which is required for authentification and authorisation.
Additional information like the name, email etc. is stored in the <cite>profiles</cite>
table. Every user has a profile.</p>
<p>Users can be organised in groups using the <cite>nm_user_groups</cite> table. All
usergroups are stored in the <cite>usergroups</cite> table. Roles can be assigned to
usergroups and users. This is done with the NM-table <cite>nm_user_roles</cite> and
<cite>nm_usergroup_roles</cite>.</p>
<p>The table <cite>user_settings</cite> and <cite>password_reset_request</cite> are helper tables to
save user settings like saved search queries or store the tokens to trigger
the password reset.</p>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>The ownership feature can be added by using the <a class="reference internal" href="#mixin-owned"><em>Owned</em></a>
mixin.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="modules">
<span id="id3"></span><h2>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h2>
<p>The term &#8220;Module&#8221; is central and often used in ringo. Therefore it is important
to understand what a module is. This section tries to explain that.</p>
<img alt="Schema of a module." src="_images/modules.png" />
<p>You can think of a module in the way that it provides the infrastructure to
work with a certain type of data in a web application. Where certain type of
data means users, files, movies etc. rather than integers or datevalues. Lets
call them items from now on.</p>
<p>A module will have a model for the items you want to work with. It will include
views to handle incoming request and generating the proper responses for
users. Further it has templates which define how the pages in the application
will look like. Finally there are configuration files to define how the forms
and overview tables will look like.</p>
<p>Ringo already come with many modules. One module per item. There is a module
for the user management, a module for appointment and so on. There is also a
module to handle the modules itself. So we can say in general: ringos
functionality is the sum of all modules functionality. Ringo or a ringo based
application can be extended by adding new modules.  Fortunately you will not
need to create this infrastructure for you own. See <a class="reference internal" href="development.html#add-modules"><em>Add a new modul to your application</em></a> for
more information.</p>
<p>Each module has a common set of configuration options which can be done
directly in the web interface. See the modules entry in the administion menu
for more information.</p>
<p>Modules provide actions which can be used to manipulate the item of a module.
Ringo provides some basic CRUD <a class="footnote-reference" href="#id5" id="id4">[2]</a> actions which are available on default for every module.</p>
<ul class="simple">
<li>Create: Create new items.</li>
<li>Read: Show the item in detail in readonly mode.</li>
<li>Update: Edit items of the module.</li>
<li>Delete: Deleting items.</li>
<li>List: Listing all items of the module. This is slightly different to the action to read a single item.</li>
<li>Import (CSV, JSON)</li>
<li>Export (CSV, JSON)</li>
</ul>
<p>Every time you want to do something different to your items you will likely
want to implement another action for the module. See <a class="reference internal" href="development.html#add-action"><em>Adding a single custom actions to a module</em></a> for
more details how to add actions to a module.</p>
<table class="docutils footnote" frame="void" id="id5" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[2]</a></td><td>CRUD means: Create, Read, Update, Delete</td></tr>
</tbody>
</table>
<div class="section" id="module-ringo.lib.extension">
<span id="extensions"></span><h3>Extensions<a class="headerlink" href="#module-ringo.lib.extension" title="Permalink to this headline">¶</a></h3>
<p>Extensions are external pluggable modules and a option to add generic
functionallity to the application in a dynamic way.</p>
<p>In contrast to modules, extensions are generic and should not implement
application specific stuff. Extensions should be used to create
pluggable modules with generic functionallity which can be usefull for
all kind of applications. An example might be an appointment extensions
which allows the user to extend the application with an appointment
feature.</p>
<p>Extension can be Registered to an application by adding the extentions
in the <cite>extensions</cite> list located in the <cite>modul/__init__.py</cite> file. As
soon as the application is started the extension will be registered.
To unregister a extension simply remove the extension from the
<cite>extentions</cite> list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For extensions which modifies the datamodel of the application a
seperate model migration is needed on registration and
unregistration of the extension. (See alembic and ringo-admin
documentation).</p>
</div>
<p>For more information on how to create and register extensions please
refer to the <a class="reference internal" href="development.html#development"><em>Development</em></a> part of the documentation.</p>
</div>
<div class="section" id="module-ringo.model.mixins">
<span id="mixins"></span><h3>Mixins<a class="headerlink" href="#module-ringo.model.mixins" title="Permalink to this headline">¶</a></h3>
<p>Mixins can be used to add certain functionality to the items of a
module.  Mixins are used in multiple inheritance. The mixin ensures that
the item will have all needed fields in the database and provides the
proper interface to use the added functionality. Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Comment</span><span class="p">(</span><span class="n">BaseItem</span><span class="p">,</span> <span class="n">Nested</span><span class="p">,</span> <span class="n">Meta</span><span class="p">,</span> <span class="n">Owned</span><span class="p">,</span> <span class="n">Base</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&#39;comments&#39;</span>
    <span class="n">_modul_id</span> <span class="o">=</span> <span class="mi">99</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">comment</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="s">&#39;comment&#39;</span><span class="p">,</span> <span class="n">sa</span><span class="o">.</span><span class="n">Text</span><span class="p">)</span>

    <span class="o">...</span>
</pre></div>
</div>
<p>The comment class in the example only defines the two fields <cite>id</cite> and
<cite>comment</cite>. But as it inherits from <a class="reference internal" href="#mixin-nested"><em>Nested</em></a>, <a class="reference internal" href="#mixin-meta"><em>Meta</em></a> and
<a class="reference internal" href="#mixin-owned"><em>Owned</em></a> it also will have date fields with the creation and date of
the last update, references to the user and group which ownes the Comment.
Further the &#8216;Nested&#8217; mixin will ensure the comments can reference each other
to be able to build a hierarchy structure (e.g Threads in the example of the
comments).</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">As most of the mixins will add additional tables and database fields
to your item it is needed to migrate your database to the new model.
See <em class="xref std std-ref">alembic_migration</em> section for more information.</p>
</div>
<div class="section" id="meta">
<span id="mixin-meta"></span><h4>Meta<a class="headerlink" href="#meta" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Meta">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Meta</tt><a class="headerlink" href="#ringo.model.mixins.Meta" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add a created and a updated datefield to items. The
updated datefield will be updated on every update of the item with
the datetime of the update. Date will be saved in UTC</p>
</dd></dl>

</div>
<div class="section" id="owned">
<span id="mixin-owned"></span><h4>Owned<a class="headerlink" href="#owned" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Owned">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Owned</tt><a class="headerlink" href="#ringo.model.mixins.Owned" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add references to a user and a usergroup. This
references are used to build some kind of ownership of the item. The
ownership is used from the permission system.</p>
<p>It is posible to configure inhertinace of the owner and group from
a given parent element. This information is used only while creating
new instances of the modul. If configured, the default group and
owner information will be overwritten. This is done at the very end
of the creation process. See &#8216;&#8217;save&#8217;&#8217; method of the BaseItem. You
can configure the inhertiance by setting the name of the relation to
the parent item in the &#8216;&#8217;_inherit_gid&#8217;&#8217; and &#8216;&#8217;_inherit_uid&#8217;&#8217; class
variable.</p>
</dd></dl>

</div>
<div class="section" id="nested">
<span id="mixin-nested"></span><h4>Nested<a class="headerlink" href="#nested" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Nested">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Nested</tt><a class="headerlink" href="#ringo.model.mixins.Nested" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to make nested (self-reference) Items possible. Each item
can have a parent item and many children. The class will add two
relation attribute to the inheriting class. The parent item is
available under the <em>parent</em> attribute. The children items are
available under the <em>children</em> attribute.</p>
</dd></dl>

</div>
<div class="section" id="logged">
<span id="mixin-logged"></span><h4>Logged<a class="headerlink" href="#logged" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Logged">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Logged</tt><a class="headerlink" href="#ringo.model.mixins.Logged" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add logging functionallity to a modul. Adding this Mixin
the item of a modul will have a &#8220;logs&#8221; relationship containing all
the log entries for this item. Log entries can be created
automatically by the system or may be created manual by the user.
Manual log entries. Needs to be configured (Permissions)</p>
</dd></dl>

</div>
<div class="section" id="versioned">
<span id="mixin-versioned"></span><h4>Versioned<a class="headerlink" href="#versioned" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Versioned">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Versioned</tt><a class="headerlink" href="#ringo.model.mixins.Versioned" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add version functionallity to a modul. This mixin is
used to store different &#8220;versions&#8221; of an item. On each update of
the item, the serialized values of the item will be saved in the
version table. Item modul will have a &#8220;versions&#8221; relationship
containing all versions of the values for this item.</p>
</dd></dl>

</div>
<div class="section" id="statemixin">
<span id="mixin-state"></span><h4>StateMixin<a class="headerlink" href="#statemixin" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.StateMixin">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">StateMixin</tt><a class="headerlink" href="#ringo.model.mixins.StateMixin" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add one or more Statemachines to an item.  The
statemachines are stored in a internal &#8216;_statemachines&#8217; dictionary.
The current state is stored as integer value per item. This field
must be created manually.  The name of the field which stores the
value for the current state must be the keyname of the
&#8216;_statemachines&#8217; dictionary.</p>
<p>Example Mixin usage:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">FooMixin</span><span class="p">(</span><span class="n">StateMixin</span><span class="p">):</span>
    <span class="c"># Mixin inherited from the StateMixin to add the Foobar</span>
    <span class="c"># state machine</span>

    <span class="c"># Attach the statemachines to an internal dictionary</span>
    <span class="n">_statemachines</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;foo_state_id&#39;</span><span class="p">:</span> <span class="n">FooStatemachine</span><span class="p">}</span>

    <span class="c"># Configue a field in the model which saves the current</span>
    <span class="c"># state per state machine</span>
    <span class="n">foo_state_id</span> <span class="o">=</span> <span class="n">sa</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">sa</span><span class="o">.</span><span class="n">Integer</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c"># Optional. Create a property to access the statemachine</span>
    <span class="c"># like an attribute. This gets usefull if you want to access</span>
    <span class="c"># the state in overview lists.</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">foo_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_statemachine</span><span class="p">(</span><span class="s">&#39;foo_state_id&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">state</span><span class="o">.</span><span class="n">get_state</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="commented">
<h4>Commented<a class="headerlink" href="#commented" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Commented">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Commented</tt><a class="headerlink" href="#ringo.model.mixins.Commented" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add comment functionallity to a modul. Adding this Mixin
the item of a modul will have a &#8220;comments&#8221; relationship containing all
the comment entries for this item.</p>
</dd></dl>

</div>
<div class="section" id="tagged">
<h4>Tagged<a class="headerlink" href="#tagged" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Tagged">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Tagged</tt><a class="headerlink" href="#ringo.model.mixins.Tagged" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add tag (keyword) functionallity to a modul. Adding this Mixin
the item of a modul will have a &#8220;tags&#8221; relationship containing all
the tag entries for this item.</p>
</dd></dl>

</div>
<div class="section" id="todo">
<h4>Todo<a class="headerlink" href="#todo" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Todo">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Todo</tt><a class="headerlink" href="#ringo.model.mixins.Todo" title="Permalink to this definition">¶</a></dt>
<dd><p>Mixin to add todo functionallity to a modul. Adding this Mixin
the item of a modul will have a &#8220;todo&#8221; relationship containing all
the todo entries for this item.</p>
</dd></dl>

</div>
<div class="section" id="printable">
<h4>Printable<a class="headerlink" href="#printable" title="Permalink to this headline">¶</a></h4>
<dl class="class">
<dt id="ringo.model.mixins.Printable">
<em class="property">class </em><tt class="descclassname">ringo.model.mixins.</tt><tt class="descname">Printable</tt><a class="headerlink" href="#ringo.model.mixins.Printable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>
<div class="section" id="event-handlers">
<h3>Event Handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h3>
<p>Each modul can implement one of the following event handlers to realize
automatic modifications of the items:</p>
<blockquote>
<div><ul class="simple">
<li>create_event_handler(request, item, **kwargs)</li>
<li>update_event_handler(request, item, **kwargs)</li>
<li>delete_event_handler(request, item, **kwargs)</li>
</ul>
</div></blockquote>
<p>The functions will be called for all base classes of the item
automatically in the base controller if the specific view function for
the event (update, create, delete) is excecuted.</p>
<p>Some of the Mixin classes do already have some predefined event_handlers
configured.</p>
</div>
</div>
<div class="section" id="security">
<h2>Security<a class="headerlink" href="#security" title="Permalink to this headline">¶</a></h2>
<p>Security is an important aspect of ringo. This chapter will describe the
permission system and explains how ringo handle common security threats.</p>
<div class="section" id="permission-system">
<h3>Permission System<a class="headerlink" href="#permission-system" title="Permalink to this headline">¶</a></h3>
<p>The permission system addresses two basic questions:</p>
<ol class="arabic simple">
<li><strong>Who is allowed</strong> to access some item in general and</li>
<li><strong>What is allowed</strong> for the user to access, in case he is generally allowed
to access the item.</li>
</ol>
<p>To answer these two questions the permission system of Ringo is a combination
of concepts of the permission system known from the <a class="reference external" href="http://http://en.wikipedia.org/wiki/File_system_permissions">Unix file system</a> and a
<a class="reference external" href="http://http://en.wikipedia.org/wiki/Role-based_access_control">roles based permission system</a>.</p>
<a class="reference internal image-reference" href="_images/permissions.png"><img alt="Activity diagram of the permission check." src="_images/permissions.png" style="width: 500px;" /></a>
<p>The Unix file system part answers the first question: Who is allowed? Therefor
every item in the system inherited from the <a class="reference internal" href="#mixin-owned"><em>Owned</em></a> stores
information to which owner and which group it belongs to. Only the owner,
members of the group or users with an administrational role are granted access
to the item in general.</p>
<p>After the permission to access the item in general is allowed, the role bases
system answers the second question: What is allowed. The permission system
will now check which <em class="xref std std-ref">roles</em> the users have and which actions are allowed for
these roles.</p>
<p>There are currently two ways a user can be equiped with permissions:</p>
<p>1. If the user is the owner of the item, or is member of the items group, then
all permissions of the users roles will be applied.</p>
<p>2. If the user is member of the items group, then the permissins of the group
will additionally be applied.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Currently there is no anonymous access to the item. See Issue61 in the
ringo bugtracker. A workaround might be to setup a user group with
all users of the system and assing the needed roles to it. Then set
this group as the item group.</p>
</div>
<p>See <a class="reference internal" href="#authorisation"><em>Authorisation</em></a> for more details on this.</p>
<div class="section" id="authentification">
<span id="id6"></span><h4>Authentification<a class="headerlink" href="#authentification" title="Permalink to this headline">¶</a></h4>
<p>Authentication is done once in the login process. If the user has logged in
successful an auth cookie is saved. From then on the user object is loaded
from the database on every request with the roles and groups attached to the
user.  This user object is used later for the Authorisation. If the user is
not logged in the user object is empty.</p>
<p>The authentification has a default timeout of 30min. The timeout will be reset
after every new request of the user. The timeout can be configured in the
application configuration bei setting the &#8216;auth.timeout&#8217; config variable.</p>
</div>
<div class="section" id="authorisation">
<span id="id7"></span><h4>Authorisation<a class="headerlink" href="#authorisation" title="Permalink to this headline">¶</a></h4>
<p>The permission system in Ringo uses the Pyramid <a class="reference external" href="http://docs.pylonsproject.org/projects/pyramid/en/latest/api/security.html">Pyramid Authorisation and
Authenfication API</a></p>
<p>Authorisation is done on every request. The authorisation will check if the
user is allowed to access the requested resource.</p>
<p>A resource is an url or an item which is accessed by calling the url in your
application.  In all cases this resource is build from a resource factory for
every request.  Every resource will have an ACL which determines if the user of
the current request (See <a class="reference internal" href="#authentification"><em>Authentification</em></a>) is allowed to access the
resource.</p>
<p>Ringo&#8217;s part in the authorisation process is to build the ACL. This ACL is
then used by the Pyramid security API. Therefor ringo implements helper
functions to build ACL lists which model the ringo permission system.</p>
<p>See <a class="reference external" href="http://docs.pylonsproject.org/projects/pyramid/en/latest/tutorials/wiki2/authorization.html">Adding Authorization tutorial</a>
for more information how things work in general under the hood.</p>
<p>See <a class="reference internal" href="api.html#api-security"><em>Security</em></a> for documentation on helper functions used to build
the ACL.</p>
</div>
</div>
<div class="section" id="security-measurements">
<h3>Security measurements<a class="headerlink" href="#security-measurements" title="Permalink to this headline">¶</a></h3>
<p>Ringo has protection against common threads of webapplication included.</p>
<div class="section" id="csrf-protection">
<h4>CSRF-Protection<a class="headerlink" href="#csrf-protection" title="Permalink to this headline">¶</a></h4>
<p>To protect against CSRF attacks ringo follows the recommodation of <a class="reference external" href="http://url">OWASP</a> and adds a synchroniser token to each form, which will be sent
and checked on each POST request. The token will be unique on every request.
GET requests in ringo are not protected as GET functions in ringo should be
idempotent and does not trigger expensive opertaions. Following this simple
philosophie on GET requests will make any further CSRF protection obsolete.</p>
</div>
<div class="section" id="xss-protection">
<h4>XSS-Protection<a class="headerlink" href="#xss-protection" title="Permalink to this headline">¶</a></h4>
<p>Ringo will add the following headers to protect the application against XSS attacks.</p>
<blockquote>
<div><ul class="simple">
<li>&#8216;X-XSS-Protection&#8217;: &#8216;1; mode=block&#8217;,</li>
<li>&#8216;X-Content-Type-Options&#8217;: &#8216;nosniff&#8217;</li>
</ul>
</div></blockquote>
<p>Further ringo provides an option to enable a contect CSP for further
protection. The CSP is disabled on default but can be enabled in the
application <a class="reference internal" href="config.html#conf-headers"><em>Headers</em></a> configuration.</p>
</div>
<div class="section" id="clickjacking-protection">
<h4>Clickjacking-Protection<a class="headerlink" href="#clickjacking-protection" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="cookie-and-session-security">
<h4>Cookie and Session security<a class="headerlink" href="#cookie-and-session-security" title="Permalink to this headline">¶</a></h4>
</div>
<div class="section" id="dos-protection">
<h4>DOS-Protection<a class="headerlink" href="#dos-protection" title="Permalink to this headline">¶</a></h4>
<p>DOS protection is not handled by ringo. Protection against DOS-attacks should
be handled by the Reverse Proxy or Firewall.</p>
</div>
</div>
</div>
<div class="section" id="module-ringo.model.statemachine">
<span id="states-and-workflows"></span><h2>States and Workflows<a class="headerlink" href="#module-ringo.model.statemachine" title="Permalink to this headline">¶</a></h2>
<p>Ringo offers the option to equip items of the modules with a
one or more state machines to model statefull workflows.</p>
<p>An classical example for a statefull workflow is a process where an item
can be in an <cite>draft</cite>, <cite>review</cite> and <cite>published</cite> state.</p>
<p>The statemachine offers features like</p>
<blockquote>
<div><ul class="simple">
<li>Restrictions on access</li>
<li>Conditional transitions</li>
<li>Handlers.</li>
</ul>
</div></blockquote>
<p>Depending on the state the state machine can be configured to restrict
access to the item for certain users. Further you can define conditions
which must be true before the state can switch into another. Finally you
can write certain handlers which are called right after the state has
changed.</p>
<p>A state machine can be attached to the items using a <a class="reference internal" href="#mixin-state"><em>StateMixin</em></a>
which organises the state machines an provides a unique interface.</p>
<p>For detailed descriptione of the involved classes see API documentation of <a class="reference internal" href="api.html#api-statemachine"><em>Statemachine</em></a></p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Architecture</a><ul>
<li><a class="reference internal" href="#filesystem">Filesystem</a></li>
<li><a class="reference internal" href="#database">Database</a></li>
<li><a class="reference internal" href="#modules">Modules</a><ul>
<li><a class="reference internal" href="#module-ringo.lib.extension">Extensions</a></li>
<li><a class="reference internal" href="#module-ringo.model.mixins">Mixins</a><ul>
<li><a class="reference internal" href="#meta">Meta</a></li>
<li><a class="reference internal" href="#owned">Owned</a></li>
<li><a class="reference internal" href="#nested">Nested</a></li>
<li><a class="reference internal" href="#logged">Logged</a></li>
<li><a class="reference internal" href="#versioned">Versioned</a></li>
<li><a class="reference internal" href="#statemixin">StateMixin</a></li>
<li><a class="reference internal" href="#commented">Commented</a></li>
<li><a class="reference internal" href="#tagged">Tagged</a></li>
<li><a class="reference internal" href="#todo">Todo</a></li>
<li><a class="reference internal" href="#printable">Printable</a></li>
</ul>
</li>
<li><a class="reference internal" href="#event-handlers">Event Handlers</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security">Security</a><ul>
<li><a class="reference internal" href="#permission-system">Permission System</a><ul>
<li><a class="reference internal" href="#authentification">Authentification</a></li>
<li><a class="reference internal" href="#authorisation">Authorisation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#security-measurements">Security measurements</a><ul>
<li><a class="reference internal" href="#csrf-protection">CSRF-Protection</a></li>
<li><a class="reference internal" href="#xss-protection">XSS-Protection</a></li>
<li><a class="reference internal" href="#clickjacking-protection">Clickjacking-Protection</a></li>
<li><a class="reference internal" href="#cookie-and-session-security">Cookie and Session security</a></li>
<li><a class="reference internal" href="#dos-protection">DOS-Protection</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-ringo.model.statemachine">States and Workflows</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="usage.html"
                        title="previous chapter">Usage</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="development.html"
                        title="next chapter">Development</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/architecture.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="development.html" title="Development"
             >next</a> |</li>
        <li class="right" >
          <a href="usage.html" title="Usage"
             >previous</a> |</li>
        <li><a href="index.html">Ringo 0.15.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, 2014 Torsten Irländer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>