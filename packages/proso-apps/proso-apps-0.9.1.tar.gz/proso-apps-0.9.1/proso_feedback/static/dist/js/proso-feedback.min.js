/*! proso-feedback 2014-12-07 */

!function(){"use strict";angular.module("proso.feedback",["ui.bootstrap"]).value("gettext",gettext).directive("feedback",["$modal","$window",function(a,b){return{restrict:"A",link:function(c,d,e){c.feedback={user_agent:b.navigator.userAgent,email:"@",text:""},c.openFeedback=function(){e.email&&(c.feedback.email=e.email),a.open({templateUrl:"feedback_modal.html",controller:f,size:"lg",resolve:{feedback:function(){return c.feedback}}})};var f=["$scope","$modalInstance","$http","$cookies","$location","feedback","gettext",function(a,b,c,d,e,f,g){a.feedback=f,a.alerts=[],a.send=function(){f.page=e.absUrl(),c.defaults.headers.post["X-CSRFToken"]=d.csrftoken,c.post("/feedback/",f).success(function(b){a.alerts.push(b),a.sending=!1,f.text=""}).error(function(){a.alerts.push({type:"danger",msg:g("V aplikaci bohužel nastala chyba.")}),a.sending=!1}),a.sending=!0},a.closeAlert=function(b){a.alerts.splice(b,1)},a.cancel=function(){b.dismiss("cancel")}}]}}}]).directive("ratingModal",["$modal","$window","events","$routeParams","$timeout",function(a,b,c,d,e){return{restrict:"A",link:function(b){var f=["$scope","$modalInstance","$http","$cookies","$location","gettext",function(a,b,c,d,e,f){a.alerts=[],a.vote=function(b){a.answer=b,c.defaults.headers.post["X-CSRFToken"]=d.csrftoken,c.post("/feedback/rating",{value:b}).success(function(b){a.alerts.push(b),a.sending=!1}).error(function(){a.alerts.push({type:"danger",msg:f("V aplikaci bohužel nastala chyba.")}),a.sending=!1}),a.sending=!0},a.closeAlert=function(c){a.alerts.splice(c,1),b.dismiss("cancel")},a.cancel=function(){b.dismiss("cancel")}}];b.ratingPoll=function(){a.open({templateUrl:"rating_modal.html",controller:f})},e(function(){d.debugrating&&b.ratingPoll()},100);var g=[30,70,120,200];c.on("questionSetFinished",function(a){angular.forEach(g,function(c){a>c-10&&c>=a&&b.ratingPoll()})})}}}])}();
//# sourceMappingURL=proso-feedback.min.map