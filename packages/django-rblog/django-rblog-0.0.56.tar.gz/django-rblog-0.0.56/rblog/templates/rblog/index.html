{% extends "site_base.html" %}
{% load thumbnail %}
{% load i18n %}

{% block "content" %}
    <h1>{{ _('Posts') }}{% if tag or byear %}: {{ title }} {% endif %}{% if page_obj.number != 1 %} ({{ _('page') }} {{ page_obj.number }}){% endif %}</h1>
    <ul class="posts">
    {% for post in myposts %}
    <li>
        <article>
            <header>
                <h2><a href="{{ post.get_absolute_url }}" rel="bookmark" title="{{ post.title }}">{{ post.title|safe }}</a></h2>
            </header>
            <footer>
                <address class="vcard author">{{ _('by') }} <a class="url fn" href="{% url app_flatpage-detail %}">author</a></address>
                <time datetime="{{ post.creation_date|date:"c" }}" pubdate="pubdate">{{ post.creation_date|date:"d.m.Y" }}</time>
                - {{ post.hits }} {{ _('lecturas') }}
            </footer>
            {% if post.image %}
                {% thumbnail post.image "128x80" crop="top" as im %}<a href="{{ post.get_absolute_url }}" rel="bookmark" title="{{ post.title }}"><img src="{{ im.url }}" alt="{{ foto }}" /></a>{% endthumbnail %}
            {% elif post.photo.all.0 %}
                {% thumbnail post.photo.all.0 "128x80" crop="top" as im %}<a href="{{ post.get_absolute_url }}" rel="bookmark" title="{{ post.title }}"><img src="{{ im.url }}" alt="{{ foto }}" /></a>{% endthumbnail %}
            {% endif %}
            <p>{{ post.text|safe|striptags|truncatewords:50 }}</p>
        </article>
    </li>
    {% endfor %}
    </ul>

    {% if is_paginated %}
    <ul class="pagination">
        {% if page_obj.has_previous %}
            {% if page_obj.previous_page_number = 1 %}
                {% if tag %}
                    <li><a href="{% url app_blog-with_tag tag %}">{{ _('anterior') }}</a></li>
                {% elif byear %}
                    <li><a href="{% url app_blog-archive byear month %}">{{ _('anterior') }}</a></li>
                {% else %}
                    <li><a href="{% url app_blog-index %}">{{ _('anterior') }}</a></li>
                {% endif %}
            {% else %}
                {% if tag %}
                    <li><a href="{% url app_blog-with_tag_page tag page_obj.previous_page_number %}">{{ _('anterior') }}</a></li>
                {% elif month %}
                    <li><a href="{% url app_blog-archive-page byear month page_obj.previous_page_number %}">{{ _('anterior') }}</a></li>
                {% else %}
                    <li><a href="{% url app_blog-index-page page_obj.previous_page_number %}">{{ _('anterior') }}</a></li>
                {% endif %}
            {% endif %}
        {% endif %}
        <li class="active"><a href="">{{ _('p√°gina') }} {{ page_obj.number }} {{ _('de') }} {{ page_obj.paginator.num_pages }}.</a></li>
        {% if page_obj.has_next %}
            {% if tag %}
                <li><a href="{% url app_blog-with_tag_page tag page_obj.next_page_number %}">{{ _('siguiente') }}</a></li>
            {% elif byear %}
                <li><a href="{% url app_blog-archive-page byear month page_obj.next_page_number %}">{{ _('siguiente') }}</a></li>
            {% else %}
                <li><a href="{% url app_blog-index-page page_obj.next_page_number %}">{{ _('siguiente') }}</a></li>
            {% endif %}
        {% endif %}
    </ul>
    {% endif %}
{% endblock "content" %}

