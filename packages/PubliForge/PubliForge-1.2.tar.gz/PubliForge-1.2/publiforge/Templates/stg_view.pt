<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="base">
<head><title></title></head>
<body>
<div id="mainPanel" metal:fill-slot="main">
  ${form.begin()}
  <!-- ............................... Buttons ............................ -->
  <div id="buttons">
    <div class="first">
      ${request.breadcrumbs.back_button()}
    </div>
    <div class="last">
      <div tal:condition="i_editor" tal:omit-tag="">
        ${form.button(route('storage_edit', storage_id=storage.storage_id), _('Edit'), class_='buttonMain')}
      </div>
      ${form.button(route('storage_root', storage_id=storage.storage_id), _('Browse'))}
      <div tal:condition="i_editor and storage.vcs_engine != 'none'" tal:omit-tag="">
        ${form.submit('rec!.x', _('Recover'))}
      </div>
      ${form.submit('exp!.x', _('Export'))}
    </div>
    <hr class="hidden"/>
  </div>
  <div id="main">
    <h2 id="subtitle" class="storage" title="${_('Storage settings')}">${storage.label}</h2>
    <!-- ............................. Flash .............................. -->
    <div tal:define="flash load: flash.macro.pt" metal:use-macro="flash"/>
    <!-- ................................ Tabs ............................ -->
    <div id="tabSet">
      ${tab_set.toc('tabStorage')}
      <!-- ..... Description ...... -->
      ${tab_set.tab_begin(0, 'd')}
      ${form.grid_item(_('Access:'), _(STORAGE_ACCESS[storage.access]), class_='')}
      ${form.grid_item(_('Identifier:'), storage.storage_id, class_='')}
      ${form.grid_item(_('Label:'), storage.label, class_='')}
      ${form.grid_item(_('Description:'), storage.description, class_='')}
      ${form.grid_item(_('Version control:'),
        _(vcs_engines.get(storage.vcs_engine, storage.vcs_engine)).partition(u'–')[2], class_='')}
      ${form.grid_item(_('Source URL:'), storage.vcs_url, class_='')}
      ${form.grid_item(_('Default user:'), storage.vcs_user, class_='')}
      <div class="formItem">
        <label><em>${_('Synchronization:')}</em></label>
        <div>${REFRESH.get(storage.refresh, _('every ${m} minutes', dict(m=storage.refresh / 60)))}</div>
        <div class="clear"></div>
      </div>
      ${form.grid_item(_('Public URL:'), storage.public_url, class_='')}
      ${form.grid_item(_('Indexed files:'), indexed and _(indexed) or '', class_='')}
      ${tab_set.tab_end()}
      <!-- ........ Openers ........ -->
      ${tab_set.tab_begin(1, 'o')}
      <div class="listActions" tal:condition="openers">
        <div class="first">
          <img src="/Static/Images/opener22.png" alt="${_('Openers')}"/>
          <label>${_('Openers')}</label>
        </div>
        <div class="last"> </div>
      </div>
      <table class="list" tal:condition="openers">
        <caption>${_('Openers')}</caption>
        <tr>
          <th>${_('Identifier')}</th>
          <th>${_('Label')}</th>
          <th>${_('Description')}</th>
        </tr>
        <tr tal:repeat="opener_id openers">
          <td>${opener_id}</td>
          <td>${openers[opener_id][0]}</td>
          <td>${openers[opener_id][1]}</td>
        </tr>
      </table>
      <div tal:condition="not openers">${_('No specific opener.')}</div>
      ${tab_set.tab_end()}
       <!-- ........ Members ....... -->
      ${tab_set.tab_begin(2, 'u')}
      <div tal:condition="storage.access != 'open'"
           tal:define="mbr_view load: mbr_view.macro.pt" metal:use-macro="mbr_view"/>
      <div tal:condition="storage.access == 'open'">${_('Free access.')}</div>
      <div tal:condition="storage.access != 'open' and not members">${_('No authorized user.')}</div>
      ${tab_set.tab_end()}
      <!-- ..... Member groups .... -->
      ${tab_set.tab_begin(3, 'g')}
      <div tal:condition="storage.access != 'open'"
           tal:define="mbr_groups_view load: mbr_groups_view.macro.pt" metal:use-macro="mbr_groups_view"/>
      <div tal:condition="storage.access == 'open'">${_('Free access.')}</div>
      <div tal:condition="storage.access != 'open' and not member_groups">${_('No authorized group.')}</div>
      ${tab_set.tab_end()}
    </div>
  </div>
  ${form.end()}
</div>  
</body>
</html>
