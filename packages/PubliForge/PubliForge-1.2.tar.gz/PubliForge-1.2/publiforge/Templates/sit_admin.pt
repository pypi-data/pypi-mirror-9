<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:use-macro="base">
<head><title></title></head>
<body>
<div id="mainPanel" metal:fill-slot="main">
  ${form.begin(multipart=True)}
  <div id="main">
    <!-- ............................ Main settings ....................... -->
    <div class="description">
      ${form.grid_item(_('Site ID:'), request.registry.settings['uid'], class_='')}
      ${form.grid_item(_('Site label:'),
        request.registry.settings.get('skin.title', 'PubliForge').decode('utf-8'), class_='')}
      <div class="formItem">
        <label><em>${_('languages:')}</em></label>
        <div>
          <i>${request.registry.settings['pyramid.default_locale_name']}</i>,
          ${', '.join([k.strip() for k in request.registry.settings['languages'].split(',')
            if k != request.registry.settings['pyramid.default_locale_name']])}
        </div>
        <div class="clear"></div>
      </div>
      ${form.grid_item(_('Database:'), '%s (%s)' % (db[1], db[0]), class_='')}
      ${form.grid_item(_('Version controls:'), request.registry.settings['storage.vcs'], class_='')}
      ${form.grid_item(_('Agents:'), ', '.join(agent_urls), class_='')}
      ${form.grid_item(_('Processors:'), ', '.join(processor_ids), class_='')}
      ${form.grid_item(_('Openers:'), ', '.join(opener_ids), class_='')}
    </div>
    <!-- ............................. Flash .............................. -->
    <div tal:define="flash load: flash.macro.pt" metal:use-macro="flash"></div>
    <!-- ............................ Action list ......................... -->
    <h3 class="list">${_('Database content')}</h3>
    <div class="listActions">
      <div id="actionParams" tal:condition="action == 'imp?'">
        ${form.grid_upload('xml_file', _('Configuration file:'))}
        <div class="submit">
          ${form.submit('imp!.x', _('Import file'), class_='button')}
          ${form.submit_cancel(_('Cancel'))}
        </div>
      </div>
      <div class="first"></div>
      <div class="last">
        ${form.submit_image('exp!#', _('Export configurations'),
          '/Static/Images/action_export.png')}
        ${form.submit_image('imp?', _('Import configurations'),
          '/Static/Images/action_import.png')}
      </div>
    </div>
    <!-- ........................... Database content ..................... -->
    <div id="content">
      <table class="list">
        <caption>${_('Projects')}</caption>
        <tr>
          <th class="checkbox" id="check_all"></th>
          <th>${_('Object')}</th>
          <th class="center">${_('Quantity')}</th>
          <th class="last">${_('Action')}</th>
        </tr>
        <tr>
          <td class="checkbox">
            ${form.checkbox('#users', id=None, class_='listCheck')}
          </td>
          <td><a href="${route('user_admin')}" class="slow">${_('Users')}</a></td>
          <td class="center">${quantity['users']}</td>
          <td class="last">
            ${form.submit_image('exp!users', _('Export users'),
              '/Static/Images/action_export_one.png')}
          </td>
        </tr>
        <tr>
          <td class="checkbox">
            ${form.checkbox('#groups', id=None, class_='listCheck')}
          </td>
          <td><a href="${route('group_admin')}" class="slow">${_('Groups')}</a></td>
          <td class="center">${quantity['groups']}</td>
          <td class="last">
            ${form.submit_image('exp!groups', _('Export groups'),
             '/Static/Images/action_export_one.png')}
          </td>
        </tr>
        <tr>
          <td class="checkbox">
            ${form.checkbox('#storages', id=None, class_='listCheck')}
          </td>
          <td>
            <a href="${route('storage_admin')}" class="slow">${_('Storages')}</a>
          </td>
          <td class="center">${quantity['storages']}</td>
          <td class="last">
            ${form.submit_image('exp!storages', _('Export storages'),
              '/Static/Images/action_export_one.png')}
          </td>
       </tr>
        <tr>
          <td class="checkbox">
            ${form.checkbox('#indexers', id=None, class_='listCheck')}
          </td>
          <td>
            <a href="${route('indexer_admin')}" class="slow">${_('Indexers')}</a>
          </td>
          <td class="center">${quantity['indexers']}</td>
          <td class="last">
            ${form.submit_image('exp!indexers', _('Export indexers'),
              '/Static/Images/action_export_one.png')}
          </td>
       </tr>
        <tr>
          <td class="checkbox">
            ${form.checkbox('#projects', id=None, class_='listCheck')}
          </td>
          <td>
            <a href="${route('project_admin')}" class="slow">${_('Projects')}</a>
          </td>
          <td class="center">${quantity['projects']}</td>
          <td class="last">
            ${form.submit_image('exp!projects', _('Export projects'),
              '/Static/Images/action_export_one.png')}
          </td>
        </tr>
      </table>
    </div>
  </div>
  ${form.end()}
</div>
</body>
</html>
