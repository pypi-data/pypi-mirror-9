<div metal:define-macro="container_one" tal:omit-tag=""
     xmlns:tal="http://xml.zope.org/namespaces/tal"
     xmlns:metal="http://xml.zope.org/namespaces/metal">
  <div id="container"
       tal:condition="'container' in request.session  and 'project' in request.session
                      and request.session['project']['perm'] in ('leader', 'packmaker')">
    <h3>${_('Containers')}</h3>
    <div class="legend">
      <div tal:condition="'pack_id' in request.session['container']" class="first">
        <img src="/Static/Images/pack.png" alt="pack" title="${_('Pack')}"/> 
        ${_('Pack "${x}" of project "${y}"',
          dict(x=request.session['container']['pack_label'], y=request.session['project']['label']))}
      </div>
      <div tal:condition="'processing_id' in request.session['container']" class="first">
        <img src="/Static/Images/processing.png" alt="processing" title="${_('Processing')}"/> 
        ${_('Processing "${x}" of project "${y}"',
          dict(x=request.session['container']['processing_label'], y=request.session['project']['label']))}
      </div>
      <div class="last">${form.submit_image('cls!', _('Close'), '/Static/Images/close_light.png')}</div>
    </div>
    <!-- ....... Pack ....... -->
    <div class="content" tal:condition="'pack_id' in request.session['container']"
         tal:define="pack_id request.session['container'].get('pack_id')">
      <div class="nav">
        <div class="first" tal:switch="bool(request.session.peek_flash('message'))">
          <span tal:case="True" class="flash">${request.session.pop_flash('message')[0]}</span>
          <span tal:case="False">${_('Associate this file with:')}</span>
        </div>
        <div class="last">
          ${form.button(route('pack_edit', project_id=request.session['project']['project_id'],
            pack_id=pack_id, _anchor='tab1'), _('View pack'))}
        </div>
      </div>
      <div class="clear"></div>
      <div class="col111">
        <div class="colFirst"><div>
          ${form.submit_image('pck!tpl', _('Add'), '/Static/Images/container_add.png')}
          ${_('Template files')}
        </div></div>
        <div class="col"><div>
          ${form.submit_image('pck!rsc', _('Add'), '/Static/Images/container_add.png')}
          ${_('Resource files')}
        </div></div>
        <div class="colLast"><div>
          ${form.submit_image('pck!fil', _('Add'), '/Static/Images/container_add.png')}
          ${_('Files to process')}
        </div></div>
      </div>
      <div class="clear"></div>
    </div>
    <!-- .... Processing ... -->
    <div class="content" tal:condition="'processing_id' in request.session['container']"
         tal:define="processing_id request.session['container'].get('processing_id')">
      <div class="nav">
        <div class="first" tal:switch="bool(request.session.peek_flash('message'))">
          <span tal:case="True" class="flash">${request.session.pop_flash('message')[0]}</span>
          <span tal:case="False">${_('Associate this file with:')}</span>
        </div>
        <div class="last">
          ${form.button(route('processing_edit', project_id=request.session['project']['project_id'],
            processing_id=processing_id, _anchor='tab2'), _('View processing'))}
        </div>
      </div>
      <div class="clear"></div>
      <div class="col111">
        <div class="colFirst"><div>
          ${form.submit_image('prc!tpl', _('Add'), '/Static/Images/container_add.png')}
          ${_('Template files')}
        </div></div>
        <div class="col"><div>
          ${form.submit_image('prc!rsc', _('Add'), '/Static/Images/container_add.png')}
          ${_('Resource files')}
        </div></div>
        <div class="colLast" tal:condition="request.session['container']['has_output']"><div>
          ${form.submit_image('prc!out', _('Modify'), '/Static/Images/container_select.png')}
          ${_('Output directory')}
        </div></div>
      </div>
      <div class="clear"></div>
    </div>
  </div>
</div>
