<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>trigger.acl — ACL parsing library &mdash; Trigger 1.5 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Trigger 1.5 documentation" href="../index.html" />
    <link rel="next" title="trigger.changemgmt — Change management library" href="changemgmt.html" />
    <link rel="prev" title="Managing Credentials with .tacacsrc" href="../usage/tacacsrc.html" />
 
<style type="text/css">
    span.changelog-support {color: #4070A0;}
    span.changelog-bug {color: #A04040;}
    span.changelog-feature {color: #40A056;}
    a.changelog-release {font-weight: bold;}
</style>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changemgmt.html" title="trigger.changemgmt — Change management library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../usage/tacacsrc.html" title="Managing Credentials with .tacacsrc"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">Trigger 1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="module-trigger.acl">
<span id="trigger-acl-acl-parsing-library"></span><h1><a class="reference internal" href="#module-trigger.acl" title="trigger.acl"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl</span></tt></a> &#8212; ACL parsing library<a class="headerlink" href="#module-trigger.acl" title="Permalink to this headline">¶</a></h1>
<p>Trigger&#8217;s ACL parser.</p>
<p>This library contains various modules that allow for parsing, manipulation,
and management of network access control lists (ACLs). It will parse a complete
ACL and return an ACL object that can be easily translated to any supported
vendor syntax.</p>
<dl class="function">
<dt id="trigger.acl.literals">
<tt class="descclassname">trigger.acl.</tt><tt class="descname">literals</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#trigger.acl.literals" title="Permalink to this definition">¶</a></dt>
<dd><p>Longest match of all the strings that are keys of &#8216;d&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.parse">
<tt class="descclassname">trigger.acl.</tt><tt class="descname">parse</tt><big>(</big><em>input_data</em><big>)</big><a class="headerlink" href="#trigger.acl.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a complete ACL and return an ACL object. This should be the only
external interface to the parser.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.acl</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s">&quot;access-list 123 permit tcp any host 10.20.30.40 eq 80&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span><span class="o">.</span><span class="n">terms</span>
<span class="go">[&lt;Term: None&gt;]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_data</strong> &#8211; An ACL policy as a string or file-like object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.S">
<tt class="descclassname">trigger.acl.</tt><tt class="descname">S</tt><big>(</big><em>prod</em><big>)</big><a class="headerlink" href="#trigger.acl.S" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap your grammar token in this to call your helper function with a list
of each parsed subtag, instead of the raw text. This is useful for
performing modifiers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prod</strong> &#8211; The parser product.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.ACL">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">ACL</tt><big>(</big><em>name=None</em>, <em>terms=None</em>, <em>format=None</em>, <em>family=None</em>, <em>interface_specific=False</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL" title="Permalink to this definition">¶</a></dt>
<dd><p>An abstract access-list object intended to be created by the <a class="reference internal" href="#trigger.acl.parse" title="trigger.acl.parse"><tt class="xref py py-func docutils literal"><span class="pre">parse()</span></tt></a>
function.</p>
<dl class="method">
<dt id="trigger.acl.ACL.name_terms">
<tt class="descname">name_terms</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.ACL.name_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign names to all unnamed terms.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output">
<tt class="descname">output</tt><big>(</big><em>format=None</em>, <em>*largs</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL data in the specified format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output_ios">
<tt class="descname">output_ios</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS traditional format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output_ios_brocade">
<tt class="descname">output_ios_brocade</tt><big>(</big><em>replace=False</em>, <em>receive_acl=False</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output_ios_brocade" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in Brocade-flavored IOS format.</p>
<p>The difference between this and &#8220;traditional&#8221; IOS are:</p>
<blockquote>
<div><ul class="simple">
<li>Stripping of comments</li>
<li>Appending of <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">rebind-acl</span></tt> or <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">rebind-receive-acl</span></tt> line</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</li>
<li><strong>receive_acl</strong> &#8211; If set the ACL is suffixed with a <tt class="docutils literal"><span class="pre">ip</span>
<span class="pre">rebind-receive-acl'</span> <span class="pre">instead</span> <span class="pre">of</span> <span class="pre">``ip</span> <span class="pre">rebind-acl</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS named format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS XR format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">ipv4</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.output_junos">
<tt class="descname">output_junos</tt><big>(</big><em>replace=False</em>, <em>family=None</em><big>)</big><a class="headerlink" href="#trigger.acl.ACL.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in JunOS format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>replace</strong> &#8211; If set the ACL is wrapped in a
<tt class="docutils literal"><span class="pre">firewall</span> <span class="pre">{</span> <span class="pre">replace:</span> <span class="pre">...</span> <span class="pre">}</span></tt> section.</li>
<li><strong>family</strong> &#8211; If set, the value is used to wrap the ACL in a
<tt class="docutils literal"><span class="pre">family</span> <span class="pre">inet</span> <span class="pre">{</span> <span class="pre">...}</span></tt> section.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.ACL.strip_comments">
<tt class="descname">strip_comments</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.ACL.strip_comments" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips all comments from ACL header and all terms.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.Comment">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Comment</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.Comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for inline comments.</p>
<dl class="method">
<dt id="trigger.acl.Comment.output_ios">
<tt class="descname">output_ios</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Comment.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS traditional format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Comment.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Comment.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS named format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Comment.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Comment.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS XR format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Comment.output_junos">
<tt class="descname">output_junos</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Comment.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to JunOS format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.Matches">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Matches</tt><big>(</big><em>d=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.Matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for Term.match object used for membership tests on
access checks.</p>
<dl class="method">
<dt id="trigger.acl.Matches.ios_address_str">
<tt class="descname">ios_address_str</tt><big>(</big><em>addrs</em><big>)</big><a class="headerlink" href="#trigger.acl.Matches.ios_address_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of addresses to IOS-style stupid strings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>addrs</strong> &#8211; List of IP address objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Matches.ios_port_str">
<tt class="descname">ios_port_str</tt><big>(</big><em>ports</em><big>)</big><a class="headerlink" href="#trigger.acl.Matches.ios_port_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of tuples back to ranges, then to strings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ports</strong> &#8211; A list of port tuples, e.g. [(0,65535), (1,2)].</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Matches.junos_str">
<tt class="descname">junos_str</tt><big>(</big><em>pair</em><big>)</big><a class="headerlink" href="#trigger.acl.Matches.junos_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a 2-tuple into a hyphenated string, e.g. a range of ports. If
not a tuple, tries to treat it as IPs or failing that, casts it to a
string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pair</strong> &#8211; The 2-tuple to convert.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Matches.output_ios">
<tt class="descname">output_ios</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Matches.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string of IOS ACL bodies.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Matches.output_junos">
<tt class="descname">output_junos</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Matches.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list that can form the <tt class="docutils literal"><span class="pre">from</span> <span class="pre">{</span> <span class="pre">...</span> <span class="pre">}</span></tt> clause of the term.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.Policer">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Policer</tt><big>(</big><em>name</em>, <em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.Policer" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for policer policy definitions. This is a dummy class for
now, that just passes it through as a string.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.PolicerGroup">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">PolicerGroup</tt><big>(</big><em>format=None</em><big>)</big><a class="headerlink" href="#trigger.acl.PolicerGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for Policer objects. Juniper only.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.Protocol">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Protocol</tt><big>(</big><em>arg</em><big>)</big><a class="headerlink" href="#trigger.acl.Protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>A protocol object used for access membership tests in <a class="reference internal" href="#trigger.acl.Term" title="trigger.acl.Term"><tt class="xref py py-class docutils literal"><span class="pre">Term</span></tt></a> objects.
Acts like an integer, but stringify into a name if possible.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.RangeList">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">RangeList</tt><big>(</big><em>data=None</em><big>)</big><a class="headerlink" href="#trigger.acl.RangeList" title="Permalink to this definition">¶</a></dt>
<dd><p>A type which stores ordered sets, with efficient handling of
ranges.  It can also store non-incrementable terms as an sorted set
without collapsing into ranges.</p>
<p>This is currently used to just store match conditions (e.g. protocols,
ports), but could be fleshed out into a general-purpose class.  One
thing to think about is how/whether to handle a list of tuples as distinct
from a list of ranges.  Should we just store them as xrange objects?
Should the object appear as discrete elements by default, for example
in len(), with the collapsed view as a method, or should we keep it
as it is now?  All the current uses of this class are in this file
and have unit tests, so when we decided what the semantics of the
generalized module ought to be, we can make it so without worry.</p>
<dl class="method">
<dt id="trigger.acl.RangeList.expanded">
<tt class="descname">expanded</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.RangeList.expanded" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with all ranges converted to discrete elements.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.Remark">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Remark</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.Remark" title="Permalink to this definition">¶</a></dt>
<dd><p>IOS extended ACL &#8220;remark&#8221; lines automatically become comments when
converting to other formats of ACL.</p>
<dl class="method">
<dt id="trigger.acl.Remark.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.Remark.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Remark to IOS named format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.Term">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">Term</tt><big>(</big><em>name=None</em>, <em>action='accept'</em>, <em>match=None</em>, <em>modifiers=None</em>, <em>inactive=False</em>, <em>isglobal=False</em>, <em>extra=None</em><big>)</big><a class="headerlink" href="#trigger.acl.Term" title="Permalink to this definition">¶</a></dt>
<dd><p>An individual term from which an ACL is made</p>
<dl class="method">
<dt id="trigger.acl.Term.output">
<tt class="descname">output</tt><big>(</big><em>format</em>, <em>*largs</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the term to the specified format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>format</strong> &#8211; The desired output format.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Term.output_ios">
<tt class="descname">output_ios</tt><big>(</big><em>prefix=None</em>, <em>acl_name=None</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS traditional format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>prefix</strong> &#8211; Prefix to use, default: &#8216;access-list&#8217;</li>
<li><strong>acl_name</strong> &#8211; Name of access-list to display</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Term.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><em>prefix=''</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS named format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Term.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><em>prefix=''</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS XR format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Term.output_junos">
<tt class="descname">output_junos</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the term to JunOS format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.Term.set_action_or_modifier">
<tt class="descname">set_action_or_modifier</tt><big>(</big><em>action</em><big>)</big><a class="headerlink" href="#trigger.acl.Term.set_action_or_modifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Add or replace a modifier, or set the primary action. This method exists
for the convenience of parsers.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.TermList">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">TermList</tt><a class="headerlink" href="#trigger.acl.TermList" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for Term objects within an ACL object.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.TIP">
<em class="property">class </em><tt class="descclassname">trigger.acl.</tt><tt class="descname">TIP</tt><big>(</big><em>data</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.TIP" title="Permalink to this definition">¶</a></dt>
<dd><p>Class based on IPy.IP, but with extensions for Trigger.</p>
<p>Currently, only the only extension is the ability to negate a network
block. Only used internally within the parser, as it&#8217;s not complete
(doesn&#8217;t interact well with IPy.IP objects). Does not handle IPv6 yet.</p>
</dd></dl>

<div class="section" id="module-trigger.acl.autoacl">
<span id="trigger-acl-autoacl"></span><h2><a class="reference internal" href="#module-trigger.acl.autoacl" title="trigger.acl.autoacl"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl.autoacl</span></tt></a><a class="headerlink" href="#module-trigger.acl.autoacl" title="Permalink to this headline">¶</a></h2>
<p>This module controls when ACLs get auto-applied to network devices,
in addition to what is specified in acls.db.</p>
<p>This is primarily used by <a class="reference internal" href="#trigger.acl.db.AclsDB" title="trigger.acl.db.AclsDB"><tt class="xref py py-class docutils literal"><span class="pre">AclsDB</span></tt></a> to populate the
<strong>implicit</strong> ACL-to-device mappings.</p>
<p>No changes should be made to this module. You must specify the path to the
autoacl logic inside of <tt class="docutils literal"><span class="pre">settings.py</span></tt> as <tt class="docutils literal"><span class="pre">AUTOACL_FILE</span></tt>. This will be
exported as <tt class="docutils literal"><span class="pre">autoacl</span></tt> so that the module path for the <a class="reference internal" href="#trigger.acl.autoacl.autoacl" title="trigger.acl.autoacl.autoacl"><tt class="xref py py-func docutils literal"><span class="pre">autoacl()</span></tt></a>
function will still be <tt class="xref py py-func docutils literal"><span class="pre">trigger.autoacl.autoacl()</span></tt>.</p>
<p>This trickery allows us to keep the business-logic for how ACLs are mapped to
devices out of the Trigger packaging.</p>
<p>If you do not specify a location for <tt class="docutils literal"><span class="pre">AUTOACL_FILE</span></tt> or the module cannot be
loaded, then a default <a class="reference internal" href="#trigger.acl.autoacl.autoacl" title="trigger.acl.autoacl.autoacl"><tt class="xref py py-func docutils literal"><span class="pre">autoacl()</span></tt></a> function ill be used.</p>
<dl class="function">
<dt id="trigger.acl.autoacl.autoacl">
<tt class="descclassname">trigger.acl.autoacl.</tt><tt class="descname">autoacl</tt><big>(</big><em>dev</em>, <em>explicit_acls=None</em><big>)</big><a class="headerlink" href="#trigger.acl.autoacl.autoacl" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a NetDevice object, returns a set of <strong>implicit</strong> (auto) ACLs. We
require a device object so that we don&#8217;t have circular dependencies
between netdevices and autoacl.</p>
<p>This function MUST return a <tt class="docutils literal"><span class="pre">set()</span></tt> of acl names or you will break
the ACL associations. An empty set is fine, but it must be a set!</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>dev</strong> &#8211; A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><tt class="xref py py-class docutils literal"><span class="pre">NetDevice</span></tt></a> object.</li>
<li><strong>explicit_acls</strong> &#8211; A set containing names of ACLs. Default: set()</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;test1-abc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">vendor</span>
<span class="go">&lt;Vendor: Juniper&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">autoacl</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="go">set([&#39;juniper-router-protect&#39;, &#39;juniper-router.policer&#39;])</span>
</pre></div>
</div>
<p>NOTE: If the default function is returned it does nothing with the
arguments and always returns an empty set.</p>
</dd></dl>

</div>
<div class="section" id="module-trigger.acl.db">
<span id="trigger-acl-db"></span><h2><a class="reference internal" href="#module-trigger.acl.db" title="trigger.acl.db"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl.db</span></tt></a><a class="headerlink" href="#module-trigger.acl.db" title="Permalink to this headline">¶</a></h2>
<p>Redis-based replacement of the legacy acls.db file. This is used for
interfacing with the explicit and automatic ACL-to-device mappings.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.netdevices</span> <span class="kn">import</span> <span class="n">NetDevices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.acl.db</span> <span class="kn">import</span> <span class="n">AclsDB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;test1-abc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">AclsDB</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="go">set([&#39;juniper-router.policer&#39;, &#39;juniper-router-protect&#39;, &#39;abc123&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;explicit&#39;</span><span class="p">)</span>
<span class="go">set([&#39;abc123&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;implicit&#39;</span><span class="p">)</span>
<span class="go">set([&#39;juniper-router.policer&#39;, &#39;juniper-router-protect&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_dict</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="go">{&#39;all&#39;: set([&#39;abc123&#39;, &#39;juniper-router-protect&#39;, &#39;juniper-router.policer&#39;]),</span>
<span class="go"> &#39;explicit&#39;: set([&#39;abc123&#39;]),</span>
<span class="go">  &#39;implicit&#39;: set([&#39;juniper-router-protect&#39;, &#39;juniper-router.policer&#39;])}</span>
</pre></div>
</div>
<dl class="function">
<dt id="trigger.acl.db.get_matching_acls">
<tt class="descclassname">trigger.acl.db.</tt><tt class="descname">get_matching_acls</tt><big>(</big><em>wanted</em>, <em>exact=True</em>, <em>match_acl=True</em>, <em>match_device=False</em>, <em>nd=None</em><big>)</big><a class="headerlink" href="#trigger.acl.db.get_matching_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a sorted list of the names of devices that have at least one
of the wanted ACLs, and the ACLs that matched on each.  Without &#8216;exact&#8217;,
match ACL name by startswith.</p>
<p>To get a list of devices, matching the ACLs specified:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">get_matching_acls</span><span class="p">([</span><span class="s">&#39;abc123&#39;</span><span class="p">])</span>
<span class="go">[(&#39;fw1-xyz.net.aol.com&#39;, [&#39;abc123&#39;]), (&#39;test1-abc.net.aol.com&#39;, [&#39;abc123&#39;])]</span>
</pre></div>
</div>
<p>To get a list of ACLS matching the devices specified using an explicit
match (default) by setting match_device=True:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">get_matching_acls</span><span class="p">([</span><span class="s">&#39;test1-abc&#39;</span><span class="p">],</span> <span class="n">match_device</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">get_matching_acls</span><span class="p">([</span><span class="s">&#39;test1-abc.net.aol.com&#39;</span><span class="p">],</span> <span class="n">match_device</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">[(&#39;test1-abc.net.aol.com&#39;, [&#39;abc123&#39;, &#39;juniper-router-protect&#39;,</span>
<span class="go">&#39;juniper-router.policer&#39;])]</span>
</pre></div>
</div>
<p>To get a list of ACLS matching the devices specified using a partial
match. Not how it returns all devices starting with &#8216;test1-mtc&#8217;:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">adb</span><span class="o">.</span><span class="n">get_matching_acls</span><span class="p">([</span><span class="s">&#39;test1-abc&#39;</span><span class="p">],</span> <span class="n">match_device</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">exact</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="go">[(&#39;test1-abc.net.aol.com&#39;, [&#39;abc123&#39;, &#39;juniper-router-protect&#39;,</span>
<span class="go">&#39;juniper-router.policer&#39;])]</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.db.get_all_acls">
<tt class="descclassname">trigger.acl.db.</tt><tt class="descname">get_all_acls</tt><big>(</big><em>nd=None</em><big>)</big><a class="headerlink" href="#trigger.acl.db.get_all_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict keyed by acl names whose containing a set of NetDevices
objects to which each acl is applied.</p>
<p>&#64;nd can be your own NetDevices object if one is not supplied already</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">all_acls</span> <span class="o">=</span> <span class="n">get_all_acls</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">all_acls</span><span class="p">[</span><span class="s">&#39;abc123&#39;</span><span class="p">]</span>
<span class="go">set([&lt;NetDevice: test1-abc.net.aol.com&gt;, &lt;NetDevice: fw1-xyz.net.aol.com&gt;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.db.get_bulk_acls">
<tt class="descclassname">trigger.acl.db.</tt><tt class="descname">get_bulk_acls</tt><big>(</big><em>nd=None</em><big>)</big><a class="headerlink" href="#trigger.acl.db.get_bulk_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a set of acls with an applied count over
settings.AUTOLOAD_BULK_THRESH.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.db.populate_bulk_acls">
<tt class="descclassname">trigger.acl.db.</tt><tt class="descname">populate_bulk_acls</tt><big>(</big><em>nd=None</em><big>)</big><a class="headerlink" href="#trigger.acl.db.populate_bulk_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a NetDevices instance, Adds bulk_acls attribute to NetDevice objects.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.db.AclsDB">
<em class="property">class </em><tt class="descclassname">trigger.acl.db.</tt><tt class="descname">AclsDB</tt><a class="headerlink" href="#trigger.acl.db.AclsDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for ACL operations.</p>
<p>add/remove operations are for explicit associations only.</p>
<dl class="method">
<dt id="trigger.acl.db.AclsDB.add_acl">
<tt class="descname">add_acl</tt><big>(</big><em>device</em>, <em>acl</em><big>)</big><a class="headerlink" href="#trigger.acl.db.AclsDB.add_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Add explicit acl to device</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;test1-mtc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">add_acl</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;acb123&#39;</span><span class="p">)</span>
<span class="go">&#39;added acl abc123 to test1-mtc.net.aol.com&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.db.AclsDB.get_acl_dict">
<tt class="descname">get_acl_dict</tt><big>(</big><em>device</em><big>)</big><a class="headerlink" href="#trigger.acl.db.AclsDB.get_acl_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict of acl mappings for a &#64;device, which is expected to
be a NetDevice object.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_dict</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="go">{&#39;all&#39;: set([&#39;115j&#39;, &#39;protectRE&#39;, &#39;protectRE.policer&#39;, &#39;test-bluej&#39;,</span>
<span class="go">&#39;testgreenj&#39;, &#39;testops_blockmj&#39;]),</span>
<span class="go">&#39;explicit&#39;: set([&#39;test-bluej&#39;, &#39;testgreenj&#39;, &#39;testops_blockmj&#39;]),</span>
<span class="go">&#39;implicit&#39;: set([&#39;115j&#39;, &#39;protectRE&#39;, &#39;protectRE.policer&#39;])}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.db.AclsDB.get_acl_set">
<tt class="descname">get_acl_set</tt><big>(</big><em>device</em>, <em>acl_set='all'</em><big>)</big><a class="headerlink" href="#trigger.acl.db.AclsDB.get_acl_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an acl set matching &#64;acl_set for a given device.  Match can be
one of [&#8216;all&#8217;, &#8216;explicit&#8217;, &#8216;implicit&#8217;]. Defaults to &#8216;all&#8217;.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="go">set([&#39;testops_blockmj&#39;, &#39;testgreenj&#39;, &#39;115j&#39;, &#39;protectRE&#39;,</span>
<span class="go">&#39;protectRE.policer&#39;, &#39;test-bluej&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;explicit&#39;</span><span class="p">)</span>
<span class="go">set([&#39;testops_blockmj&#39;, &#39;test-bluej&#39;, &#39;testgreenj&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">get_acl_set</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;implicit&#39;</span><span class="p">)</span>
<span class="go">set([&#39;protectRE&#39;, &#39;protectRE.policer&#39;, &#39;115j&#39;])</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.db.AclsDB.remove_acl">
<tt class="descname">remove_acl</tt><big>(</big><em>device</em>, <em>acl</em><big>)</big><a class="headerlink" href="#trigger.acl.db.AclsDB.remove_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove explicit acl from device.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">remove_acl</span><span class="p">(</span><span class="n">dev</span><span class="p">,</span> <span class="s">&#39;acb123&#39;</span><span class="p">)</span>
<span class="go">&#39;removed acl abc123 from test1-mtc.net.aol.com&#39;</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-trigger.acl.parser">
<span id="trigger-acl-parser"></span><h2><a class="reference internal" href="#module-trigger.acl.parser" title="trigger.acl.parser"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl.parser</span></tt></a><a class="headerlink" href="#module-trigger.acl.parser" title="Permalink to this headline">¶</a></h2>
<p>Parse and manipulate network access control lists.</p>
<p>This library doesn&#8217;t completely follow the border of the valid/invalid ACL
set, which is determined by multiple vendors and not completely documented
by any of them.  We could asymptotically approach that with an enormous
amount of testing, although it would require a &#8216;flavor&#8217; flag (vendor,
router model, software version) for full support.  The realistic goal
is to catch all the errors that we see in practice, and to accept all
the ACLs that we use in practice, rather than to try to reject <em>every</em>
invalid ACL and accept <em>every</em> valid ACL.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.acl</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s">&quot;access-list 123 permit tcp any host 10.20.30.40 eq 80&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span><span class="o">.</span><span class="n">terms</span>
<span class="go">[&lt;Term: None&gt;]</span>
</pre></div>
</div>
<dl class="function">
<dt id="trigger.acl.parser.literals">
<tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">literals</tt><big>(</big><em>d</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.literals" title="Permalink to this definition">¶</a></dt>
<dd><p>Longest match of all the strings that are keys of &#8216;d&#8217;.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.parser.parse">
<tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">parse</tt><big>(</big><em>input_data</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a complete ACL and return an ACL object. This should be the only
external interface to the parser.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.acl</span> <span class="kn">import</span> <span class="n">parse</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="s">&quot;access-list 123 permit tcp any host 10.20.30.40 eq 80&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">aclobj</span><span class="o">.</span><span class="n">terms</span>
<span class="go">[&lt;Term: None&gt;]</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input_data</strong> &#8211; An ACL policy as a string or file-like object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.parser.S">
<tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">S</tt><big>(</big><em>prod</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.S" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap your grammar token in this to call your helper function with a list
of each parsed subtag, instead of the raw text. This is useful for
performing modifiers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>prod</strong> &#8211; The parser product.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.ACL">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">ACL</tt><big>(</big><em>name=None</em>, <em>terms=None</em>, <em>format=None</em>, <em>family=None</em>, <em>interface_specific=False</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL" title="Permalink to this definition">¶</a></dt>
<dd><p>An abstract access-list object intended to be created by the <a class="reference internal" href="#trigger.acl.parser.parse" title="trigger.acl.parser.parse"><tt class="xref py py-func docutils literal"><span class="pre">parse()</span></tt></a>
function.</p>
<dl class="method">
<dt id="trigger.acl.parser.ACL.name_terms">
<tt class="descname">name_terms</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.name_terms" title="Permalink to this definition">¶</a></dt>
<dd><p>Assign names to all unnamed terms.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output">
<tt class="descname">output</tt><big>(</big><em>format=None</em>, <em>*largs</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL data in the specified format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output_ios">
<tt class="descname">output_ios</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS traditional format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output_ios_brocade">
<tt class="descname">output_ios_brocade</tt><big>(</big><em>replace=False</em>, <em>receive_acl=False</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output_ios_brocade" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in Brocade-flavored IOS format.</p>
<p>The difference between this and &#8220;traditional&#8221; IOS are:</p>
<blockquote>
<div><ul class="simple">
<li>Stripping of comments</li>
<li>Appending of <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">rebind-acl</span></tt> or <tt class="docutils literal"><span class="pre">ip</span> <span class="pre">rebind-receive-acl</span></tt> line</li>
</ul>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</li>
<li><strong>receive_acl</strong> &#8211; If set the ACL is suffixed with a <tt class="docutils literal"><span class="pre">ip</span>
<span class="pre">rebind-receive-acl'</span> <span class="pre">instead</span> <span class="pre">of</span> <span class="pre">``ip</span> <span class="pre">rebind-acl</span></tt>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS named format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><em>replace=False</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in IOS XR format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>replace</strong> &#8211; If set the ACL is preceded by a <tt class="docutils literal"><span class="pre">no</span> <span class="pre">ipv4</span> <span class="pre">access-list</span></tt> line.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.output_junos">
<tt class="descname">output_junos</tt><big>(</big><em>replace=False</em>, <em>family=None</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the ACL in JunOS format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>replace</strong> &#8211; If set the ACL is wrapped in a
<tt class="docutils literal"><span class="pre">firewall</span> <span class="pre">{</span> <span class="pre">replace:</span> <span class="pre">...</span> <span class="pre">}</span></tt> section.</li>
<li><strong>family</strong> &#8211; If set, the value is used to wrap the ACL in a
<tt class="docutils literal"><span class="pre">family</span> <span class="pre">inet</span> <span class="pre">{</span> <span class="pre">...}</span></tt> section.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.ACL.strip_comments">
<tt class="descname">strip_comments</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.ACL.strip_comments" title="Permalink to this definition">¶</a></dt>
<dd><p>Strips all comments from ACL header and all terms.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Comment">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Comment</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Comment" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for inline comments.</p>
<dl class="method">
<dt id="trigger.acl.parser.Comment.output_ios">
<tt class="descname">output_ios</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Comment.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS traditional format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Comment.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Comment.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS named format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Comment.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Comment.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to IOS XR format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Comment.output_junos">
<tt class="descname">output_junos</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Comment.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Comment to JunOS format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Matches">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Matches</tt><big>(</big><em>d=None</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for Term.match object used for membership tests on
access checks.</p>
<dl class="method">
<dt id="trigger.acl.parser.Matches.ios_address_str">
<tt class="descname">ios_address_str</tt><big>(</big><em>addrs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches.ios_address_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of addresses to IOS-style stupid strings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>addrs</strong> &#8211; List of IP address objects.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Matches.ios_port_str">
<tt class="descname">ios_port_str</tt><big>(</big><em>ports</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches.ios_port_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a list of tuples back to ranges, then to strings.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ports</strong> &#8211; A list of port tuples, e.g. [(0,65535), (1,2)].</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Matches.junos_str">
<tt class="descname">junos_str</tt><big>(</big><em>pair</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches.junos_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a 2-tuple into a hyphenated string, e.g. a range of ports. If
not a tuple, tries to treat it as IPs or failing that, casts it to a
string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pair</strong> &#8211; The 2-tuple to convert.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Matches.output_ios">
<tt class="descname">output_ios</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a string of IOS ACL bodies.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Matches.output_junos">
<tt class="descname">output_junos</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Matches.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list that can form the <tt class="docutils literal"><span class="pre">from</span> <span class="pre">{</span> <span class="pre">...</span> <span class="pre">}</span></tt> clause of the term.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Policer">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Policer</tt><big>(</big><em>name</em>, <em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Policer" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for policer policy definitions. This is a dummy class for
now, that just passes it through as a string.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.PolicerGroup">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">PolicerGroup</tt><big>(</big><em>format=None</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.PolicerGroup" title="Permalink to this definition">¶</a></dt>
<dd><p>Container for Policer objects. Juniper only.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Protocol">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Protocol</tt><big>(</big><em>arg</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Protocol" title="Permalink to this definition">¶</a></dt>
<dd><p>A protocol object used for access membership tests in <a class="reference internal" href="#trigger.acl.parser.Term" title="trigger.acl.parser.Term"><tt class="xref py py-class docutils literal"><span class="pre">Term</span></tt></a> objects.
Acts like an integer, but stringify into a name if possible.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.RangeList">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">RangeList</tt><big>(</big><em>data=None</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.RangeList" title="Permalink to this definition">¶</a></dt>
<dd><p>A type which stores ordered sets, with efficient handling of
ranges.  It can also store non-incrementable terms as an sorted set
without collapsing into ranges.</p>
<p>This is currently used to just store match conditions (e.g. protocols,
ports), but could be fleshed out into a general-purpose class.  One
thing to think about is how/whether to handle a list of tuples as distinct
from a list of ranges.  Should we just store them as xrange objects?
Should the object appear as discrete elements by default, for example
in len(), with the collapsed view as a method, or should we keep it
as it is now?  All the current uses of this class are in this file
and have unit tests, so when we decided what the semantics of the
generalized module ought to be, we can make it so without worry.</p>
<dl class="method">
<dt id="trigger.acl.parser.RangeList.expanded">
<tt class="descname">expanded</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.RangeList.expanded" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list with all ranges converted to discrete elements.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Remark">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Remark</tt><big>(</big><em>data</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Remark" title="Permalink to this definition">¶</a></dt>
<dd><p>IOS extended ACL &#8220;remark&#8221; lines automatically become comments when
converting to other formats of ACL.</p>
<dl class="method">
<dt id="trigger.acl.parser.Remark.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.parser.Remark.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the Remark to IOS named format.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.Term">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">Term</tt><big>(</big><em>name=None</em>, <em>action='accept'</em>, <em>match=None</em>, <em>modifiers=None</em>, <em>inactive=False</em>, <em>isglobal=False</em>, <em>extra=None</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term" title="Permalink to this definition">¶</a></dt>
<dd><p>An individual term from which an ACL is made</p>
<dl class="method">
<dt id="trigger.acl.parser.Term.output">
<tt class="descname">output</tt><big>(</big><em>format</em>, <em>*largs</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.output" title="Permalink to this definition">¶</a></dt>
<dd><p>Output the term to the specified format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>format</strong> &#8211; The desired output format.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Term.output_ios">
<tt class="descname">output_ios</tt><big>(</big><em>prefix=None</em>, <em>acl_name=None</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.output_ios" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS traditional format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>prefix</strong> &#8211; Prefix to use, default: &#8216;access-list&#8217;</li>
<li><strong>acl_name</strong> &#8211; Name of access-list to display</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Term.output_ios_named">
<tt class="descname">output_ios_named</tt><big>(</big><em>prefix=''</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.output_ios_named" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS named format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Term.output_iosxr">
<tt class="descname">output_iosxr</tt><big>(</big><em>prefix=''</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.output_iosxr" title="Permalink to this definition">¶</a></dt>
<dd><p>Output term to IOS XR format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Term.output_junos">
<tt class="descname">output_junos</tt><big>(</big><em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.output_junos" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the term to JunOS format.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.parser.Term.set_action_or_modifier">
<tt class="descname">set_action_or_modifier</tt><big>(</big><em>action</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.Term.set_action_or_modifier" title="Permalink to this definition">¶</a></dt>
<dd><p>Add or replace a modifier, or set the primary action. This method exists
for the convenience of parsers.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.TermList">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">TermList</tt><a class="headerlink" href="#trigger.acl.parser.TermList" title="Permalink to this definition">¶</a></dt>
<dd><p>Container class for Term objects within an ACL object.</p>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.parser.TIP">
<em class="property">class </em><tt class="descclassname">trigger.acl.parser.</tt><tt class="descname">TIP</tt><big>(</big><em>data</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.parser.TIP" title="Permalink to this definition">¶</a></dt>
<dd><p>Class based on IPy.IP, but with extensions for Trigger.</p>
<p>Currently, only the only extension is the ability to negate a network
block. Only used internally within the parser, as it&#8217;s not complete
(doesn&#8217;t interact well with IPy.IP objects). Does not handle IPv6 yet.</p>
</dd></dl>

</div>
<div class="section" id="module-trigger.acl.queue">
<span id="trigger-acl-queue"></span><h2><a class="reference internal" href="#module-trigger.acl.queue" title="trigger.acl.queue"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl.queue</span></tt></a><a class="headerlink" href="#module-trigger.acl.queue" title="Permalink to this headline">¶</a></h2>
<p>Database interface for automated ACL queue. Used primarily by <tt class="docutils literal"><span class="pre">load_acl</span></tt> and
<tt class="docutils literal"><span class="pre">acl`</span></tt> commands for manipulating the work queue.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.acl.queue</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span><span class="o">.</span><span class="n">list</span><span class="p">()</span>
<span class="go">((&#39;dc1-abc.net.aol.com&#39;, &#39;datacenter-protect&#39;), (&#39;dc2-abc.net.aol.com&#39;,</span>
<span class="go">&#39;datacenter-protect&#39;))</span>
</pre></div>
</div>
<dl class="class">
<dt id="trigger.acl.queue.Queue">
<em class="property">class </em><tt class="descclassname">trigger.acl.queue.</tt><tt class="descname">Queue</tt><big>(</big><em>verbose=True</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue" title="Permalink to this definition">¶</a></dt>
<dd><p>Interacts with firewalls database to insert/remove items into the queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verbose</strong> (<em>Boolean</em>) &#8211; Toggle verbosity</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="trigger.acl.queue.Queue.complete">
<tt class="descname">complete</tt><big>(</big><em>device</em>, <em>acls</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Mark a device and its ACLs as complete using current timestamp.</p>
<p>(Integrated queue only.)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> &#8211; Device names</li>
<li><strong>acls</strong> &#8211; List of ACL names</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.create_task">
<tt class="descname">create_task</tt><big>(</big><em>queue</em>, <em>*args</em>, <em>**kwargs</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.create_task" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a task in the specified queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>queue</strong> &#8211; Name of the queue whose object you want</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.delete">
<tt class="descname">delete</tt><big>(</big><em>acl</em>, <em>routers=None</em>, <em>escalation=False</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.delete" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete an ACL from the firewall database queue.</p>
<p>Attempts to delete from integrated queue. If ACL test fails
or if routers are not specified, the item is deleted from manual queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>acl</strong> &#8211; ACL name</li>
<li><strong>routers</strong> &#8211; List of device names. If this is ommitted, the manual queue is used.</li>
<li><strong>escalation</strong> &#8211; Whether this is an escalated task</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.get_model">
<tt class="descname">get_model</tt><big>(</big><em>queue</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.get_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a queue name, return its DB model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>queue</strong> &#8211; Name of the queue whose object you want</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.insert">
<tt class="descname">insert</tt><big>(</big><em>acl</em>, <em>routers</em>, <em>escalation=False</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an ACL and associated devices into the ACL load queue.</p>
<p>Attempts to insert into integrated queue. If ACL test fails, then
item is inserted into manual queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>acl</strong> &#8211; ACL name</li>
<li><strong>routers</strong> &#8211; List of device names</li>
<li><strong>escalation</strong> &#8211; Whether this is an escalated task</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.list">
<tt class="descname">list</tt><big>(</big><em>queue='integrated'</em>, <em>escalation=False</em>, <em>q_names=('integrated'</em>, <em>'manual')</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.list" title="Permalink to this definition">¶</a></dt>
<dd><p>List items in the specified queue, defauls to integrated queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>queue</strong> &#8211; Name of the queue to list</li>
<li><strong>escalation</strong> &#8211; Whether this is an escalated task</li>
<li><strong>q_names</strong> &#8211; (Optional) List of valid queue names</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.remove">
<tt class="descname">remove</tt><big>(</big><em>acl</em>, <em>routers</em>, <em>escalation=False</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrated queue only.</p>
<p>Mark an ACL and associated devices as &#8220;removed&#8221; (loaded=0). Intended
for use when performing manual actions on the load queue when
troubleshooting or addressing errors with automated loads. This leaves
the items in the database but removes them from the active queue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>acl</strong> &#8211; ACL name</li>
<li><strong>routers</strong> &#8211; List of device names</li>
<li><strong>escalation</strong> &#8211; Whether this is an escalated task</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.acl.queue.Queue.vprint">
<tt class="descname">vprint</tt><big>(</big><em>msg</em><big>)</big><a class="headerlink" href="#trigger.acl.queue.Queue.vprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Print something if <tt class="docutils literal"><span class="pre">verbose</span></tt> instance variable is set.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>msg</strong> &#8211; The string to print</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-trigger.acl.tools">
<span id="trigger-acl-tools"></span><h2><a class="reference internal" href="#module-trigger.acl.tools" title="trigger.acl.tools"><tt class="xref py py-mod docutils literal"><span class="pre">trigger.acl.tools</span></tt></a><a class="headerlink" href="#module-trigger.acl.tools" title="Permalink to this headline">¶</a></h2>
<p>Various tools for use in scripts or other modules. Heavy lifting from tools
that have matured over time have been moved into this module.</p>
<dl class="function">
<dt id="trigger.acl.tools.create_trigger_term">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">create_trigger_term</tt><big>(</big><em>source_ips=[], dest_ips=[], source_ports=[], dest_ports=[], protocols=[], action=['accept'], name='generated_term'</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.create_trigger_term" title="Permalink to this definition">¶</a></dt>
<dd><p>Constructs &amp; returns a Term object from constituent parts.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.create_access">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">create_access</tt><big>(</big><em>terms_to_check</em>, <em>new_term</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.create_access" title="Permalink to this definition">¶</a></dt>
<dd><p>Breaks a new_term up into separate constituent parts so that they can be 
compared in a check_access test.</p>
<p>Returns a list of terms that should be inserted.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.check_access">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">check_access</tt><big>(</big><em>terms_to_check</em>, <em>new_term</em>, <em>quiet=True</em>, <em>format='junos'</em>, <em>acl_name=None</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.check_access" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine whether access is permitted by a given ACL (list of terms).</p>
<p>Tests a new term against a list of terms. Return True if access in new term
is permitted, or False if not.</p>
<p>Optionally displays the terms that apply and what edits are needed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>terms_to_check</strong> &#8211; A list of Term objects to check</li>
<li><strong>new_term</strong> &#8211; The Term object used for the access test</li>
<li><strong>quiet</strong> &#8211; Toggle whether output is displayed</li>
<li><strong>format</strong> &#8211; The ACL format to use for output display</li>
<li><strong>acl_name</strong> &#8211; The ACL name to use for output display</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="trigger.acl.tools.ACLScript">
<em class="property">class </em><tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">ACLScript</tt><big>(</big><em>acl=None</em>, <em>mode='insert'</em>, <em>cmd='acl_script'</em>, <em>show_mods=True</em>, <em>no_worklog=False</em>, <em>no_changes=False</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.ACLScript" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface to generating or modifying access-lists. Intended for use in
creating command-line utilities using the ACL API.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.process_bulk_loads">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">process_bulk_loads</tt><big>(</big><em>work</em>, <em>max_hits=1</em>, <em>force_bulk=False</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.process_bulk_loads" title="Permalink to this definition">¶</a></dt>
<dd><p>Formerly &#8220;process &#8211;ones&#8221;.</p>
<p>Processes work dict and determines tuple of (prefix, site) for each device.  Stores
tuple as a dict key in prefix_hits. If prefix_hits[(prefix, site)] is greater than max_hits,
remove all further matching devices from work dict.</p>
<p>By default if a device has no acls flagged as bulk_acls, it is not removed from the work dict.</p>
<dl class="docutils">
<dt>Example:</dt>
<dd><ul class="first last simple">
<li>Device &#8216;foo1-xyz.example.com&#8217; returns (&#8216;foo&#8217;, &#8216;xyz&#8217;) as tuple.</li>
<li>This is stored as prefix_hits[(&#8216;foo&#8217;, &#8216;xyz&#8217;)] = 1</li>
<li>All further devices matching that tuple increment the hits for that tuple</li>
<li>Any devices matching hit counter exceeds max_hits is removed from work dict</li>
</ul>
</dd>
</dl>
<p>You may override max_hits to increase the num. of devices on which to load a bulk acl.
You may pass force_bulk=True to treat all loads as bulk loads.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.get_bulk_acls">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">get_bulk_acls</tt><big>(</big><big>)</big><a class="headerlink" href="#trigger.acl.tools.get_bulk_acls" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a dict of acls with an applied count over settings.AUTOLOAD_BULK_THRESH</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.get_comment_matches">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">get_comment_matches</tt><big>(</big><em>aclobj</em>, <em>requests</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.get_comment_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Given an ACL object and a list of ticket numbers return a list of matching comments.</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.write_tmpacl">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">write_tmpacl</tt><big>(</big><em>acl</em>, <em>process_name='_tmpacl'</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.write_tmpacl" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a temporary file to disk from an Trigger acl.ACL object &amp; return the filename</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.diff_files">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">diff_files</tt><big>(</big><em>old</em>, <em>new</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.diff_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a unified diff between two files</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.worklog">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">worklog</tt><big>(</big><em>title</em>, <em>diff</em>, <em>log_string='updated by express-gen'</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.worklog" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a diff to the ACL worklog</p>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.insert_term_into_acl">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">insert_term_into_acl</tt><big>(</big><em>new_term</em>, <em>aclobj</em>, <em>debug=False</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.insert_term_into_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a new ACL object with the new_term added in the proper place based
on the aclobj. Intended to recursively append to an interim ACL object
based on a list of Term objects.</p>
<p>It&#8217;s safe to assume that this function is incomplete pending better
documentation and examples.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_term</strong> &#8211; The Term object to use for comparison against aclobj</li>
<li><strong>aclobj</strong> &#8211; The original ACL object to use for creation of new_acl</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">copy</span>
<span class="c"># terms_to_be_added is a list of Term objects that is to be added in</span>
<span class="c"># the &quot;right place&quot; into new_acl based on the contents of aclobj</span>
<span class="n">original_acl</span> <span class="o">=</span> <span class="n">parse</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s">&#39;acl.original&#39;</span><span class="p">))</span>
<span class="n">new_acl</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">original_acl</span><span class="p">)</span> <span class="c"># Dupe the original</span>
<span class="k">for</span> <span class="n">term</span> <span class="ow">in</span> <span class="n">terms_to_be_added</span><span class="p">:</span>
    <span class="n">new_acl</span> <span class="o">=</span> <span class="n">generate_new_acl</span><span class="p">(</span><span class="n">term</span><span class="p">,</span> <span class="n">new_acl</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="trigger.acl.tools.create_new_acl">
<tt class="descclassname">trigger.acl.tools.</tt><tt class="descname">create_new_acl</tt><big>(</big><em>old_file</em>, <em>terms_to_be_added</em><big>)</big><a class="headerlink" href="#trigger.acl.tools.create_new_acl" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of Term objects call insert_term_into_acl() to determine
what needs to be added in based on the contents of old_file. Returns a new
ACL object.</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#"><tt class="docutils literal"><span class="pre">trigger.acl</span></tt> &#8212; ACL parsing library</a><ul>
<li><a class="reference internal" href="#module-trigger.acl.autoacl"><tt class="docutils literal"><span class="pre">trigger.acl.autoacl</span></tt></a></li>
<li><a class="reference internal" href="#module-trigger.acl.db"><tt class="docutils literal"><span class="pre">trigger.acl.db</span></tt></a></li>
<li><a class="reference internal" href="#module-trigger.acl.parser"><tt class="docutils literal"><span class="pre">trigger.acl.parser</span></tt></a></li>
<li><a class="reference internal" href="#module-trigger.acl.queue"><tt class="docutils literal"><span class="pre">trigger.acl.queue</span></tt></a></li>
<li><a class="reference internal" href="#module-trigger.acl.tools"><tt class="docutils literal"><span class="pre">trigger.acl.tools</span></tt></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../usage/tacacsrc.html"
                        title="previous chapter">Managing Credentials with .tacacsrc</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="changemgmt.html"
                        title="next chapter"><tt class="docutils literal"><span class="pre">trigger.changemgmt</span></tt> &#8212; Change management library</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/api/acl.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="changemgmt.html" title="trigger.changemgmt — Change management library"
             >next</a> |</li>
        <li class="right" >
          <a href="../usage/tacacsrc.html" title="Managing Credentials with .tacacsrc"
             >previous</a> |</li>
        <li><a href="../index.html">Trigger 1.5 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2015, AOL Inc.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>