<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>acl_script - Modify ACLs from the command-line &mdash; Trigger 1.5 documentation</title>
    
    <link rel="stylesheet" href="../../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '1.5',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="Trigger 1.5 documentation" href="../../index.html" />
    <link rel="up" title="Command-line Tools" href="../cli.html" />
    <link rel="next" title="aclconv - ACL Converter" href="aclconv.html" />
    <link rel="prev" title="acl - ACL database interface" href="acl.html" />
 
<style type="text/css">
    span.changelog-support {color: #4070A0;}
    span.changelog-bug {color: #A04040;}
    span.changelog-feature {color: #40A056;}
    a.changelog-release {font-weight: bold;}
</style>

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aclconv.html" title="aclconv - ACL Converter"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="acl.html" title="acl - ACL database interface"
             accesskey="P">previous</a> |</li>
        <li><a href="../../index.html">Trigger 1.5 documentation</a> &raquo;</li>
          <li><a href="../cli.html" accesskey="U">Command-line Tools</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="acl-script-modify-acls-from-the-command-line">
<h1>acl_script - Modify ACLs from the command-line<a class="headerlink" href="#acl-script-modify-acls-from-the-command-line" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#about" id="id3">About</a></li>
<li><a class="reference internal" href="#usage" id="id4">Usage</a></li>
<li><a class="reference internal" href="#examples" id="id5">Examples</a><ul>
<li><a class="reference internal" href="#understanding-insert-defined" id="id6">Understanding <tt class="docutils literal"><span class="pre">--insert-defined</span></tt></a></li>
<li><a class="reference internal" href="#understanding-replace-defined" id="id7">Understanding <tt class="docutils literal"><span class="pre">--replace-defined</span></tt></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="about">
<h2><a class="toc-backref" href="#id3">About</a><a class="headerlink" href="#about" title="Permalink to this headline">¶</a></h2>
<p><strong>acl_script</strong> is a tool and an API shipped that allows for the quick and easy
modifications of filters based on various criteria. This is used most in an
automated fashion, allowing for users to quickly and efficiently setup small
scripts to auto-generate various portions of an ACL.</p>
</div>
<div class="section" id="usage">
<h2><a class="toc-backref" href="#id4">Usage</a><a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p>Here is the usage output:</p>
<div class="highlight-python"><div class="highlight"><pre>usage: acl_script [options]

ACL modify/generator from the commandline.
options:
  -h, --help
  -aACL, --acl=ACL      specify the acl file
  -n, --no-changes      don&#39;t make the changes
  --show-mods           show modifications being made in a simple format.
  --no-worklog          don&#39;t make a worklog entry
  -N, --no-input        require no input (good for scripts)
  -sSOURCE_ADDRESS, --source-address=SOURCE_ADDRESS
                        define a source address
  -dDESTINATION_ADDRESS, --destination-address=DESTINATION_ADDRESS
                        define a destination address
  --destination-address-from-file=DESTINATION_ADDRESS_FROM_FILE
                        read a set of destination-addresses from a file
  --source-address-from-file=SOURCE_ADDRESS_FROM_FILE
                        read a set of source-addresses from a file
  --protocol=PROTOCOL   define a protocol
  -pSOURCE_PORT, --source-port=SOURCE_PORT
                        define a source-port
  --source-port-range=SOURCE_PORT_RANGE
                        define a source-port range
  --destination-port-range=DESTINATION_PORT_RANGE
                        define a destination-port range
  -PDESTINATION_PORT, --destination-port=DESTINATION_PORT
                        define a destination port
  -tMODIFY_SPECIFIC_TERM, --modify-specific-term=MODIFY_SPECIFIC_TERM
                        When modifying a JUNOS type ACL, you may specify this
                        option one or more times to define a specific JUNOS
                        term you want to modify. This takes one argument which
                        should be the name of term.
  -cMODIFY_BETWEEN_COMMENTS, --modify-between-comments=MODIFY_BETWEEN_COMMENTS
                        When modifying a IOS type ACL, you may specify this
                        option one or more times to define a specific AREA of
                        the ACL you want to modify. You must have at least 2
                        comments defined in the ACL prior to running. This
                        requires two arguments, the start comment, and the end
                        comment. Your modifications will be done between the
                        two.
  --insert-defined      This option works differently based on the type of ACL
                        we are modifying. The one similar characteristic is
                        that this will never remove any access already defined,
                        just append.
  --replace-defined     This option works differently based on the type of ACL
                        we are modifying. The one similar characteristic is
                        that access can be removed, since this replaces whole
                        sets of defined data.
</pre></div>
</div>
</div>
<div class="section" id="examples">
<h2><a class="toc-backref" href="#id5">Examples</a><a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="section" id="understanding-insert-defined">
<h3><a class="toc-backref" href="#id6">Understanding <tt class="docutils literal"><span class="pre">--insert-defined</span></tt></a><a class="headerlink" href="#understanding-insert-defined" title="Permalink to this headline">¶</a></h3>
<p>This flag will tell <tt class="docutils literal"><span class="pre">acl_script</span></tt> to append (read: never remove) information
to a portion of an ACL.</p>
<div class="section" id="junos">
<h4>Junos<a class="headerlink" href="#junos" title="Permalink to this headline">¶</a></h4>
<p>On a Junos-type ACL using <tt class="docutils literal"><span class="pre">--insert-defined</span></tt>, this will only replace parts of
the term that have been specified on the command-line. This may sound confusing
but this example should clear things up.</p>
<p>Take the following term:</p>
<div class="highlight-python"><div class="highlight"><pre>term sr31337 {
    from {
        source-address {
            10.0.0.0/8;
            11.0.0.0/8;
        }
        destination-address {
            192.168.0.1/32;
        }
        destination-port 80;
        protocol tcp;
    }
    then {
        accept;
        count sr31337;
    }
}
</pre></div>
</div>
<p>If you run <tt class="docutils literal"><span class="pre">acl_script</span></tt> with the following arguments:</p>
<div class="highlight-python"><div class="highlight"><pre>acl_script --modify-specific-term sr31337 --source-address 5.5.5.5/32 --destination-port 81 --insert-defined
</pre></div>
</div>
<p>The following is generated:</p>
<div class="highlight-python"><div class="highlight"><pre>term sr31337 {
    from {
        source-address {
            5.5.5.5/32;
            10.0.0.0/8;
            11.0.0.0/8;
        }
        destination-address {
            192.168.0.1/32;
        }
        destination-port 80-81;
        protocol tcp;
    }
    then {
        accept;
        count sr31337;
    }
}
</pre></div>
</div>
<p>As you can see <tt class="docutils literal"><span class="pre">5.5.5.5/32</span></tt> was added to the <tt class="docutils literal"><span class="pre">source-address</span></tt> portion, and
<tt class="docutils literal"><span class="pre">81</span></tt> was added as a <tt class="docutils literal"><span class="pre">destination-port</span></tt>. Notice that all other fields were
left alone.</p>
</div>
<div class="section" id="ios-like">
<h4>IOS-like<a class="headerlink" href="#ios-like" title="Permalink to this headline">¶</a></h4>
<p>On IOS-like ACLs <tt class="docutils literal"><span class="pre">--insert-defined</span></tt> behaves a little bit differently. In this
case the <tt class="docutils literal"><span class="pre">acl_script</span></tt> will only add access where it is needed.</p>
<p>Take the following example:</p>
<div class="highlight-python"><div class="highlight"><pre>!!! I AM L33T
access-list 101 permit udp host 192.168.0.1 host 192.168.1.1 eq 80
access-list 101 permit ip host 192.168.0.5 host 192.168.1.10
access-list 101 permit tcp host 192.168.0.6 host 192.168.1.11 eq 22
!!! I AM NOT L33T
</pre></div>
</div>
<p>If you run <tt class="docutils literal"><span class="pre">acl_script</span></tt> with the following arguments:</p>
<div class="highlight-python"><div class="highlight"><pre>acl_script --modify-between-comments &quot;I AM L33T&quot; &quot;I AM NOT L33T&quot; \
  --source-address 192.168.0.5 \
  --destination-address 192.168.1.10 \
  --destination-address 192.168.1.11 \
  --protocol tcp \
  --destination-port 80 \
  --insert-defined
</pre></div>
</div>
<p>This output is generated:</p>
<div class="highlight-python"><div class="highlight"><pre>!!! I AM L33T
access-list 101 permit udp host 192.168.0.1 host 192.168.1.1 eq 80
access-list 101 permit ip host 192.168.0.5 host 192.168.1.10
access-list 101 permit tcp host 192.168.0.6 host 192.168.1.11 eq 22
access-list 101 permit tcp host 192.168.0.5 host 192.168.1.11 eq 80
!!! I AM NOT L33T
</pre></div>
</div>
<p>As you can see the last line was added, take note that the
<tt class="docutils literal"><span class="pre">192.168.0.5-&gt;192.168.1.10:80</span></tt> access was not added because it was already
permitted previously.</p>
</div>
</div>
<div class="section" id="understanding-replace-defined">
<h3><a class="toc-backref" href="#id7">Understanding <tt class="docutils literal"><span class="pre">--replace-defined</span></tt></a><a class="headerlink" href="#understanding-replace-defined" title="Permalink to this headline">¶</a></h3>
<p>This flag will completely replace portions of an ACL with newly-defined information.</p>
<div class="section" id="id1">
<h4>Junos<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>Take the following term:</p>
<div class="highlight-python"><div class="highlight"><pre>term sr31337 {
    from {
        source-address {
            10.0.0.0/8;
            11.0.0.0/8;
        }
        destination-address {
            192.168.0.1/32;
        }
        destination-port 80;
        protocol tcp;
    }
    then {
        accept;
        count sr31337;
    }
}
</pre></div>
</div>
<dl class="docutils">
<dt>With the following arguments to <tt class="docutils literal"><span class="pre">acl_script</span></tt>::</dt>
<dd>acl_script &#8211;modify-specific-term sr31337 &#8211;source-address 5.5.5.5 &#8211;replace-defined</dd>
</dl>
<p>The following is generated:</p>
<div class="highlight-python"><div class="highlight"><pre>term sr31337 {
    from {
        source-address {
            5.5.5.5/32;
        }
        destination-address {
            192.168.0.1/32;
        }
        destination-port 80;
        protocol tcp;
    }
    then {
        accept;
        count sr31337;
    }
}
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h4>IOS-like<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>More on this later!</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">acl_script - Modify ACLs from the command-line</a><ul>
<li><a class="reference internal" href="#about">About</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#understanding-insert-defined">Understanding <tt class="docutils literal"><span class="pre">--insert-defined</span></tt></a><ul>
<li><a class="reference internal" href="#junos">Junos</a></li>
<li><a class="reference internal" href="#ios-like">IOS-like</a></li>
</ul>
</li>
<li><a class="reference internal" href="#understanding-replace-defined">Understanding <tt class="docutils literal"><span class="pre">--replace-defined</span></tt></a><ul>
<li><a class="reference internal" href="#id1">Junos</a></li>
<li><a class="reference internal" href="#id2">IOS-like</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="acl.html"
                        title="previous chapter">acl - ACL database interface</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="aclconv.html"
                        title="next chapter">aclconv - ACL Converter</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../../_sources/usage/scripts/acl_script.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="aclconv.html" title="aclconv - ACL Converter"
             >next</a> |</li>
        <li class="right" >
          <a href="acl.html" title="acl - ACL database interface"
             >previous</a> |</li>
        <li><a href="../../index.html">Trigger 1.5 documentation</a> &raquo;</li>
          <li><a href="../cli.html" >Command-line Tools</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2006-2015, AOL Inc.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>