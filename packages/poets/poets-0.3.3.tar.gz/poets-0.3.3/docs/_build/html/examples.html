

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Examples &mdash; poets 0.3.3 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="poets 0.3.3 documentation" href="index.html"/>
        <link rel="next" title="License" href="license.html"/>
        <link rel="prev" title="Introduction to poets, the Python Open Earth Observation Tools" href="introduction.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> poets</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to poets, the Python Open Earth Observation Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#supported-data">Supported Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#contribute">Contribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="introduction.html#ancillary-data">Ancillary data</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#some-notes-before-we-start">Some notes before we start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-poet-base-class">Setting up a Poet base class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#usage-of-custom-shapefiles">Usage of custom shapefiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-a-source">Adding a source</a></li>
<li class="toctree-l2"><a class="reference internal" href="#download-and-resample-data">Download and resample data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-images">Reading and plotting images</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reading-and-plotting-time-series">Reading and plotting time series</a></li>
<li class="toctree-l2"><a class="reference internal" href="#web-interface">Web Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="#complete-example">Complete Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="_rst/modules.html">Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="_rst/poets.html">poets package</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">poets</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/examples.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h1>
<div class="section" id="some-notes-before-we-start">
<h2>Some notes before we start<a class="headerlink" href="#some-notes-before-we-start" title="Permalink to this headline">¶</a></h2>
<p>This version of poets supports resampling to a daily, weekly, monthly or dekadal interval, with values at the period end.
Dekadal resolution provides 3 values per month at day 10, day 20 and the last day of the month.</p>
<p>If you want your data to be resampled and clipped to one or multiple countries,
you need to provide a list containing the <a class="reference external" href="https://en.wikipedia.org/wiki/FIPS_country_code">FIPS country codes</a> for each country.
[&#8216;AA&#8217;, &#8216;AC&#8217;] for example would represet Aruba and Antigua and Barbuda.
If you want to youse your own shapefile, please read <a class="reference internal" href="#usage-of-custom-shapefiles">Usage of custom shapefiles</a>. If you want the data to be resampled globally, just skip the regions parameter.</p>
<p>In our example, we want to resample <a class="reference external" href="http://neo.sci.gsfc.nasa.gov/view.php?datasetId=MOD11C1_D_LSTDA">MODIS Land Surface Temperature</a> data over the area of Austria to a resolution of 0.1° on a dekadal basis.</p>
<p>But now let&#8217;s start...</p>
</div>
<div class="section" id="setting-up-a-poet-base-class">
<h2>Setting up a Poet base class<a class="headerlink" href="#setting-up-a-poet-base-class" title="Permalink to this headline">¶</a></h2>
<p>To be able to use poets, a <a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a> class must be initialized.
You can find a description of the class parameters and attribures here: <a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a>.</p>
<p>In[1]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="nn">poets.poet</span> <span class="kn">import</span> <span class="n">Poet</span>

<span class="c"># poets attributes:</span>
<span class="n">rootpath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;Test&#39;</span><span class="p">)</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;AU&#39;</span><span class="p">]</span> <span class="c"># clipping to Austria</span>
<span class="n">spatial_resolution</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">temporal_resolution</span> <span class="o">=</span> <span class="s">&#39;dekad&#39;</span>
<span class="n">start_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">nan_value</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span>

<span class="c"># initializing Poet class:</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poet</span><span class="p">(</span><span class="n">rootpath</span><span class="p">,</span> <span class="n">regions</span><span class="p">,</span> <span class="n">spatial_resolution</span><span class="p">,</span> <span class="n">temporal_resolution</span><span class="p">,</span>
         <span class="n">start_date</span><span class="p">,</span> <span class="n">nan_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="usage-of-custom-shapefiles">
<h2>Usage of custom shapefiles<a class="headerlink" href="#usage-of-custom-shapefiles" title="Permalink to this headline">¶</a></h2>
<p>Resampling and clipping data to a regions specified in a custom shapefile is available since v0.3.1.
A link to the custom shapefile must be set with the
<a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a> <cite>shapefile</cite> parameter.
The shapefile itself must contain one attribute whicht contains a unique ID or Code,
which is used to select the desired region/area with the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a>
<cite>regions</cite> parameter. The shapefile must be in given in WGS 84.</p>
<p>The following example extends the code from <cite>In[1]</cite> with the shapefile parameter. In this case,
the shapefile is locally stored at <cite>D:\Shapefiles\shapefile1.shp</cite>, and we want to clip the data
to <cite>region1</cite> and <cite>region2</cite>.
Please note that the file-suffix &#8221;.shp&#8221; MUST NOT be set in the shapefile parameter!</p>
<p>In[2]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># use custom shapefile:</span>
<span class="n">shapefile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s">&#39;D:</span><span class="se">\\</span><span class="s">&#39;</span><span class="p">,</span> <span class="s">&#39;Shapefiles&#39;</span><span class="p">,</span> <span class="s">&#39;shapefile1&#39;</span><span class="p">)</span>
<span class="n">regions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;region1&#39;</span><span class="p">,</span> <span class="s">&#39;region2&#39;</span><span class="p">]</span>

<span class="c"># initializing Poet class:</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Poet</span><span class="p">(</span><span class="n">rootpath</span><span class="p">,</span> <span class="n">regions</span><span class="p">,</span> <span class="n">spatial_resolution</span><span class="p">,</span> <span class="n">temporal_resolution</span><span class="p">,</span>
         <span class="n">start_date</span><span class="p">,</span> <span class="n">nan_value</span><span class="p">,</span> <span class="n">shapefile</span><span class="o">=</span><span class="n">shapefile</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-a-source">
<h2>Adding a source<a class="headerlink" href="#adding-a-source" title="Permalink to this headline">¶</a></h2>
<p>Data sources can be added via the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.add_source" title="poets.poet.Poet.add_source"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.add_source</span></tt></a> method.
In order to be able to extract the date out of the filename of imagefiles, it is necessary to provide
the location of the date attributes within the filename with the parameter <cite>filedate</cite>. We know that
this is very unfortunate, but we&#8217;ll promise to work on a more convenient method.</p>
<p>In[3]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># source attributes:</span>
<span class="n">name</span> <span class="o">=</span> <span class="s">&#39;MODIS_LST&#39;</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s">&quot;MOD11C1_D_LSTDA_{YYYY}_{MM}-{DD}.png&quot;</span>
<span class="n">filedate</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;YYYY&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="s">&#39;MM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">23</span><span class="p">),</span> <span class="s">&#39;DD&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">26</span><span class="p">)}</span>
<span class="n">temp_res</span> <span class="o">=</span> <span class="s">&#39;daily&#39;</span>
<span class="n">host</span> <span class="o">=</span> <span class="s">&quot;neoftp.sci.gsfc.nasa.gov&quot;</span>
<span class="n">protocol</span> <span class="o">=</span> <span class="s">&#39;FTP&#39;</span>
<span class="n">directory</span> <span class="o">=</span> <span class="s">&quot;/gs/MOD11C1_D_LSTDA/&quot;</span>
<span class="n">begin_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">nan_value</span> <span class="o">=</span> <span class="mi">255</span>

<span class="c"># initializing the data source:</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filedate</span><span class="p">,</span> <span class="n">temp_res</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span>
             <span class="n">directory</span><span class="o">=</span><span class="n">directory</span><span class="p">,</span> <span class="n">begin_date</span><span class="o">=</span><span class="n">begin_date</span><span class="p">,</span>
             <span class="n">nan_value</span><span class="o">=</span><span class="n">nan_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="download-and-resample-data">
<h2>Download and resample data<a class="headerlink" href="#download-and-resample-data" title="Permalink to this headline">¶</a></h2>
<p>After setting up a Poet base class and adding some sources, we can now start downloading and resampling the data by calling the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.fetch_data" title="poets.poet.Poet.fetch_data"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.fetch_data</span></tt></a> method.</p>
<p>In[4]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">()</span>
</pre></div>
</div>
<p>That&#8217;s it! The <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.fetch_data" title="poets.poet.Poet.fetch_data"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.fetch_data</span></tt></a> method will now go through all defined sources and start downloading and resampling the data.
The resampled NetCDF file will be saved to the <cite>DATA</cite> folder within the rootpath as defined above.</p>
<p>The fetch_data method will download data starting from the begin_date as defined in the source up to the current date.
If you want to download and resample only a specific time period, you can do so by calling the method with the parameters <cite>begin</cite> and <cite>end</cite>.</p>
<p>In[5]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Download and resample data for January 2000:</span>
<span class="n">p</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">31</span><span class="p">))</span>

<span class="c"># Download and resample data from 2005 on:</span>
<span class="n">p</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="n">begin</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2005</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>

<span class="c"># Download and resample data until 2005:</span>
<span class="n">p</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="n">end</span><span class="o">=</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2004</span><span class="p">,</span><span class="mi">12</span><span class="p">,</span><span class="mi">13</span><span class="p">))</span>
</pre></div>
</div>
<p>By default, downloaded rawdata will be kept in the <cite>TMP</cite> folder. However, if you do not need this data you can delete it by setting the delete_rawdata flag as followed:</p>
<p>In[6]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Delete rawdata after resampling</span>
<span class="n">p</span><span class="o">.</span><span class="n">fetch_data</span><span class="p">(</span><span class="n">delete_rawdata</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="download-and-resample-data-from-sources-individually">
<h3>Download and resample data from sources individually<a class="headerlink" href="#download-and-resample-data-from-sources-individually" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.fetch_data" title="poets.poet.Poet.fetch_data"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.fetch_data</span></tt></a> downloads and resamples data from all sources.
However, if you want to fetch data from only one source, you can do so by calling the <a class="reference internal" href="_rst/poets.io.html#poets.io.source_base.BasicSource.download_and_resample" title="poets.io.source_base.BasicSource.download_and_resample"><tt class="xref py py-class docutils literal"><span class="pre">poets.io.source_base.BasicSource.download_and_resample</span></tt></a> method.
This method can be called within the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a> class by accessing the source as followed:</p>
<p>In[7]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">download_and_resample</span><span class="p">()</span>
</pre></div>
</div>
<p>You can use the parameters begin, end and delete_rawdata as described in <a class="reference internal" href="#download-and-resample-data">Download and resample data</a>.</p>
</div>
<div class="section" id="download-only">
<h3>Download only<a class="headerlink" href="#download-only" title="Permalink to this headline">¶</a></h3>
<p>If you only want to download the data without resampling it, you can do so by calling the <a class="reference internal" href="_rst/poets.io.html#poets.io.source_base.BasicSource.download" title="poets.io.source_base.BasicSource.download"><tt class="xref py py-class docutils literal"><span class="pre">poets.io.source_base.BasicSource.download</span></tt></a> method.
You can use the parameters begin, end and delete_rawdata as described in <a class="reference internal" href="#download-and-resample-data">Download and resample data</a>.</p>
<p>In[8]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># for all sources:</span>
<span class="n">p</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>

<span class="c"># for an individual source:</span>
<span class="n">p</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">download</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="resampling-only">
<h3>Resampling only<a class="headerlink" href="#resampling-only" title="Permalink to this headline">¶</a></h3>
<p>If you already downloaded data manually and only want to resample it, you can do so by calling the <a class="reference internal" href="_rst/poets.io.html#poets.io.source_base.BasicSource.resample" title="poets.io.source_base.BasicSource.resample"><tt class="xref py py-class docutils literal"><span class="pre">poets.io.source_base.BasicSource.resample</span></tt></a> method.
You can use the parameters begin, end and delete_rawdata as described in <a class="reference internal" href="#download-and-resample-data">Download and resample data</a>.</p>
<p>In[9]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># for all sources:</span>
<span class="n">p</span><span class="o">.</span><span class="n">resample</span><span class="p">()</span>

<span class="c"># for an individual source:</span>
<span class="n">p</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="finding-and-closing-gaps-in-data">
<h3>Finding and closing gaps in data<a class="headerlink" href="#finding-and-closing-gaps-in-data" title="Permalink to this headline">¶</a></h3>
<p>Sometimes it can occur that data is temporarily not available at a data
repository which can result in gaps in the data. poets can detect and attempt
to fill these gaps with <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.fill_gaps" title="poets.poet.Poet.fill_gaps"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.fill_gaps</span></tt></a>, respectively
<a class="reference internal" href="_rst/poets.io.html#poets.io.source_base.BasicSource.fill_gaps" title="poets.io.source_base.BasicSource.fill_gaps"><tt class="xref py py-class docutils literal"><span class="pre">poets.io.source_base.BasicSource.fill_gaps</span></tt></a>.</p>
<p>In[10]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># for all sources:</span>
<span class="n">p</span><span class="o">.</span><span class="n">fill_gaps</span><span class="p">()</span>

<span class="c"># for an individual source:</span>
<span class="n">p</span><span class="o">.</span><span class="n">sources</span><span class="p">[</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fill_gaps</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-and-plotting-images">
<h2>Reading and plotting images<a class="headerlink" href="#reading-and-plotting-images" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to read and plot images from the resampled NetCDF file.
It presumes that we already set up a Poet class and added the source <cite>MODIS_LST</cite> as
given in <a class="reference internal" href="#setting-up-a-poet-base-class">Setting up a Poet base class</a>. For plotting, we will use <a class="reference external" href="http://matplotlib.org">Matplotlib</a>.</p>
<p>Reading the image can be done with the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.read_image" title="poets.poet.Poet.read_image"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.read_image</span></tt></a> method.
Please note that this method returns the image as numpy array and additionally the longitudes and latitudes of the image.</p>
<p>In[11]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">image</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">metadata</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read_image</span><span class="p">(</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">,</span> <span class="n">datetime</span><span class="p">(</span><span class="mi">2000</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">31</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example we plot the image for the last dekad in May 2000.</p>
<img alt="_images/read_img_austria.png" src="_images/read_img_austria.png" />
<p>If poets is set up for multiple regions and/or the defined source has multiple variables, the parameters <cite>region</cite> and <cite>variable</cite> must be set. See <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.read_image" title="poets.poet.Poet.read_image"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.read_image</span></tt></a> for more information.</p>
</div>
<div class="section" id="reading-and-plotting-time-series">
<h2>Reading and plotting time series<a class="headerlink" href="#reading-and-plotting-time-series" title="Permalink to this headline">¶</a></h2>
<p>This example shows how to read and plot time series data from the resampled NetCDF file.
It presumes that we already set up a Poet class and added the source <cite>MODIS_LST</cite> as
given in <a class="reference internal" href="#setting-up-a-poet-base-class">Setting up a Poet base class</a>. For plotting, we will use <a class="reference external" href="http://matplotlib.org">Matplotlib</a>.</p>
<p>Reading the image can be done with the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.read_timeseries" title="poets.poet.Poet.read_timeseries"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.read_timeseries</span></tt></a> method.
You can read time series only for gridpoints given in the defined region(s). To get a list of available
gridpoints, you can call <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.get_gridpoints" title="poets.poet.Poet.get_gridpoints"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.get_gridpoints</span></tt></a>. It is also possible to call the read_timeseries function with longitude/latitude values. In this case the location parameter must be given as tuple</p>
<p>In[12]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="c"># Get a list of valid gridpoints</span>
<span class="n">gridpoints</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_gridpoints</span><span class="p">()</span>

<span class="c"># Reading the time series for point 1632</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read_timeseries</span><span class="p">(</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">,</span> <span class="mi">1632</span><span class="p">)</span>

<span class="c"># Reading the time series with given lon/lat values:</span>
<span class="n">ts</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">read_timeseries</span><span class="p">(</span><span class="s">&#39;MODIS_LST&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mf">15.391416550</span><span class="p">,</span> <span class="mf">48.497042624</span><span class="p">))</span>

<span class="c"># Plot time series</span>
<span class="n">ts</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>And this is how the result will look like:</p>
<img alt="_images/read_ts_austria.png" src="_images/read_ts_austria.png" />
<p>If poets is set up for multiple regions and/or the defined source has multiple variables, the parameters <cite>region</cite> and <cite>variable</cite> must be set. See <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.read_timeseries" title="poets.poet.Poet.read_timeseries"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.read_timeseries</span></tt></a> for more information.</p>
</div>
<div class="section" id="web-interface">
<h2>Web Interface<a class="headerlink" href="#web-interface" title="Permalink to this headline">¶</a></h2>
<p>Once Poets is set up, data is downloaded and resampled it is time to check out
the built in web interface. All you have to do is run the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.start_app" title="poets.poet.Poet.start_app"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.start_app</span></tt></a> command.</p>
<p>In[13]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">.</span><span class="n">start_app</span><span class="p">()</span>
</pre></div>
</div>
<p>By default, the app will run on host <cite>127.0.0.1</cite> and port <cite>5000</cite>. However, other values
can be set with the keywords <cite>host</cite> and <cite>port</cite>.</p>
<p>In[14]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">.</span><span class="n">start_app</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s">&#39;111.222.3.44&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="using-colorbars-and-units">
<h3>Using colorbars and units<a class="headerlink" href="#using-colorbars-and-units" title="Permalink to this headline">¶</a></h3>
<p>The default colorbar used for displaying images is matplotlibs <cite>jet</cite>. You choose any colorbar
from <a class="reference external" href="http://matplotlib.org/examples/color/colormaps_reference.html">this list</a> by setting
the <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.add_source" title="poets.poet.Poet.add_source"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.add_source</span></tt></a> colorbar parameter. Further, if the physical unit
of the dataset is not given in its metadata, you can set the unit manually with the <cite>unit</cite> parameter.
In our example the unit would be <cite>degree celsius</cite>.</p>
<p>In[15]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># setting the colobar for a source:</span>
<span class="n">p</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="s">&#39;Blues&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s">&#39;degree celsius&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="scaling-data">
<h3>Scaling data<a class="headerlink" href="#scaling-data" title="Permalink to this headline">¶</a></h3>
<p>By default, poets supports scaling of data if a corresponding parameter is given in the metadata of the source data.
Sometimes, this information is missing although the data is scaled. In our example the each MODIS_LST file contains values
between 0 and 255, where 255 represents the NaN value. In this case, we need to set the parameters
<cite>nan_value</cite> and <cite>data_range</cite> when adding a source with <a class="reference internal" href="_rst/poets.html#poets.poet.Poet.add_source" title="poets.poet.Poet.add_source"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet.add_source</span></tt></a>. Further, we need to scale the
dataset to its actual value range between min -25°C and max 45°C.</p>
<p>in[16]:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">p</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">nan_value</span><span class="o">=</span><span class="mi">255</span><span class="p">,</span> <span class="n">data_range</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">254</span><span class="p">),</span> <span class="n">valid_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">25</span><span class="p">,</span> <span class="mi">45</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="using-custom-region-names">
<h3>Using custom region names<a class="headerlink" href="#using-custom-region-names" title="Permalink to this headline">¶</a></h3>
<p>To display custom region names instead of the FIPS Code, the name of the region can be overwritten with the
<a class="reference internal" href="_rst/poets.html#poets.poet.Poet" title="poets.poet.Poet"><tt class="xref py py-class docutils literal"><span class="pre">poets.poet.Poet</span></tt></a> <cite>region_names</cite> parameter. This parameter must be given as list with the same size as
the <cite>regions</cite> parameter.</p>
</div>
</div>
<div class="section" id="complete-example">
<h2>Complete Example<a class="headerlink" href="#complete-example" title="Permalink to this headline">¶</a></h2>
<p>In[17]:</p>
<div class="highlight-python"><div class="highlight"><pre>import os
from datetime import datetime
from poets.poet import Poet

# poets attributes:
rootpath = os.path.join(&#39;D:\\&#39;, &#39;Test&#39;) # Wherever the data should be stored
regions = [&#39;AU&#39;] # clipping to Austria
region_names = [&#39;Austria&#39;]
spatial_resolution = 0.1
temporal_resolution = &#39;dekad&#39;
start_date = datetime(2000, 1, 1)
nan_value = -99

# initializing Poet class:
p = Poet(rootpath, regions, spatial_resolution, temporal_resolution,
         start_date, nan_value, region_names=region_names)

# setting source attributes:
name = &#39;MODIS_LST&#39;
filename = &quot;MOD11C1_D_LSTDA_{YYYY}_{MM}-{DD}.png&quot;
filedate = {&#39;YYYY&#39;: (16, 20), &#39;MM&#39;: (21, 23), &#39;DD&#39;: (24, 26)}
temp_res = &#39;daily&#39;
host = &quot;neoftp.sci.gsfc.nasa.gov&quot;
protocol = &#39;FTP&#39;
directory = &quot;/gs/MOD11C1_D_LSTDA/&quot;
begin_date = datetime(2000, 2, 24)
nan_value = 255
data_range = (0, 254)
valid_range = (-25, 45)
unit = &quot;degree Celsius&quot;

# adding the source
p.add_source(name, filename, filedate, temp_res, host, protocol,
             directory=directory, begin_date=begin_date,
             nan_value=nan_value, valid_range=valid_range,
             data_range=data_range, unit=unit)


# get the data (in this example from beginning of 2014)
p.fetch_data(begin=datetime(2014,1,1)


# start the web interface
p.start_app()
</pre></div>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="license.html" class="btn btn-neutral float-right" title="License"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="introduction.html" class="btn btn-neutral" title="Introduction to poets, the Python Open Earth Observation Tools"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Thomas Mistelbauer.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.3.3',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>