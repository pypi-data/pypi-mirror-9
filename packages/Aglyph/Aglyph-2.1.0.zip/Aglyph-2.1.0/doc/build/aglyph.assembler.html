

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>aglyph.assembler — The Aglyph component assembler &mdash; Aglyph 2.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="Aglyph 2.1.0 documentation" href="index.html"/>
        <link rel="up" title="Aglyph API reference" href="api-ref.html"/>
        <link rel="next" title="aglyph.binder — The Aglyph component binder" href="aglyph.binder.html"/>
        <link rel="prev" title="aglyph — Dependency Injection for Python" href="aglyph.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> Aglyph</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="whats-new.html">What&#8217;s new in release 2.1.0?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="whats-new.html#previous-releases-of-aglyph">Previous releases of Aglyph</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="get-started.html">Getting started with Aglyph</a><ul>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#download-and-install-aglyph">1. Download and install Aglyph</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#download-extract-and-run-the-movielisterapp-application">2. Download, extract, and run the <em>movielisterapp</em> application</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#a-very-brief-introduction-to-dependency-injection">3. A <em>(very)</em> brief introduction to Dependency Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#make-some-general-improvements-to-the-movielisterapp-application">4. Make some general improvements to the <em>movielisterapp</em> application</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#add-dependency-injection-support-to-the-movielisterapp-application">5. Add Dependency Injection support to the <em>movielisterapp</em> application</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#make-changes-to-the-movielisterapp-application">6. Make changes to the <em>movielisterapp</em> application</a></li>
<li class="toctree-l2"><a class="reference internal" href="get-started.html#suggested-next-steps">Suggested next steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cookbook.html">Aglyph cookbook</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cookbook-understanding.html">Understand the general features of Aglyph</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-configuration.html">Choose a configuration approach for Aglyph</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-common.html">Common usage scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-templating.html">Component inheritance using templates</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-notable.html">Other notable usage scenarios</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookbook-integration.html">Integrating Aglyph</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="api-ref.html">Aglyph API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="aglyph.html"><tt class="docutils literal"><span class="pre">aglyph</span></tt> &#8212; Dependency Injection for Python</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href=""><tt class="docutils literal"><span class="pre">aglyph.assembler</span></tt> &#8212; The Aglyph component assembler</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.binder.html"><tt class="docutils literal"><span class="pre">aglyph.binder</span></tt> &#8212; The Aglyph component binder</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.cache.html"><tt class="docutils literal"><span class="pre">aglyph.cache</span></tt> &#8212; Simple object caching support for Aglyph</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.compat.html"><tt class="docutils literal"><span class="pre">aglyph.compat</span></tt> &#8212; Python version/variant compatibility</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.compat.ipyetree.html"><tt class="docutils literal"><span class="pre">aglyph.compat.ipyetree</span></tt> &#8212; an <em>ElementTree</em> parser for <em>IronPython</em></a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.component.html"><tt class="docutils literal"><span class="pre">aglyph.component</span></tt> &#8212; Defining components and their dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.context.html"><tt class="docutils literal"><span class="pre">aglyph.context</span></tt> &#8212; Defining component contexts</a></li>
<li class="toctree-l2"><a class="reference internal" href="aglyph.integration.cherrypy.html"><tt class="docutils literal"><span class="pre">aglyph.integration.cherrypy</span></tt> &#8212; Integrating Aglyph with CherryPy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Aglyph 2.1.0 testing summary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="testing.html#id1">CPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#id2">PyPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#id3">Stackless Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#id4">IronPython</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#id5">Jython</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html#previous-releases-of-aglyph">Previous releases of Aglyph</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">Roadmap for future releases</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Aglyph</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="api-ref.html">Aglyph API reference</a> &raquo;</li>
      
    <li><tt class="docutils literal"><span class="pre">aglyph.assembler</span></tt> &#8212; The Aglyph component assembler</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/aglyph.assembler.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="module-aglyph.assembler">
<span id="aglyph-assembler-the-aglyph-component-assembler"></span><h1><a class="reference internal" href="#module-aglyph.assembler" title="aglyph.assembler"><tt class="xref py py-mod docutils literal"><span class="pre">aglyph.assembler</span></tt></a> &#8212; The Aglyph component assembler<a class="headerlink" href="#module-aglyph.assembler" title="Permalink to this headline">¶</a></h1>
<p>The Aglyph assembler creates application objects from component
definitions, injecting dependencies into those objects through
initialization arguments and keywords, attributes, setter methods,
and/or properties.</p>
<p>Application components and their dependencies are defined in an
<a class="reference internal" href="aglyph.context.html#aglyph.context.Context" title="aglyph.context.Context"><tt class="xref py py-class docutils literal"><span class="pre">aglyph.context.Context</span></tt></a>, which is used to initialize an
assembler.</p>
<p>An assembler provides thread-safe caching of <strong>singleton</strong> component
instances, <strong>borg</strong> component shared-states (i.e. instance <tt class="docutils literal"><span class="pre">__dict__</span></tt>
references), and <strong>weakref</strong> component instance weak references.</p>
<dl class="class">
<dt id="aglyph.assembler.Assembler">
<em class="property">class </em><tt class="descclassname">aglyph.assembler.</tt><tt class="descname">Assembler</tt><big>(</big><em>context</em><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <tt class="xref py py-class docutils literal"><span class="pre">builtins.object</span></tt></p>
<p>Create application objects using type 2 (setter) and type 3
(constructor) dependency injection.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>context</strong> (<a class="reference internal" href="aglyph.context.html#aglyph.context.Context" title="aglyph.context.Context"><em>aglyph.context.Context</em></a>) &#8211; a mapping of unique IDs to component and template definitions</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="aglyph.assembler.Assembler.assemble">
<tt class="descname">assemble</tt><big>(</big><em>component_spec</em><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.assemble"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.assemble" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an object identified by <em>component_spec</em> and inject
its dependencies.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>component_spec</strong> &#8211; used to determine the dotted name or                             component unique ID</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">a complete object with all of its resolved dependencies</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body"><ul class="first last simple">
<li><a class="reference external" href="http://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.4)"><strong>KeyError</strong></a> &#8211; if <em>component_spec</em> does not identify a                         component in this assembler&#8217;s context</li>
<li><a class="reference internal" href="aglyph.html#aglyph.AglyphError" title="aglyph.AglyphError"><strong>aglyph.AglyphError</strong></a> &#8211; if <em>component_spec</em> causes a                                   circular dependency</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>If <em>component_spec</em> is already a string, it is assumed to
represent a component unique ID and is used as-is. Otherwise,
<a class="reference internal" href="aglyph.html#aglyph.format_dotted_name" title="aglyph.format_dotted_name"><tt class="xref py py-func docutils literal"><span class="pre">aglyph.format_dotted_name()</span></tt></a> is used to convert
<em>component_spec</em> into a dotted name string, which is assumed to
be the component&#8217;s unique ID.</p>
<p>How a component object is assembled (created, initialized,
wired, and returned) is determined by the component&#8217;s
<a class="reference internal" href="aglyph.component.html#aglyph.component.Component.strategy" title="aglyph.component.Component.strategy"><tt class="xref py py-attr docutils literal"><span class="pre">aglyph.component.Component.strategy</span></tt></a>:</p>
<dl class="docutils">
<dt><strong>&#8220;prototype&#8221;</strong></dt>
<dd><p class="first">A new object is always created, initialized, wired, and
returned.</p>
<p class="last">This is the default assembly strategy for Aglyph components.</p>
</dd>
<dt><strong>&#8220;singleton&#8221;</strong></dt>
<dd><p class="first">If the component has been assembled already during the
current application lifetime <strong>and</strong> there has been no
intervening call to <a class="reference internal" href="#aglyph.assembler.Assembler.clear_singletons" title="aglyph.assembler.Assembler.clear_singletons"><tt class="xref py py-meth docutils literal"><span class="pre">clear_singletons()</span></tt></a>, then a cached
reference to the object is returned.</p>
<p>Otherwise, a new object is created, initialized, wired,
cached, and returned.</p>
<p>Singleton component objects are cached by their
<tt class="xref py py-attr docutils literal"><span class="pre">aglyph.component.Component.unique_id</span></tt>.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assembly of singleton components is a thread-safe
operation.</p>
</div>
</dd>
<dt><strong>&#8220;borg&#8221;</strong></dt>
<dd><p class="first">If the component has been assembled already during the
current application lifetime <strong>and</strong> there has been no
intervening call to <a class="reference internal" href="#aglyph.assembler.Assembler.clear_borgs" title="aglyph.assembler.Assembler.clear_borgs"><tt class="xref py py-meth docutils literal"><span class="pre">clear_borgs()</span></tt></a>, then a new instance
is created and a cached reference to the shared-state is
directly assigned to the instance <tt class="docutils literal"><span class="pre">__dict__</span></tt>.</p>
<p>Otherwise, a new instance is created, initialized, and wired;
its instance <tt class="docutils literal"><span class="pre">__dict__</span></tt> is cached; and the instance is
returned.</p>
<p>Borg component instance shared-states are cached by their
<tt class="xref py py-attr docutils literal"><span class="pre">aglyph.component.Component.unique_id</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Assembly of borg components is a thread-safe operation.</p>
</div>
<div class="last admonition warning">
<p class="first admonition-title">Warning</p>
<p>The borg assembly strategy is <strong>only</strong> supported for
components whose objects have an instance <tt class="docutils literal"><span class="pre">__dict__</span></tt>.</p>
<p class="last">This means that components using builtin classes, or
components using classes that define or inherit a
<tt class="docutils literal"><span class="pre">__slots__</span></tt> member, <strong>cannot</strong> be declated as borg
components.</p>
</div>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.0: </span>support for the &#8220;weakref&#8221; assembly strategy</p>
</div>
<dl class="docutils">
<dt><strong>&#8220;weakref&#8221;</strong></dt>
<dd><p class="first">In the simplest terms, this is a &#8220;prototype&#8221; that can exhibit
&#8220;singleton&#8221; behavior: as long as there is at least one &#8220;live&#8221;
reference to the assembled object in the application runtime, then
requests to assemble this component will return the same (cached)
object.</p>
<p>When the only reference to the assembled object that remains is the
cached (weak) reference, the Python garbage collector is free to
destroy the object, at which point it is automatically removed from
the Aglyph cache.
Subsequent requests to assemble the same component will cause a new
object to be created, initialized, wired, cached (as a weak
reference), and returned.</p>
<div class="last admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Please refer to the <a class="reference external" href="http://docs.python.org/3/library/weakref.html#module-weakref" title="(in Python v3.4)"><tt class="xref py py-mod docutils literal"><span class="pre">weakref</span></tt></a> module for a detailed
explanation of weak reference behavior.</p>
</div>
</dd>
</dl>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.0: </span><strong>Either</strong> <a class="reference internal" href="aglyph.component.html#aglyph.component.Component.factory_name" title="aglyph.component.Component.factory_name"><tt class="xref py py-attr docutils literal"><span class="pre">aglyph.component.Component.factory_name</span></tt></a>
<strong>or</strong> <a class="reference internal" href="aglyph.component.html#aglyph.component.Component.member_name" title="aglyph.component.Component.member_name"><tt class="xref py py-attr docutils literal"><span class="pre">aglyph.component.Component.member_name</span></tt></a> may be
defined to exercise more control over how a component object
is created and initialized. Refer to the linked documentation
for details.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method is called recursively to assemble any dependency
of <em>component_spec</em> that is defined as a
<a class="reference internal" href="aglyph.component.html#aglyph.component.Reference" title="aglyph.component.Reference"><tt class="xref py py-class docutils literal"><span class="pre">aglyph.component.Reference</span></tt></a>.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="aglyph.assembler.Assembler.init_singletons">
<tt class="descname">init_singletons</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.init_singletons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.init_singletons" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble and cache all singleton component objects.</p>
<p>This method may be called at any time to &#8220;prime&#8221; the internal
singleton cache. For example, to eagerly initialize all
singleton components for your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">assembler</span> <span class="o">=</span> <span class="n">Assembler</span><span class="p">(</span><span class="n">XMLContext</span><span class="p">(</span><span class="s">&quot;my-context.xml&quot;</span><span class="p">))</span>
<span class="n">assembler</span><span class="o">.</span><span class="n">init_singletons</span><span class="p">()</span>
<span class="c"># -OR-</span>
<span class="n">binder</span> <span class="o">=</span> <span class="n">MyBinder</span><span class="p">()</span>
<span class="n">binder</span><span class="o">.</span><span class="n">init_singletons</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the initialized singleton component IDs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.4)"><tt class="xref py py-obj docutils literal"><span class="pre">list</span></tt></a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Only singleton components that do not <em>already</em> have cached
objects will be initialized by this method.</p>
<p class="last">Initialization of singleton component objects is a
thread-safe operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="aglyph.assembler.Assembler.clear_singletons">
<tt class="descname">clear_singletons</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.clear_singletons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.clear_singletons" title="Permalink to this definition">¶</a></dt>
<dd><p>Evict all cached singleton component objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the evicted singleton component IDs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.4)"><tt class="xref py py-obj docutils literal"><span class="pre">list</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Aglyph makes the following guarantees:</p>
<ol class="arabic simple">
<li>All cached singleton objects&#8217; &#8220;before_clear&#8221; lifecycle
methods are called (if specified) when they are evicted from
cache.</li>
<li>The singleton cache will be empty when this method
terminates.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Any exception raised by a &#8220;before_clear&#8221; lifecycle method is
caught, logged, and issued as a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#RuntimeWarning" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">RuntimeWarning</span></tt></a>.</p>
<p class="last">Eviction of cached singleton component objects is a
thread-safe operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="aglyph.assembler.Assembler.init_borgs">
<tt class="descname">init_borgs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.init_borgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.init_borgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble and cache the shared-states for all borg component
objects.</p>
<p>This method may be called at any time to &#8220;prime&#8221; the internal
borg cache. For example, to eagerly initialize all borg
component shared-states for your application:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">assembler</span> <span class="o">=</span> <span class="n">Assembler</span><span class="p">(</span><span class="n">XMLContext</span><span class="p">(</span><span class="s">&quot;my-context.xml&quot;</span><span class="p">))</span>
<span class="n">assembler</span><span class="o">.</span><span class="n">init_borgs</span><span class="p">()</span>
<span class="c"># -OR-</span>
<span class="n">binder</span> <span class="o">=</span> <span class="n">MyBinder</span><span class="p">()</span>
<span class="n">binder</span><span class="o">.</span><span class="n">init_borgs</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the initialized borg component IDs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.4)"><tt class="xref py py-obj docutils literal"><span class="pre">list</span></tt></a></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Only borg components that do not <em>already</em> have cached
shared-states will be initialized by this method.</p>
<p class="last">Initialization of borg component shared-states is a
thread-safe operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="aglyph.assembler.Assembler.clear_borgs">
<tt class="descname">clear_borgs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.clear_borgs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.clear_borgs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evict all cached borg component shared-states.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the evicted borg component IDs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.4)"><tt class="xref py py-obj docutils literal"><span class="pre">list</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Aglyph makes the following guarantees:</p>
<ol class="arabic simple">
<li>All cached borg shared-states&#8217; &#8220;before_clear&#8221; lifecycle
methods are called (if specified) when they are evicted from
cache.</li>
<li>The borg cache will be empty when this method terminates.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Any exception raised by a &#8220;before_clear&#8221; lifecycle method is
caught, logged, and issued as a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#RuntimeWarning" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">RuntimeWarning</span></tt></a>.</p>
<p class="last">Eviction of cached borg component shared-states is a
thread-safe operation.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="aglyph.assembler.Assembler.clear_weakrefs">
<tt class="descname">clear_weakrefs</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/aglyph/assembler.html#Assembler.clear_weakrefs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#aglyph.assembler.Assembler.clear_weakrefs" title="Permalink to this definition">¶</a></dt>
<dd><p>Evict all cached weakref component objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">the evicted weakref component IDs</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body"><a class="reference external" href="http://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.4)"><tt class="xref py py-obj docutils literal"><span class="pre">list</span></tt></a></td>
</tr>
</tbody>
</table>
<p>Aglyph makes the following guarantees:</p>
<ol class="arabic simple">
<li><strong>IF</strong> a cached weakref object is still available <strong>AND</strong>
the component definition specifies a &#8220;before_clear&#8221; lifecycle
method, Aglyph will call that method when the object is
evicted.</li>
<li>The weakref cache will be empty when this method terminates.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Any exception raised by a &#8220;before_clear&#8221; lifecycle method is
caught, logged, and issued as a <a class="reference external" href="http://docs.python.org/3/library/exceptions.html#RuntimeWarning" title="(in Python v3.4)"><tt class="xref py py-class docutils literal"><span class="pre">RuntimeWarning</span></tt></a>.</p>
<p class="last">Eviction of cached weakref component objects is a thread-safe
operation.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>While eviction of weakref components is a thread-safe
operation with respect to <em>explicit</em> modification of the
weakref cache (i.e. any other thread attempting to
<a class="reference internal" href="#aglyph.assembler.Assembler.assemble" title="aglyph.assembler.Assembler.assemble"><tt class="xref py py-meth docutils literal"><span class="pre">assemble()</span></tt></a> a weakref component or to
<tt class="docutils literal"><span class="pre">clear_weakrefs()</span></tt> will be blocked until this method
returns), the nature of weak references means that entries
may still &#8220;disappear&#8221; from the cache <em>even while the cache
lock is held.</em></p>
<p>With respect to cache-clearing, this means that referent
component objects may no longer be available even <em>after</em> the
cache lock has been acquired and the weakref component IDs
(keys) are retrieved from the cache. Practically speaking,
this means that callers must be aware of two things:</p>
<ol class="last arabic simple">
<li>Aglyph <strong>cannot</strong> guarantee that &#8220;before_clear&#8221; lifecycle
methods are called on weakref component objects, because
there is no guarantee that a cached weak references is
&#8220;live.&#8221; (This is the nature of weak references.)</li>
<li>Aglyph will only return the component IDs of weakref
component objects that were &#8220;live&#8221; at the moment they were
cleared.</li>
</ol>
</div>
<p>Please refer to the <a class="reference external" href="http://docs.python.org/3/library/weakref.html#module-weakref" title="(in Python v3.4)"><tt class="xref py py-mod docutils literal"><span class="pre">weakref</span></tt></a> module for a detailed
explanation of weak reference behavior.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="aglyph.binder.html" class="btn btn-neutral float-right" title="aglyph.binder — The Aglyph component binder">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="aglyph.html" class="btn btn-neutral" title="aglyph — Dependency Injection for Python"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2006-2015, Matthew Zipay.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'2.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>