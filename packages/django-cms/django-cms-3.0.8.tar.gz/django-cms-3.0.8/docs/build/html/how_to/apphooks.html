<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>App-Hooks &mdash; django cms 3.0.6 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="django cms 3.0.6 documentation" href="../index.html" />
    <link rel="up" title="How-to guides" href="index.html" />
    <link rel="next" title="Working with templates" href="templates.html" />
    <link rel="prev" title="Customising navigation menus" href="menus.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="templates.html" title="Working with templates"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="menus.html" title="Customising navigation menus"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">django cms 3.0.6 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">How-to guides</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="app-hooks">
<h1>App-Hooks<a class="headerlink" href="#app-hooks" title="Permalink to this headline">¶</a></h1>
<p>With App-Hooks you can attach whole Django applications to pages. For example
you have a news app and you want it attached to your news page.</p>
<p>To create an apphook create a <tt class="docutils literal"><span class="pre">cms_app.py</span></tt> in your application. And in it
write the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cms.app_base</span> <span class="kn">import</span> <span class="n">CMSApp</span>
<span class="kn">from</span> <span class="nn">cms.apphook_pool</span> <span class="kn">import</span> <span class="n">apphook_pool</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>

<span class="k">class</span> <span class="nc">MyApphook</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;My Apphook&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;myapp.urls&quot;</span><span class="p">]</span>

<span class="n">apphook_pool</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyApphook</span><span class="p">)</span>
</pre></div>
</div>
<p>Replace <tt class="docutils literal"><span class="pre">myapp.urls</span></tt> with the path to your applications <tt class="docutils literal"><span class="pre">urls.py</span></tt>.</p>
<p>Now edit a page and open the advanced settings tab. Select your new apphook
under &#8220;Application&#8221;. Save the page.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Whenever you add or remove an apphook, change the slug of a page containing
an apphook or the slug if a page which has a descendant with an apphook,
you have to restart your server to re-load the URL caches.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If at some point you want to remove this apphook after deleting the cms_app.py
there is a cms management command called uninstall apphooks
that removes the specified apphook(s) from all pages by name.
eg. <tt class="docutils literal"><span class="pre">manage.py</span> <span class="pre">cms</span> <span class="pre">uninstall</span> <span class="pre">apphooks</span> <span class="pre">MyApphook</span></tt>.
To find all names for uninstallable apphooks there is a command for this as well
<tt class="docutils literal"><span class="pre">manage.py</span> <span class="pre">cms</span> <span class="pre">list</span> <span class="pre">apphooks</span></tt>.</p>
</div>
<p>If you attached the app to a page with the url <tt class="docutils literal"><span class="pre">/hello/world/</span></tt> and the app has
a urls.py that looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;sampleapp.views&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^$&#39;</span><span class="p">,</span> <span class="s">&#39;main_view&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;app_main&#39;</span><span class="p">),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^sublevel/$&#39;</span><span class="p">,</span> <span class="s">&#39;sample_view&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;app_sublevel&#39;</span><span class="p">),</span>
<span class="p">)</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">main_view</span></tt> should now be available at <tt class="docutils literal"><span class="pre">/hello/world/</span></tt> and the
<tt class="docutils literal"><span class="pre">sample_view</span></tt> has the url <tt class="docutils literal"><span class="pre">/hello/world/sublevel/</span></tt>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">CMS pages <strong>below</strong> the page to which the apphook is attached to, <strong>can</strong> be visible,
provided that the apphook urlconf regexps are not too greedy. From a URL resolution
perspective, attaching an apphook works in same way than inserting the apphook urlconf
in the root urlconf at the same path as the page is attached to.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All views that are attached like this must return a
<a class="reference external" href="http://readthedocs.org/docs/django/en/latest/ref/templates/api.html#django.template.RequestContext" title="(in Django v1.8)"><tt class="xref py py-class docutils literal"><span class="pre">RequestContext</span></tt></a> instance instead of the
default <a class="reference external" href="http://readthedocs.org/docs/django/en/latest/ref/templates/api.html#django.template.Context" title="(in Django v1.8)"><tt class="xref py py-class docutils literal"><span class="pre">Context</span></tt></a> instance.</p>
</div>
<div class="section" id="apphook-menus">
<h2>Apphook Menus<a class="headerlink" href="#apphook-menus" title="Permalink to this headline">¶</a></h2>
<p>If you want to add a menu to that page as well that may represent some views
in your app add it to your apphook like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapp.menu</span> <span class="kn">import</span> <span class="n">MyAppMenu</span>

<span class="k">class</span> <span class="nc">MyApphook</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;My Apphook&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;myapp.urls&quot;</span><span class="p">]</span>
    <span class="n">menus</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyAppMenu</span><span class="p">]</span>

<span class="n">apphook_pool</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyApphook</span><span class="p">)</span>
</pre></div>
</div>
<p>For an example if your app has a <tt class="xref py py-class docutils literal"><span class="pre">Category</span></tt> model and you want this
category model to be displayed in the menu when you attach the app to a page.
We assume the following model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.db</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">django.core.urlresolvers</span> <span class="kn">import</span> <span class="n">reverse</span>
<span class="kn">import</span> <span class="nn">mptt</span>

<span class="k">class</span> <span class="nc">Category</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">ForeignKey</span><span class="p">(</span><span class="s">&#39;self&#39;</span><span class="p">,</span> <span class="n">blank</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">null</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">CharField</span><span class="p">(</span><span class="n">max_length</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__unicode__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

    <span class="k">def</span> <span class="nf">get_absolute_url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="s">&#39;category_view&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pk</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">mptt</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">Category</span><span class="p">)</span>
<span class="k">except</span> <span class="n">mptt</span><span class="o">.</span><span class="n">AlreadyRegistered</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>We would now create a menu out of these categories:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">menus.base</span> <span class="kn">import</span> <span class="n">NavigationNode</span>
<span class="kn">from</span> <span class="nn">menus.menu_pool</span> <span class="kn">import</span> <span class="n">menu_pool</span>
<span class="kn">from</span> <span class="nn">django.utils.translation</span> <span class="kn">import</span> <span class="n">ugettext_lazy</span> <span class="k">as</span> <span class="n">_</span>
<span class="kn">from</span> <span class="nn">cms.menu_bases</span> <span class="kn">import</span> <span class="n">CMSAttachMenu</span>
<span class="kn">from</span> <span class="nn">myapp.models</span> <span class="kn">import</span> <span class="n">Category</span>

<span class="k">class</span> <span class="nc">CategoryMenu</span><span class="p">(</span><span class="n">CMSAttachMenu</span><span class="p">):</span>

    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;test menu&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="n">nodes</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">category</span> <span class="ow">in</span> <span class="n">Category</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&quot;tree_id&quot;</span><span class="p">,</span> <span class="s">&quot;lft&quot;</span><span class="p">):</span>
            <span class="n">node</span> <span class="o">=</span> <span class="n">NavigationNode</span><span class="p">(</span>
                <span class="n">category</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="n">category</span><span class="o">.</span><span class="n">get_absolute_url</span><span class="p">(),</span>
                <span class="n">category</span><span class="o">.</span><span class="n">pk</span><span class="p">,</span>
                <span class="n">category</span><span class="o">.</span><span class="n">parent_id</span>
            <span class="p">)</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">nodes</span>

<span class="n">menu_pool</span><span class="o">.</span><span class="n">register_menu</span><span class="p">(</span><span class="n">CategoryMenu</span><span class="p">)</span>
</pre></div>
</div>
<p>If you add this menu now to your app-hook:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">myapp.menus</span> <span class="kn">import</span> <span class="n">CategoryMenu</span>

<span class="k">class</span> <span class="nc">MyApphook</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;My Apphook&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;myapp.urls&quot;</span><span class="p">]</span>
    <span class="n">menus</span> <span class="o">=</span> <span class="p">[</span><span class="n">MyAppMenu</span><span class="p">,</span> <span class="n">CategoryMenu</span><span class="p">]</span>
</pre></div>
</div>
<p>You get the static entries of <tt class="xref py py-class docutils literal"><span class="pre">MyAppMenu</span></tt> and the dynamic entries of
<tt class="xref py py-class docutils literal"><span class="pre">CategoryMenu</span></tt> both attached to the same page.</p>
</div>
<div class="section" id="attaching-an-application-multiple-times">
<span id="multi-apphook"></span><h2>Attaching an Application multiple times<a class="headerlink" href="#attaching-an-application-multiple-times" title="Permalink to this headline">¶</a></h2>
<p>If you want to attach an application multiple times to different pages you have 2 possibilities.</p>
<ol class="arabic simple">
<li>Give every application its own namespace in the advanced settings of a page.</li>
<li>Define an <tt class="docutils literal"><span class="pre">app_name</span></tt> attribute on the CMSApp class.</li>
</ol>
<p>The problem is that if you only define a namespace you need to have multiple templates per attached app.</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre>{% url &#39;my_view&#39; %}
</pre></div>
</div>
<p>Will not work anymore when you namespace an app. You will need to do something like:</p>
<div class="highlight-python"><div class="highlight"><pre>{% url &#39;my_namespace:my_view&#39; %}
</pre></div>
</div>
<p>The problem is now if you attach apps to multiple pages your namespace will change.
The solution for this problem are application namespaces.</p>
<p>If you&#8217;d like to use application namespaces to reverse the URLs related to
your app, you can assign a value to the <cite>app_name</cite> attribute of your app
hook like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyNamespacedApphook</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;My Namespaced Apphook&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;myapp.urls&quot;</span><span class="p">]</span>
    <span class="n">app_name</span> <span class="o">=</span> <span class="s">&quot;myapp_namespace&quot;</span>

<span class="n">apphook_pool</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">MyNamespacedApphook</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you do provide an <tt class="docutils literal"><span class="pre">app_label</span></tt>, then you will need to also give the app
a unique namespace in the advanced settings of the page. If you do not, and
no other instance of the app exists using it, then the &#8216;default instance
namespace&#8217; will be automatically set for you. You can then either reverse
for the namespace(to target different apps) or the app_name (to target
links inside the same app).</p>
</div>
<p>If you use app namespace you will need to give all your view <tt class="docutils literal"><span class="pre">context</span></tt> a <tt class="docutils literal"><span class="pre">current_app</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">current_app</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path_info</span><span class="p">)</span><span class="o">.</span><span class="n">namespace</span>
    <span class="n">context</span> <span class="o">=</span> <span class="n">RequestContext</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">current_app</span><span class="o">=</span><span class="n">current_app</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">render_to_response</span><span class="p">(</span><span class="s">&quot;my_templace.html&quot;</span><span class="p">,</span> <span class="n">context_instance</span><span class="o">=</span><span class="n">context</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You need to set the current_app explicitly in all your view contexts as django does not allow an other way of doing
this.</p>
</div>
<p>You can reverse namespaced apps similarly and it &#8220;knows&#8221; in which app instance it is:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">url</span> <span class="nv">myapp_namespace</span><span class="o">:</span><span class="nv">app_main</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>If you want to access the same url but in a different language use the language
template tag:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">i18n</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">language</span> <span class="s2">&quot;de&quot;</span> <span class="cp">%}</span>
    <span class="cp">{%</span> <span class="k">url</span> <span class="nv">myapp_namespace</span><span class="o">:</span><span class="nv">app_main</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">endlanguage</span> <span class="cp">%}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The official Django documentation has more details about application and
instance namespaces, the <cite>current_app</cite> scope and the reversing of such
URLs. You can look it up at <a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/http/urls/#url-namespaces">https://docs.djangoproject.com/en/dev/topics/http/urls/#url-namespaces</a></p>
</div>
<p>When using the <cite>reverse</cite> function, the <cite>current_app</cite> has to be explicitly passed
as an argument. You can do so by looking up the <cite>current_app</cite> attribute of
the request instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">myviews</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="n">current_app</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path_info</span><span class="p">)</span><span class="o">.</span><span class="n">namespace</span>

    <span class="n">reversed_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s">&#39;myapp_namespace:app_main&#39;</span><span class="p">,</span>
            <span class="n">current_app</span><span class="o">=</span><span class="n">current_app</span><span class="p">)</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>Or, if you are rendering a plugin, of the context instance:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyPlugin</span><span class="p">(</span><span class="n">CMSPluginBase</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">render</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">instance</span><span class="p">,</span> <span class="n">placeholder</span><span class="p">):</span>
        <span class="c"># ...</span>
        <span class="n">current_app</span> <span class="o">=</span> <span class="n">resolve</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">path_info</span><span class="p">)</span><span class="o">.</span><span class="n">namespace</span>
        <span class="n">reversed_url</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="s">&#39;myapp_namespace:app_main&#39;</span><span class="p">,</span>
                <span class="n">current_app</span><span class="o">=</span><span class="n">current_app</span><span class="p">)</span>
        <span class="c"># ...</span>
</pre></div>
</div>
</div>
<div class="section" id="apphook-permissions">
<span id="id1"></span><h2>Apphook Permissions<a class="headerlink" href="#apphook-permissions" title="Permalink to this headline">¶</a></h2>
<p>By default all apphooks have the same permissions set as the page they are assigned to.
So if you set login required on page the attached apphook and all it&#8217;s urls have the same
requirements.</p>
<p>To disable this behavior set <tt class="docutils literal"><span class="pre">permissions</span> <span class="pre">=</span> <span class="pre">False</span></tt> on your apphook:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SampleApp</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Sample App&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;project.sampleapp.urls&quot;</span><span class="p">]</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="bp">False</span>
</pre></div>
</div>
<p>If you still want some of your views to have permission checks you can enable them via a decorator:</p>
<p><tt class="docutils literal"><span class="pre">cms.utils.decorators.cms_perms</span></tt></p>
<p>Here is a simple example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">cms.utils.decorators</span> <span class="kn">import</span> <span class="n">cms_perms</span>

<span class="nd">@cms_perms</span>
<span class="k">def</span> <span class="nf">my_view</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>If you have your own permission check in your app, or just don&#8217;t want to wrap some nested apps
with CMS permission decorator, then use <tt class="docutils literal"><span class="pre">exclude_permissions</span></tt> property of apphook:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SampleApp</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Sample App&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;project.sampleapp.urls&quot;</span><span class="p">]</span>
    <span class="n">permissions</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="n">exclude_permissions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;some_nested_app&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>For example, <a class="reference external" href="https://github.com/tangentlabs/django-oscar">django-oscar</a> apphook integration needs to be used with exclude permissions of dashboard app,
because it use <a class="reference external" href="https://github.com/tangentlabs/django-oscar/blob/0.7.2/oscar/apps/dashboard/nav.py#L57">customizable access function</a>. So, your apphook in this case will looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">OscarApp</span><span class="p">(</span><span class="n">CMSApp</span><span class="p">):</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">_</span><span class="p">(</span><span class="s">&quot;Oscar&quot;</span><span class="p">)</span>
    <span class="n">urls</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">patterns</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">application</span><span class="o">.</span><span class="n">urls</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="p">]</span>
    <span class="n">exclude_permissions</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;dashboard&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="automatically-restart-server-on-apphook-changes">
<h2>Automatically restart server on apphook changes<a class="headerlink" href="#automatically-restart-server-on-apphook-changes" title="Permalink to this headline">¶</a></h2>
<p>As mentioned above, whenever you add or remove an apphook, change the slug of a
page containing an apphook or the slug if a page which has a descendant with an
apphook, you have to restart your server to re-load the URL caches. To allow
you to automate this process, the django CMS provides a signal
<tt class="xref py py-obj docutils literal"><span class="pre">cms.signals.urls_need_reloading</span></tt> which you can listen on to detect when
your server needs restarting. When you run <tt class="docutils literal"><span class="pre">manage.py</span> <span class="pre">runserver</span></tt> a restart
should not be needed.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This signal does not actually do anything. To get automated server
restarting you need to implement logic in your project that gets
executed whenever this signal is fired. Because there are many ways of
deploying Django applications, there is no way we can provide a generic
solution for this problem that will always work.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The signal is fired <strong>after</strong> a request. If you change something via API
you need a request for the signal to fire.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">App-Hooks</a><ul>
<li><a class="reference internal" href="#apphook-menus">Apphook Menus</a></li>
<li><a class="reference internal" href="#attaching-an-application-multiple-times">Attaching an Application multiple times</a></li>
<li><a class="reference internal" href="#apphook-permissions">Apphook Permissions</a></li>
<li><a class="reference internal" href="#automatically-restart-server-on-apphook-changes">Automatically restart server on apphook changes</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="menus.html"
                        title="previous chapter">Customising navigation menus</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="templates.html"
                        title="next chapter">Working with templates</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/how_to/apphooks.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="templates.html" title="Working with templates"
             >next</a> |</li>
        <li class="right" >
          <a href="menus.html" title="Customising navigation menus"
             >previous</a> |</li>
        <li><a href="../index.html">django cms 3.0.6 documentation</a> &raquo;</li>
          <li><a href="index.html" >How-to guides</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Patrick Lauber.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>