<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Internationalisation &mdash; django cms 3.1.0.b1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.0.b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="django cms 3.1.0.b1 documentation" href="../index.html" />
    <link rel="up" title="Key topics" href="index.html" />
    <link rel="next" title="Permissions" href="permissions.html" />
    <link rel="prev" title="Serving content in multiple languages" href="multiple_languages.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="permissions.html" title="Permissions"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="multiple_languages.html" title="Serving content in multiple languages"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">django cms 3.1.0.b1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Key topics</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="internationalisation">
<h1>Internationalisation<a class="headerlink" href="#internationalisation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="multilingual-urls">
<h2>Multilingual URLs<a class="headerlink" href="#multilingual-urls" title="Permalink to this headline">¶</a></h2>
<p>If you use more than one language, django CMS urls, <em>including the admin URLS</em>, need to be
referenced via <a class="reference external" href="http://readthedocs.org/docs/django/en/latest/topics/i18n/translation.html#django.conf.urls.i18n.i18n_patterns" title="(in Django v1.9)"><tt class="xref py py-func docutils literal"><span class="pre">i18n_patterns()</span></tt></a>. For more information about this see
the official <a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/i18n/translation/#internationalization-in-url-patterns">Django documentation</a>
on the subject.</p>
<p>Here&#8217;s an example of <cite>urls.py</cite>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">django.conf</span> <span class="kn">import</span> <span class="n">settings</span>
<span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">include</span><span class="p">,</span> <span class="n">url</span>
<span class="kn">from</span> <span class="nn">django.contrib</span> <span class="kn">import</span> <span class="n">admin</span>
<span class="kn">from</span> <span class="nn">django.conf.urls.i18n</span> <span class="kn">import</span> <span class="n">i18n_patterns</span>
<span class="kn">from</span> <span class="nn">django.contrib.staticfiles.urls</span> <span class="kn">import</span> <span class="n">staticfiles_urlpatterns</span>

<span class="n">admin</span><span class="o">.</span><span class="n">autodiscover</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^jsi18n/(?P&lt;packages&gt;\S+?)/$&#39;</span><span class="p">,</span> <span class="s">&#39;django.views.i18n.javascript_catalog&#39;</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">urlpatterns</span> <span class="o">+=</span> <span class="n">staticfiles_urlpatterns</span><span class="p">()</span>

<span class="c"># note the django CMS URLs included via i18n_patterns</span>
<span class="n">urlpatterns</span> <span class="o">+=</span> <span class="n">i18n_patterns</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^admin/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">admin</span><span class="o">.</span><span class="n">site</span><span class="o">.</span><span class="n">urls</span><span class="p">)),</span>
    <span class="n">url</span><span class="p">(</span><span class="s">r&#39;^&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="s">&#39;cms.urls&#39;</span><span class="p">)),</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="language-cookie">
<h2>Language Cookie<a class="headerlink" href="#language-cookie" title="Permalink to this headline">¶</a></h2>
<p>If a user comes back to a previously visited page, the language will be same since his last visit.</p>
<p>By default if someone visits a page at <cite>http://www.mysite.fr/</cite> django determines the language as follow:</p>
<ul class="simple">
<li>language in url</li>
<li>language in session</li>
<li>language in cookie</li>
<li>language in from browser</li>
<li>LANGUAGE_CODE from settings</li>
</ul>
<p>More in-depth documentation about this is available at
<a class="reference external" href="https://docs.djangoproject.com/en/dev/topics/i18n/translation/#how-django-discovers-language-preference">https://docs.djangoproject.com/en/dev/topics/i18n/translation/#how-django-discovers-language-preference</a></p>
<p>When visiting a page that is only English and French with a German browser, the language from LANGUAGE_CODE will be used.
If this is English, but the visitor only speaks French, the visitor will have to switch the language.
Visiting the same page now again after some time, will show it in English again, because the browser session which was
used to store the language selection doesn&#8217;t exist anymore. To prevent this issue, a middleware exists which stores the
language selection in a cookie. Add the following middleware to <cite>MIDDLEWARE_CLASSES</cite>:</p>
<blockquote>
<div><cite>cms.middleware.language.LanguageCookieMiddleware</cite></div></blockquote>
</div>
<div class="section" id="language-chooser">
<h2>Language Chooser<a class="headerlink" href="#language-chooser" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../reference/templatetags.html#std:templatetag-language_chooser"><tt class="xref std std-ttag docutils literal"><span class="pre">language_chooser</span></tt></a> template tag will display a language chooser for the
current page. You can modify the template in <tt class="docutils literal"><span class="pre">menu/language_chooser.html</span></tt> or
provide your own template if necessary.</p>
<p>Example:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">load</span> <span class="nv">menu_tags</span> <span class="cp">%}</span>
<span class="cp">{%</span> <span class="k">language_chooser</span> <span class="s2">&quot;myapp/language_chooser.html&quot;</span> <span class="cp">%}</span>
</pre></div>
</div>
<p>If you are in an apphook and have a detail view of an object you can
set an object to the toolbar in your view. The cms will call <tt class="docutils literal"><span class="pre">get_absolute_url</span></tt> in
the corresponding language for the language chooser:</p>
<p>Example:</p>
<div class="highlight-html+django"><div class="highlight"><pre>class AnswerView(DetailView):
    def get(self, *args, **kwargs):
        self.object = self.get_object()
        if hasattr(self.request, &#39;toolbar&#39;):
            self.request.toolbar.set_object(self.object)
        response = super(AnswerView, self).get(*args, **kwargs)
        return response
</pre></div>
</div>
<p>With this you can more easily control what url will be returned on the language chooser.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have a multilingual objects be sure that you return the right url if you don&#8217;t have
a translation for this language in <tt class="docutils literal"><span class="pre">get_absolute_url</span></tt></p>
</div>
</div>
<div class="section" id="page-language-url">
<h2>page_language_url<a class="headerlink" href="#page-language-url" title="Permalink to this headline">¶</a></h2>
<p>This template tag returns the URL of the current page in another language.</p>
<p>Example:</p>
<div class="highlight-html+django"><div class="highlight"><pre><span class="cp">{%</span> <span class="k">page_language_url</span> <span class="s2">&quot;de&quot;</span> <span class="cp">%}</span>
</pre></div>
</div>
</div>
<div class="section" id="hide-untranslated">
<h2>hide_untranslated<a class="headerlink" href="#hide-untranslated" title="Permalink to this headline">¶</a></h2>
<p>If you add a default directive to your <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">CMS_LANGUAGES</span></tt></a> with a <tt class="xref std std-setting docutils literal"><span class="pre">hide_untranslated</span></tt> to <tt class="docutils literal"><span class="pre">False</span></tt>
all pages will be displayed in all languages even if they are
not translated yet.</p>
<p>If <cite>hide_untranslated</cite>  is <tt class="docutils literal"><span class="pre">True</span></tt> in your <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_LANGUAGES"><tt class="xref std std-setting docutils literal"><span class="pre">CMS_LANGUAGES</span></tt></a>
and you are on a page that doesn&#8217;t yet have an English translation and you view
the German version then the language chooser will redirect to <tt class="docutils literal"><span class="pre">/</span></tt>. The same
goes for urls that are not handled by the cms and display a language chooser.</p>
</div>
<div class="section" id="automated-slug-generation-unicode-characters">
<h2>Automated slug generation unicode characters<a class="headerlink" href="#automated-slug-generation-unicode-characters" title="Permalink to this headline">¶</a></h2>
<p>If your site has languages which use non-ASCII character sets, you might want
to enable <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_UNIHANDECODE_HOST"><tt class="xref std std-setting docutils literal"><span class="pre">CMS_UNIHANDECODE_HOST</span></tt></a> and <a class="reference internal" href="../reference/configuration.html#std:setting-CMS_UNIHANDECODE_VERSION"><tt class="xref std std-setting docutils literal"><span class="pre">CMS_UNIHANDECODE_VERSION</span></tt></a>
to get automated slugs for those languages too.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Internationalisation</a><ul>
<li><a class="reference internal" href="#multilingual-urls">Multilingual URLs</a></li>
<li><a class="reference internal" href="#language-cookie">Language Cookie</a></li>
<li><a class="reference internal" href="#language-chooser">Language Chooser</a></li>
<li><a class="reference internal" href="#page-language-url">page_language_url</a></li>
<li><a class="reference internal" href="#hide-untranslated">hide_untranslated</a></li>
<li><a class="reference internal" href="#automated-slug-generation-unicode-characters">Automated slug generation unicode characters</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="multiple_languages.html"
                        title="previous chapter">Serving content in multiple languages</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="permissions.html"
                        title="next chapter">Permissions</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/topics/i18n.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="permissions.html" title="Permissions"
             >next</a> |</li>
        <li class="right" >
          <a href="multiple_languages.html" title="Serving content in multiple languages"
             >previous</a> |</li>
        <li><a href="../index.html">django cms 3.1.0.b1 documentation</a> &raquo;</li>
          <li><a href="index.html" >Key topics</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Patrick Lauber.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>