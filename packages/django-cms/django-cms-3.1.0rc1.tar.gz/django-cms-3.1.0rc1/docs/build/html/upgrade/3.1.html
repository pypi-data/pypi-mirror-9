<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3.1 release notes &mdash; django cms 3.1.0.b1 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '3.1.0.b1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="django cms 3.1.0.b1 documentation" href="../index.html" />
    <link rel="up" title="Release notes &amp; upgrade information" href="index.html" />
    <link rel="next" title="3.0.12 release notes" href="3.0.12.html" />
    <link rel="prev" title="Release notes &amp; upgrade information" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="3.0.12.html" title="3.0.12 release notes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Release notes &amp; upgrade information"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">django cms 3.1.0.b1 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Release notes &amp; upgrade information</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="release-notes">
<span id="upgrade-to-3-1"></span><h1>3.1 release notes<a class="headerlink" href="#release-notes" title="Permalink to this headline">¶</a></h1>
<p>django CMS 3.1 has been planned largely as a consolidation release, to build on the progress made
in 3.0 and establish a safe, solid base for more ambitious work in the future.</p>
<p>In this release we have tried to maintain maximum backwards-compatibility, particularly for
third-party applications, and endeavoured to identify and tidy loose ends in the system wherever
possible.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Upgrading from previous versions</p>
<p class="last">3.1 introduces some changes that <strong>require</strong> action if you are upgrading
from a previous version. Please read <a class="reference internal" href="#upgrade-guide-3-1"><em>Upgrading for django CMS 3.0 to 3.1</em></a>.</p>
</div>
<div class="section" id="what-s-new-in-3-1">
<h2>What&#8217;s new in 3.1<a class="headerlink" href="#what-s-new-in-3-1" title="Permalink to this headline">¶</a></h2>
<div class="section" id="switch-from-mptt-to-mp">
<h3>Switch from MPTT to MP<a class="headerlink" href="#switch-from-mptt-to-mp" title="Permalink to this headline">¶</a></h3>
<p>Since django CMS 2.0 we have relied on MPTT (Modified Preorder Tree Traversal) for efficiently
handling tree structures in the database.</p>
<p>In 3.1, <a class="reference external" href="https://github.com/django-mptt/django-mptt">Django MPTT</a> has been replaced by
<a class="reference external" href="https://github.com/tabo/django-treebeard">django-treebeard</a>, to improve performance and
reliability.</p>
<p>Over the years MPTT has proved not to be fast enough for big tree operations (&gt;1000 pages); tree
corruption, because of transactional errors, has also been a problem.</p>
<p>django-treebeard uses MP (Materialized Path). MP is more efficient and has more error resistance
then MPTT. It should make working with and using django CMS better - faster and reliable.</p>
<p>Other than this, end users should not notice any changes.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User feedback required</p>
<p class="last">We require as much feedback as possible about the performance of django-treebeard in this beta
release. Please let us know your experiences with it, especially if you encounter any problems.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Backward incompatible change</p>
<p class="last">While most of the low-level interface is very similar between <tt class="docutils literal"><span class="pre">django-mptt</span></tt> and
<tt class="docutils literal"><span class="pre">django-treebeard</span></tt> they are not exactly the same.
If any custom code interfaces with plugins and pages tree low level interface, please check
the <tt class="docutils literal"><span class="pre">django-treebeard</span></tt> documentation for the updated interface.</p>
</div>
<div class="section" id="action-required">
<h4>Action required<a class="headerlink" href="#action-required" title="Permalink to this headline">¶</a></h4>
<p>Run <a class="reference internal" href="../reference/cli.html#fix-mptt"><em>manage.py cms fix-mptt</em></a> before you upgrade.</p>
<p>Developers who use django CMS will need to run the schema and data migrations that are part of this
release. Developers of third-party applications that relied on the Django MPTT that shipped with
django CMS are advised to update their own applications so that they install it independently.</p>
</div>
</div>
<div class="section" id="dropped-support-for-django-1-4-and-1-5">
<h3>Dropped support for Django 1.4 and 1.5<a class="headerlink" href="#dropped-support-for-django-1-4-and-1-5" title="Permalink to this headline">¶</a></h3>
<p>Starting from version 3.1, django CMS runs on Django 1.6 and 1.7.</p>
<div class="section" id="id1">
<h4>Action required<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>If you&#8217;re still on an earlier version, you will need to install a newer one, and make sure that
your third-party applications are also up-to-date with it before attempting to upgrade django CMS.</p>
</div>
</div>
<div class="section" id="south-is-now-an-optional-dependency">
<h3>South is now an optional dependency<a class="headerlink" href="#south-is-now-an-optional-dependency" title="Permalink to this headline">¶</a></h3>
<p>As Django South is now required for Django 1.6 only, it&#8217;s marked as an optional dependency.</p>
<div class="section" id="id2">
<h4>Action required<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>To install South along with django CMS use <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">django-cms[south]</span></tt>.</p>
</div>
</div>
<div class="section" id="migrations-moved">
<h3>Migrations moved<a class="headerlink" href="#migrations-moved" title="Permalink to this headline">¶</a></h3>
<p>Migrations directories have been renamed to conform to the new standard layout:</p>
<blockquote>
<div><ul class="simple">
<li>Django 1.7 migrations: in the default <tt class="docutils literal"><span class="pre">cms/migrations</span></tt> and <tt class="docutils literal"><span class="pre">menus/migrations</span></tt> directories</li>
<li>South migrations: in the <tt class="docutils literal"><span class="pre">cms/south_migrations</span></tt> and <tt class="docutils literal"><span class="pre">menus/south_migrations</span></tt> directories</li>
</ul>
</div></blockquote>
<div class="section" id="id3">
<h4>Action required<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>South 1.0.2 or newer is required to handle the new layout correctly, so make sure you have that
installed.</p>
<p>If you are upgrading from django CMS 3.0.x running on Django 1.7 you need to remove the old
migration path from <a class="reference external" href="https://docs.djangoproject.com/en/1.7/ref/settings/#migration-modules">MIGRATION_MODULES</a> settings.</p>
</div>
</div>
<div class="section" id="structure-mode-permission">
<h3>Structure mode permission<a class="headerlink" href="#structure-mode-permission" title="Permalink to this headline">¶</a></h3>
<p>A new <a class="reference internal" href="../topics/permissions.html"><em>*Can use Structure mode* permission</em></a> has been added.</p>
<p>Without this permission, a non-superuser will no longer have access to structure mode. This makes
possible a more strict workflow, in which certain users are abnle to edit content but not structure.</p>
<p>This change includes a data migration that adds the new permission to any staff user or group with
<tt class="docutils literal"><span class="pre">cms.change_page</span></tt> permission.</p>
<div class="section" id="id4">
<h4>Action required<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>You may need to adjust these permissions once you have completed migrating your database.</p>
<p>Note that if you have existing users in your database, but are installing django CMS and running
its migrations for the first time, you will need to grant them these permissions - they will not
acquire them automatically.</p>
</div>
</div>
<div class="section" id="simplified-loading-of-view-restrictions-in-the-menu">
<h3>Simplified loading of view restrictions in the menu<a class="headerlink" href="#simplified-loading-of-view-restrictions-in-the-menu" title="Permalink to this headline">¶</a></h3>
<p>The system that loads page view restrictions into the menu has been improved, simplifying the
queries that are generated, in order to make it faster.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>User feedback required</p>
<p class="last">We require as much feedback as possible about the performance of this feature in this beta
release. Please let us know your experiences with it, especially if you encounter any problems.</p>
</div>
</div>
<div class="section" id="toolbar-api-extension">
<h3>Toolbar API extension<a class="headerlink" href="#toolbar-api-extension" title="Permalink to this headline">¶</a></h3>
<p>The toolbar API has been extended to permit more powerful use of it in future development,
including the use of &#8220;clipboard-like&#8221; items.</p>
<p>For an example of how this can be used, see the new Blueprint application.</p>
</div>
<div class="section" id="per-namespace-apphook-configuration">
<h3>Per-namespace apphook configuration<a class="headerlink" href="#per-namespace-apphook-configuration" title="Permalink to this headline">¶</a></h3>
<p>django CMS provides a new API to define namespaced <a class="reference internal" href="../how_to/apphooks.html"><em>Apphook</em></a> configurations.</p>
<p>Aldryn Apphook Config has been created and released as a standard implementation to take advantage
of this, but other implementations can be developed.</p>
</div>
<div class="section" id="improvements-to-the-toolbar-user-interface">
<h3>Improvements to the toolbar user interface<a class="headerlink" href="#improvements-to-the-toolbar-user-interface" title="Permalink to this headline">¶</a></h3>
<p>Some minor changes have been implemented to improve the toolbar user interface.</p>
</div>
<div class="section" id="new-templatetags">
<h3>New templatetags<a class="headerlink" href="#new-templatetags" title="Permalink to this headline">¶</a></h3>
<div class="section" id="render-model-add-block">
<h4><tt class="docutils literal"><span class="pre">render_model_add_block</span></tt><a class="headerlink" href="#render-model-add-block" title="Permalink to this headline">¶</a></h4>
<p>The family of <a class="reference internal" href="../how_to/frontend_models.html#render-model-templatetags"><em>render_model</em></a> templatetags that allow Django
developers to make any Django model editable in the frontend has been extended with
<a class="reference internal" href="../reference/templatetags.html#std:templatetag-render_model_add_block"><tt class="xref std std-ttag docutils literal"><span class="pre">render_model_add_block</span></tt></a>, which can offer arbitrary markup as the <em>Edit</em> icon (rather than
just an image as previously).</p>
</div>
<div class="section" id="render-plugin-block">
<h4><tt class="docutils literal"><span class="pre">render_plugin_block</span></tt><a class="headerlink" href="#render-plugin-block" title="Permalink to this headline">¶</a></h4>
<p>Some user interfaces have some plugins hidden from display in edit/preview mode.
<a class="reference internal" href="../reference/templatetags.html#std:templatetag-render_plugin_block"><tt class="xref std std-ttag docutils literal"><span class="pre">render_plugin_block</span></tt></a> provides a way to expose them for editing, and also more generally
provides an alternative means of triggering a plugin&#8217;s change form.</p>
</div>
</div>
<div class="section" id="drop-deprecations">
<h3>Drop deprecations<a class="headerlink" href="#drop-deprecations" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">cms.context_processor.media</span></tt> has been removed in favor of
<tt class="docutils literal"><span class="pre">cms.context_processor.cms_settings</span></tt>, update your settings accordingly;</li>
</ul>
</div>
</div>
<div class="section" id="upgrading-for-django-cms-3-0-to-3-1">
<span id="upgrade-guide-3-1"></span><h2>Upgrading for django CMS 3.0 to 3.1<a class="headerlink" href="#upgrading-for-django-cms-3-0-to-3-1" title="Permalink to this headline">¶</a></h2>
<p>The two major changes regarding 3.1 are the removal of django-mptt in favor of django-treebeard
and the dropped support for Django prior 1.6.</p>
<div class="section" id="preliminary-steps">
<h3>Preliminary steps<a class="headerlink" href="#preliminary-steps" title="Permalink to this headline">¶</a></h3>
<p>Before upgrading, please make sure that you current database is consistent.</p>
<p>To ensure this, run two commands:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">cms</span> <span class="pre">delete_orphaned_plugins</span></tt></li>
<li><tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">fix_mptt</span></tt></li>
</ul>
</div>
<div class="section" id="settings-update">
<h3>Settings update<a class="headerlink" href="#settings-update" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>Change <tt class="docutils literal"><span class="pre">cms.context_processor.media</span></tt> in <tt class="docutils literal"><span class="pre">cms.context_processor.cms_settings</span></tt> in
<tt class="docutils literal"><span class="pre">TEMPLATE_CONTEXT_PROCESSORS</span></tt>;</li>
<li>Add <tt class="docutils literal"><span class="pre">treebeard</span></tt> in <tt class="docutils literal"><span class="pre">INSTALLED_APPS</span></tt> and remove <tt class="docutils literal"><span class="pre">mptt</span></tt> if not required by other
applications;</li>
<li>If using Django 1.7 remove <tt class="docutils literal"><span class="pre">cms</span></tt> and <tt class="docutils literal"><span class="pre">menus</span></tt> from <tt class="docutils literal"><span class="pre">MIGRATION_MODULES</span></tt> to support
the new migration layout;</li>
<li>If migrating for Django 1.6 and below to Django 1.7, remove <tt class="docutils literal"><span class="pre">south</span></tt> from <tt class="docutils literal"><span class="pre">installed_apps</span></tt>;</li>
</ul>
</div>
<div class="section" id="update-the-database">
<h3>Update the database<a class="headerlink" href="#update-the-database" title="Permalink to this headline">¶</a></h3>
<p>The migration for mptt to treebeard is handled by the migrations, so just running them will
update your database:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">python</span> <span class="pre">manage.py</span> <span class="pre">migrate</span></tt></li>
</ul>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.1 release notes</a><ul>
<li><a class="reference internal" href="#what-s-new-in-3-1">What&#8217;s new in 3.1</a><ul>
<li><a class="reference internal" href="#switch-from-mptt-to-mp">Switch from MPTT to MP</a><ul>
<li><a class="reference internal" href="#action-required">Action required</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dropped-support-for-django-1-4-and-1-5">Dropped support for Django 1.4 and 1.5</a><ul>
<li><a class="reference internal" href="#id1">Action required</a></li>
</ul>
</li>
<li><a class="reference internal" href="#south-is-now-an-optional-dependency">South is now an optional dependency</a><ul>
<li><a class="reference internal" href="#id2">Action required</a></li>
</ul>
</li>
<li><a class="reference internal" href="#migrations-moved">Migrations moved</a><ul>
<li><a class="reference internal" href="#id3">Action required</a></li>
</ul>
</li>
<li><a class="reference internal" href="#structure-mode-permission">Structure mode permission</a><ul>
<li><a class="reference internal" href="#id4">Action required</a></li>
</ul>
</li>
<li><a class="reference internal" href="#simplified-loading-of-view-restrictions-in-the-menu">Simplified loading of view restrictions in the menu</a></li>
<li><a class="reference internal" href="#toolbar-api-extension">Toolbar API extension</a></li>
<li><a class="reference internal" href="#per-namespace-apphook-configuration">Per-namespace apphook configuration</a></li>
<li><a class="reference internal" href="#improvements-to-the-toolbar-user-interface">Improvements to the toolbar user interface</a></li>
<li><a class="reference internal" href="#new-templatetags">New templatetags</a><ul>
<li><a class="reference internal" href="#render-model-add-block"><tt class="docutils literal"><span class="pre">render_model_add_block</span></tt></a></li>
<li><a class="reference internal" href="#render-plugin-block"><tt class="docutils literal"><span class="pre">render_plugin_block</span></tt></a></li>
</ul>
</li>
<li><a class="reference internal" href="#drop-deprecations">Drop deprecations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#upgrading-for-django-cms-3-0-to-3-1">Upgrading for django CMS 3.0 to 3.1</a><ul>
<li><a class="reference internal" href="#preliminary-steps">Preliminary steps</a></li>
<li><a class="reference internal" href="#settings-update">Settings update</a></li>
<li><a class="reference internal" href="#update-the-database">Update the database</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Release notes &amp; upgrade information</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="3.0.12.html"
                        title="next chapter">3.0.12 release notes</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="../_sources/upgrade/3.1.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="3.0.12.html" title="3.0.12 release notes"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Release notes &amp; upgrade information"
             >previous</a> |</li>
        <li><a href="../index.html">django cms 3.1.0.b1 documentation</a> &raquo;</li>
          <li><a href="index.html" >Release notes &amp; upgrade information</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2009, Patrick Lauber.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
  </body>
</html>