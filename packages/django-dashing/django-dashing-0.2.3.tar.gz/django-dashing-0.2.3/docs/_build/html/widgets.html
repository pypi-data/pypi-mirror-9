<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>3. Widgets &mdash; django-dashing 0.2 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="django-dashing 0.2 documentation" href="index.html" />
    <link rel="prev" title="2. Dashboards" href="dashboards.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="dashboards.html" title="2. Dashboards"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">django-dashing 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="widgets">
<h1>3. Widgets<a class="headerlink" href="#widgets" title="Permalink to this headline">¶</a></h1>
<p>To place widgets in your dashboard you need create a javascript file, where you call each widget that you need to place with the correct options, each widget provide an events that you can call in any javascript file to update the data.</p>
<p>For example if you create a number widget</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">dashboard</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Dashboard</span><span class="p">();</span>

<span class="p">...</span>

<span class="nx">dashboard</span><span class="p">.</span><span class="nx">addWidget</span><span class="p">(</span><span class="s1">&#39;current_valuation_widget&#39;</span><span class="p">,</span> <span class="s1">&#39;Number&#39;</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">getData</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Current Valuation&#39;</span><span class="p">,</span>
            <span class="nx">more_info</span><span class="o">:</span> <span class="s1">&#39;In billions&#39;</span><span class="p">,</span>
            <span class="nx">updated_at</span><span class="o">:</span> <span class="s1">&#39;Last updated at 14:10&#39;</span><span class="p">,</span>
            <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;$35&#39;</span><span class="p">,</span>
            <span class="nx">detail</span><span class="o">:</span> <span class="s1">&#39;64%&#39;</span>
        <span class="p">});</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Then you can publish in any moment the event <tt class="docutils literal"><span class="pre">dashboard.publish('example_widget/getData')</span></tt> to get new data and update the widget.</p>
<p>Note that in this example the <cite>getData</cite> method will be executed each 1000 milliseconds because is the default value of <cite>interval</cite> option in a <cite>Number</cite> widget.</p>
<div class="section" id="clock-widget">
<h2>3.1. Clock Widget<a class="headerlink" href="#clock-widget" title="Permalink to this headline">¶</a></h2>
<p>This widget can display an specific day an hour.</p>
<div class="section" id="options">
<h3>3.1.1. Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>row</dt>
<dd>Number of rows occupied by the widget. <em>(default: 1)</em></dd>
<dt>col</dt>
<dd>Number of columns occupied by the widget. <em>(default: 1)</em></dd>
<dt>data</dt>
<dd><p class="first">JSON object that represent the date and time in format</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">time</span><span class="o">:</span> <span class="s1">&#39;hh:mm:ss&#39;</span><span class="p">,</span>
    <span class="nx">date</span><span class="o">:</span> <span class="s1">&#39;Month Day DD sYYYY&#39;</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>getData</dt>
<dd>Function responsible to update <cite>data</cite> value, this function is executed each time interval specified in <cite>interval</cite> variable.
You can rewrite this function to get data from an external source.
<em>(default: return the browser time in a valid JSON format)</em></dd>
<dt>getWidget</dt>
<dd>Return the DOM element that represent the widget.</dd>
<dt>interval</dt>
<dd>Actualization interval of widget data on milliseconds. <em>(default: 500)</em></dd>
</dl>
</div>
</div>
<div class="section" id="graph-widget">
<h2>3.2. Graph Widget<a class="headerlink" href="#graph-widget" title="Permalink to this headline">¶</a></h2>
<p>This widget can display a value with an associate graph as background.</p>
<div class="section" id="id1">
<h3>3.2.1. Options<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>row</dt>
<dd>Number of rows occupied by the widget. <em>(default: 1)</em></dd>
<dt>col</dt>
<dd>Number of columns occupied by the widget. <em>(default: 2)</em></dd>
<dt>data</dt>
<dd><p class="first">JSON object in this format</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="sr">/x0/</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="sr">/y0/</span><span class="p">},</span>
            <span class="p">{</span><span class="nx">x</span><span class="o">:</span> <span class="sr">/x1/</span><span class="p">,</span> <span class="nx">y</span><span class="o">:</span> <span class="sr">/y1/</span><span class="p">}</span>
            <span class="p">...</span>
          <span class="p">],</span>
    <span class="nx">value</span><span class="o">:</span> <span class="sr">/string/</span>
    <span class="nx">title</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">more_info</span><span class="o">:</span> <span class="sr">/string/</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>getData</dt>
<dd>Function responsible to update <cite>data</cite> value, this function is executed each time interval specified in <cite>interval</cite> variable.
You can rewrite this function to get data from an external source.
<em>(default: empty function)</em></dd>
<dt>getWidget</dt>
<dd>Return the DOM element that represent the widget.</dd>
<dt>interval</dt>
<dd>Actualization interval of widget data on milliseconds. <em>(default: 1000)</em></dd>
</dl>
</div>
<div class="section" id="graph-options">
<h3>3.2.2. Graph options<a class="headerlink" href="#graph-options" title="Permalink to this headline">¶</a></h3>
<p>To render the graph this widget use <a class="reference external" href="http://code.shutterstock.com/rickshaw/">Rickshaw</a> library, for now the config options are quite limited, if you need be more specific you can overwrite the rivetsjs binder (rv-dashing-graph) or write a custom widget use this as guide.</p>
<p>To configure the X and Y axis must be passed as extra aparameters in the data <em>xFormat</em> and <em>yFormat</em> methods, also you can use the methods beforeRender and afterRender to execute arbitrary javascript before or after of render, for example:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">xFormat</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">n</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s1">&#39;(&#39;</span> <span class="o">+</span> <span class="nx">n</span> <span class="o">+</span> <span class="s1">&#39;)&#39;</span><span class="p">;</span>
    <span class="p">};</span>
<span class="nx">$</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;/my/api/url/&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">xFormat</span> <span class="o">=</span> <span class="nx">xFormat</span><span class="p">;</span>
    <span class="nx">data</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">afterRender</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">alert</span><span class="p">(</span><span class="s1">&#39;graph shown&#39;</span><span class="p">);</span>
    <span class="p">};</span>
    <span class="nx">$</span><span class="p">.</span><span class="nx">extend</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">data</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="python-class">
<h3>3.2.3. Python Class<a class="headerlink" href="#python-class" title="Permalink to this headline">¶</a></h3>
<p>This class helps to return valid data to be use by the widget, you can see the definition in <a class="reference external" href="https://github.com/talpor/django-dashing/blob/59def5a53d5b76db232196f2fffacd49270b27e1/dashing/widgets.py#L94-118">GitHub</a></p>
<p>Here&#8217;s an example of a graph widget where in <cite>value</cite> is displayed the total of Errands and in <cite>data</cite> is returned an array with the last two hour of activity</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">dashing.widgets</span> <span class="kn">import</span> <span class="n">GraphWidget</span>

<span class="k">class</span> <span class="nc">HourlyErrandsWidget</span><span class="p">(</span><span class="n">GraphWidget</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Hourly Errands&#39;</span>
    <span class="n">more_info</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">django_ct</span><span class="o">=</span><span class="s">&#39;errands.errand&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">latest_hours</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">latest_errands</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                            <span class="n">django_ct</span><span class="o">=</span><span class="s">&#39;errands.errand&#39;</span><span class="p">,</span>
                            <span class="n">created__gt</span><span class="o">=</span><span class="n">latest_hours</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">(</span><span class="s">&#39;created&#39;</span><span class="p">)</span>
        <span class="n">intervals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">errand</span> <span class="ow">in</span> <span class="n">latest_errands</span><span class="p">:</span>
            <span class="n">delta</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">errand</span><span class="p">[</span><span class="s">&#39;created&#39;</span><span class="p">]</span>

            <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">10</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">delta</span> <span class="o">&lt;</span> <span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="n">m</span><span class="p">):</span>
                    <span class="n">intervals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">13</span> <span class="o">-</span> <span class="n">m</span><span class="o">/</span><span class="mi">10</span><span class="p">)</span>
                    <span class="k">break</span>

        <span class="n">rlist</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">intervals</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s">&#39;x&#39;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s">&#39;y&#39;</span><span class="p">:</span> <span class="n">y</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">rlist</span><span class="o">.</span><span class="n">most_common</span><span class="p">()]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="list-widget">
<h2>3.3. List Widget<a class="headerlink" href="#list-widget" title="Permalink to this headline">¶</a></h2>
<p>This widget can display a list of elements with an associate value.</p>
<div class="section" id="id3">
<h3>3.3.1. Options<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>row</dt>
<dd>Number of rows occupied by the widget. <em>(default: 2)</em></dd>
<dt>col</dt>
<dd>Number of columns occupied by the widget. <em>(default: 1)</em></dd>
<dt>render</dt>
<dd>Function responsible of modify the DOM elements of the widget.</dd>
<dt>data</dt>
<dd><p class="first">JSON object in this format</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">data</span><span class="o">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nx">label</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
                <span class="nx">name</span><span class="o">:</span> <span class="sr">/string/</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nx">label</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
                <span class="nx">name</span><span class="o">:</span> <span class="sr">/string/</span>
            <span class="p">},</span>
            <span class="p">...</span>
          <span class="p">],</span>
    <span class="nx">title</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">more_info</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">updated_at</span><span class="o">:</span> <span class="sr">/string/</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>getData</dt>
<dd>Function responsible to update <cite>data</cite> value, this function is executed each time interval specified in <cite>interval</cite> variable.
You can rewrite this function to get data from an external source.
<em>(default: empty function)</em></dd>
<dt>getWidget</dt>
<dd>Return the DOM element that represent the widget.</dd>
<dt>interval</dt>
<dd>Actualization interval of widget data on milliseconds. <em>(default: 10000)</em></dd>
</dl>
</div>
<div class="section" id="id4">
<h3>3.3.2. Python Class<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>This class helps to return valid data to be use by the widget, you can see the definition in <a class="reference external" href="https://github.com/talpor/django-dashing/blob/59def5a53d5b76db232196f2fffacd49270b27e1/dashing/widgets.py#L67-91">GitHub</a></p>
<p>Here&#8217;s an example of a graph widget where in <cite>data</cite> returns an array with the messengers who have more requests</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">dashing.widgets</span> <span class="kn">import</span> <span class="n">ListWidget</span>

<span class="k">class</span> <span class="nc">ActiveMessengersWidget</span><span class="p">(</span><span class="n">ListWidget</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Active Messengers&#39;</span>
    <span class="n">more_info</span> <span class="o">=</span> <span class="s">&#39;Those who have more requests&#39;</span>

    <span class="k">def</span> <span class="nf">get_updated_at</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">modified</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
            <span class="n">django_ct</span><span class="o">=</span><span class="s">&#39;errand&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">order_by</span><span class="p">(</span><span class="s">&#39;-modified&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">modified</span>
        <span class="k">return</span> <span class="s">u&#39;Last updated {}&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">modified</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">messengers</span> <span class="o">=</span> <span class="n">SearchQuerySet</span><span class="p">()</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span>
                                <span class="n">django_ct</span><span class="o">=</span><span class="s">&#39;messengers&#39;</span><span class="p">,</span> <span class="n">active</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">rlist</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">messengers</span><span class="p">])</span>
        <span class="k">return</span> <span class="p">[{</span><span class="s">&#39;label&#39;</span><span class="p">:</span><span class="n">x</span><span class="p">,</span> <span class="s">&#39;value&#39;</span><span class="p">:</span><span class="n">y</span><span class="p">}</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">rlist</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="number-widget">
<h2>3.4. Number Widget<a class="headerlink" href="#number-widget" title="Permalink to this headline">¶</a></h2>
<p>This widget can display a value with another interesting information.</p>
<div class="section" id="id6">
<h3>3.4.1. Options<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>row</dt>
<dd>Number of rows occupied by the widget. <em>(default: 1)</em></dd>
<dt>col</dt>
<dd>Number of columns occupied by the widget. <em>(default: 1)</em></dd>
<dt>data</dt>
<dd><p class="first">JSON object in this format</p>
<div class="last highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">value</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">title</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">detail</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">more_info</span><span class="o">:</span> <span class="sr">/string/</span><span class="p">,</span>
    <span class="nx">updated_at</span><span class="o">:</span> <span class="sr">/string/</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
<dt>getData</dt>
<dd>Function responsible to update <cite>data</cite> value, this function is executed each time interval specified in <cite>interval</cite> variable.
You can rewrite this function to get data from an external source.
<em>(default: empty function)</em></dd>
<dt>getWidget</dt>
<dd>Return the DOM element that represent the widget.</dd>
<dt>interval</dt>
<dd>Actualization interval of widget data on milliseconds. <em>(default: 1000)</em></dd>
</dl>
</div>
<div class="section" id="id7">
<h3>3.4.2. Python Class<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>This class helps to return valid data to be use by the widget, you can see the definition in <a class="reference external" href="https://github.com/talpor/django-dashing/blob/59def5a53d5b76db232196f2fffacd49270b27e1/dashing/widgets.py#L35-64">GitHub</a></p>
<p>Here&#8217;s an example of a graph widget where in <cite>value</cite> is displayed the total of payments and in the detail and more_info shows other information of interest</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">dashing.widgets</span> <span class="kn">import</span> <span class="n">NumberWidget</span>

<span class="k">class</span> <span class="nc">PaymentsWidget</span><span class="p">(</span><span class="n">NumberWidget</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;Payments Customers&#39;</span>

    <span class="k">def</span> <span class="nf">get_value</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Payment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">get_detail</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">payments</span> <span class="o">=</span> <span class="n">Payment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payments</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">Payment</span><span class="o">.</span><span class="n">STATUS</span><span class="o">.</span><span class="n">waiting</span><span class="p">])</span>
        <span class="k">return</span> <span class="s">&#39;{} to approve&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_more_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">payments</span> <span class="o">=</span> <span class="n">Payment</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">payments</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="n">Payment</span><span class="o">.</span><span class="n">STATUS</span><span class="o">.</span><span class="n">rejected</span><span class="p">])</span>
        <span class="k">return</span> <span class="s">&#39;{} rejected&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">total</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="custom-widgets">
<h1>4. Custom Widgets<a class="headerlink" href="#custom-widgets" title="Permalink to this headline">¶</a></h1>
<p>To make a custom widget you must create three static files to define configuration parameters and appearance, in addition, you can create a python class to communicate with the Django project.</p>
<p>To name your widgets should follow a naming convention, where the name must by unique for findable through the settings.</p>
<div class="section" id="static-files">
<h2>4.1. Static Files<a class="headerlink" href="#static-files" title="Permalink to this headline">¶</a></h2>
<div class="section" id="template-file">
<h3>4.1.1. Template File<a class="headerlink" href="#template-file" title="Permalink to this headline">¶</a></h3>
<p>Its location should be <tt class="docutils literal"><span class="pre">&lt;static_directory&gt;/widgets/&lt;widget_name&gt;/&lt;widget_name&gt;.html</span></tt> this file describes its UI in plain HTML using the <a class="reference external" href="http://rivetsjs.com/docs/guide/#usage-templates">Rivets.js conventions</a> to bind data to the script file.</p>
<p>For example <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">static</span> <span class="pre">%}widgets/list/list.html</span></tt> looks like this:</p>
<div class="highlight-html"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;h1&gt;</span>{ data.title }<span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
      <span class="nt">&lt;li</span> <span class="na">rv-each-el=</span><span class="s">&quot;data.data&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;label&quot;</span><span class="nt">&gt;</span>{ el.label }<span class="nt">&lt;/span&gt;</span>
        <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">&quot;value&quot;</span><span class="nt">&gt;</span>{ el.value }<span class="nt">&lt;/span&gt;</span>
      <span class="nt">&lt;/li&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;more-info&quot;</span><span class="nt">&gt;</span>{ data.more_info }<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">&quot;updated-at&quot;</span><span class="nt">&gt;</span>{ data.updated_at }<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>The classes are only for the stylesheet.</p>
</div>
<div class="section" id="style-file">
<h3>4.1.2. Style File<a class="headerlink" href="#style-file" title="Permalink to this headline">¶</a></h3>
<p>Your location should be <tt class="docutils literal"><span class="pre">&lt;static_directory&gt;/widgets/&lt;widget_name&gt;.css</span></tt> in this file defines the styles of widget.</p>
</div>
<div class="section" id="script-file">
<h3>4.1.3. Script File<a class="headerlink" href="#script-file" title="Permalink to this headline">¶</a></h3>
<p>Your location should be <tt class="docutils literal"><span class="pre">&lt;static_directory&gt;/widgets/&lt;widget_name&gt;.js</span></tt> in this file will be defined the configuration options and default values for the new widget, the idea is to create an object using the <tt class="docutils literal"><span class="pre">new</span></tt> keyword, then we define properties and methods using <tt class="docutils literal"><span class="pre">this</span></tt> keyword.</p>
<p>We must provide an <tt class="docutils literal"><span class="pre">__init__</span></tt> method where binding the data with the template and add to the dashboard, this function is quite similar in all widgets, then it is provided by <tt class="docutils literal"><span class="pre">Dashing.utils.widgetInit</span></tt> to facilitate implementation and improve reading of widgets, also must provide a <tt class="docutils literal"><span class="pre">data</span></tt> element which will be binded to the template, and a <tt class="docutils literal"><span class="pre">getData</span></tt> function will surely be the to be overwritten to obtain relevant data as required,</p>
<p>For example <tt class="docutils literal"><span class="pre">{%</span> <span class="pre">static</span> <span class="pre">%}widgets/list/list.js</span></tt> looks like this:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="cm">/* global Dashboard */</span>

<span class="nx">Dashing</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">List</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">dashboard</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">,</span>
        <span class="nx">widget</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">__init__</span> <span class="o">=</span> <span class="nx">Dashing</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">widgetInit</span><span class="p">(</span><span class="nx">dashboard</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">row</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getWidget</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">widget</span><span class="p">;</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getData</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">interval</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">;</span>
<span class="p">};</span>
</pre></div>
</div>
<p>if we want to initialize widget with data we can write:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">data</span> <span class="o">=</span> <span class="p">{</span>
        <span class="nx">title</span><span class="o">:</span> <span class="s1">&#39;Default Title&#39;</span><span class="p">,</span>
        <span class="nx">more_info</span><span class="o">:</span> <span class="s1">&#39;No data to display&#39;</span>
    <span class="p">};</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">getWidget</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="p">...</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id10">
<h2>4.2. Python Class<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h2>
<p>Surely in many cases may be necessary give the option to get some Dajngo project data into the widget, for this dashing has a Widget class that can be inherited to deliver properly serialized data, also subsequently can be serve the data using the dashing router.</p>
<p>For example ListWidget in <tt class="docutils literal"><span class="pre">dashing/widgets.py</span></tt> looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ListWidget</span><span class="p">(</span><span class="n">Widget</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">more_info</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">updated_at</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">get_title</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">title</span>

    <span class="k">def</span> <span class="nf">get_more_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">more_info</span>

    <span class="k">def</span> <span class="nf">get_updated_at</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">updated_at</span>

    <span class="k">def</span> <span class="nf">get_data</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>

    <span class="k">def</span> <span class="nf">get_context</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_title</span><span class="p">(),</span>
            <span class="s">&#39;more_info&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_more_info</span><span class="p">(),</span>
            <span class="s">&#39;updated_at&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_updated_at</span><span class="p">(),</span>
            <span class="s">&#39;data&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data</span><span class="p">(),</span>
        <span class="p">}</span>
</pre></div>
</div>
<p>If you develop your widget with python classes necessarily going to have to distribute it via PyPI</p>
</div>
<div class="section" id="distribution">
<h2>4.3. Distribution<a class="headerlink" href="#distribution" title="Permalink to this headline">¶</a></h2>
<p>To distribute a widget you have two options, the fastest way is throught  Django Dashing Channel but is a bit limited, and through PyPI a bit trickier to pack but you have more options when developing the widget.</p>
<div class="section" id="via-django-dashing-channel">
<h3>4.3.1. Via Django Dashing Channel<a class="headerlink" href="#via-django-dashing-channel" title="Permalink to this headline">¶</a></h3>
<p>Using this distribution method the users will only have to add the widget name on <tt class="docutils literal"><span class="pre">INSTALLED_WIDGETS</span></tt> then to loading the dashboard, this locates the static files from a remote location (specified in the preconfigured repository), if the user creates a copy of the files on your local static directory then these will open locally.</p>
<p>You will have to host your files into a CDN, I recommend creating a github project and use <a class="reference external" href="https://rawgit.com/">RawGit</a> to serve through <a class="reference external" href="https://www.maxcdn.com/">MaxCDN</a>, you can take <a class="reference external" href="https://github.com/individuo7/dj-dashing-weather-widget">dj-dashing-weather-widget</a> project as a guide.</p>
<p>Finally to publish your widget in Django Dashing Channel you need to make a fork of <a class="reference external" href="https://github.com/talpor/django-dashing-channel">django-dashing-channel</a>, add your repository to repositories.json and send a pull request. In the repository root will be sought the widget static files (.js .css and .html)</p>
<p>You should create a README file for installations instructions.</p>
</div>
<div class="section" id="pypi-package">
<h3>4.3.2. PyPI Package<a class="headerlink" href="#pypi-package" title="Permalink to this headline">¶</a></h3>
<p>If your widget requires python code or just want to provide an easy way to get the widget locally then a PyPI package is the way to go.</p>
<p>As a requirement is necessary follow the widgets naming convention (<a class="reference external" href="#static-files">see static files</a>). To create a PyPI package <a class="reference external" href="https://docs.python.org/2/distutils/packageindex.html">see the documentation</a>, and should create a README file for installations instructions.</p>
<p>This not excluding the previous way, you could create a minimalist version of your widget and upload to django-dashing-channel and in the project instructions leave on how to install the PyPI version</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3. Widgets</a><ul>
<li><a class="reference internal" href="#clock-widget">3.1. Clock Widget</a><ul>
<li><a class="reference internal" href="#options">3.1.1. Options</a></li>
</ul>
</li>
<li><a class="reference internal" href="#graph-widget">3.2. Graph Widget</a><ul>
<li><a class="reference internal" href="#id1">3.2.1. Options</a></li>
<li><a class="reference internal" href="#graph-options">3.2.2. Graph options</a></li>
<li><a class="reference internal" href="#python-class">3.2.3. Python Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#list-widget">3.3. List Widget</a><ul>
<li><a class="reference internal" href="#id3">3.3.1. Options</a></li>
<li><a class="reference internal" href="#id4">3.3.2. Python Class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#number-widget">3.4. Number Widget</a><ul>
<li><a class="reference internal" href="#id6">3.4.1. Options</a></li>
<li><a class="reference internal" href="#id7">3.4.2. Python Class</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#custom-widgets">4. Custom Widgets</a><ul>
<li><a class="reference internal" href="#static-files">4.1. Static Files</a><ul>
<li><a class="reference internal" href="#template-file">4.1.1. Template File</a></li>
<li><a class="reference internal" href="#style-file">4.1.2. Style File</a></li>
<li><a class="reference internal" href="#script-file">4.1.3. Script File</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id10">4.2. Python Class</a></li>
<li><a class="reference internal" href="#distribution">4.3. Distribution</a><ul>
<li><a class="reference internal" href="#via-django-dashing-channel">4.3.1. Via Django Dashing Channel</a></li>
<li><a class="reference internal" href="#pypi-package">4.3.2. PyPI Package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="dashboards.html"
                        title="previous chapter">2. Dashboards</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/widgets.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="dashboards.html" title="2. Dashboards"
             >previous</a> |</li>
        <li><a href="index.html">django-dashing 0.2 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2014, Mauricio Reyes.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>