<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Defining Jobs using FireTasks &mdash; FireWorks 0.99 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.99',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="FireWorks 0.99 documentation" href="index.html" />
    <link rel="next" title="Creating Workflows" href="workflow_tutorial.html" />
    <link rel="prev" title="Introductory Tutorial" href="introduction.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workflow_tutorial.html" title="Creating Workflows"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introductory Tutorial"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">FireWorks 0.99 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="defining-jobs-using-firetasks">
<h1>Defining Jobs using FireTasks<a class="headerlink" href="#defining-jobs-using-firetasks" title="Permalink to this headline">¶</a></h1>
<p>This tutorial show you how to:</p>
<ul class="simple">
<li>Run multiple tasks within a single Firework</li>
<li>Run tasks that are defined within a Python function, rather than a shell script</li>
</ul>
<p>This tutorial can be completed from the command line, but some knowledge of Python is helpful. In this tutorial, we will run examples on the central server for simplicity. One could just as easily run them on a FireWorker if you&#8217;ve set one up.</p>
<div class="section" id="introduction-to-firetasks">
<h2>Introduction to FireTasks<a class="headerlink" href="#introduction-to-firetasks" title="Permalink to this headline">¶</a></h2>
<p>In the <a class="reference internal" href="introduction.html"><em>Introductory tutorial</em></a>, we ran a simple script that performed <tt class="docutils literal"><span class="pre">echo</span> <span class="pre">&quot;howdy,</span> <span class="pre">your</span> <span class="pre">job</span> <span class="pre">launched</span> <span class="pre">successfully!&quot;</span> <span class="pre">&gt;&gt;</span> <span class="pre">howdy.txt&quot;</span></tt>. Looking inside <tt class="docutils literal"><span class="pre">fw_test.yaml</span></tt>, recall that the command was defined within a task labeled <tt class="docutils literal"><span class="pre">ScriptTask</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>spec:
  _tasks:
  - _fw_name: ScriptTask
    script: echo &quot;howdy, your job launched successfully!&quot; &gt;&gt; howdy.txt
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> is one type of <em>FireTask</em>, which is a predefined job template written in Python. The <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> in particular refers Python code inside FireWorks that runs an arbitrary shell script that you give it. You can use the <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> to run almost any job (without worrying that it&#8217;s all done within a Python layer). However, you might want to set up jobs that are more powerful than shell scripts using Python programming. Later in this section, we&#8217;ll demonstrate how to accomplish this with custom <em>FireTasks</em>. However, first we&#8217;ll demonstrate the simplest version to linearly run multiple tasks.</p>
</div>
<div class="section" id="running-multiple-firetasks">
<h2>Running multiple FireTasks<a class="headerlink" href="#running-multiple-firetasks" title="Permalink to this headline">¶</a></h2>
<p>You can run multiple tasks within the same Firework (it might be helpful to review the <a class="reference internal" href="index.html#wfmodel-label"><em>Workflow Model</em></a> diagram). For example, the first step of your Firework might write an input file that the second step reads and processes. Finally, a third step might move the entire output directory somewhere else on your filesystem (or a remote server).</p>
<p>Let&#8217;s create a Firework that:</p>
<ol class="arabic simple">
<li>Writes an input file based on a <em>template</em> with some substitutions applied. We&#8217;ll do this using a built-in <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt> that can help create such files.</li>
<li>Executes a script using <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> that reads the input file and produces some output. In our test case, it will just count the number of words in that file. However, this code could be any program, for example a chemistry code.</li>
<li>Copies all your outputs to your home directory using <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt>.</li>
</ol>
<p>The three-step Firework thus looks like this:</p>
<a class="reference internal image-reference" href="_images/templatetask.png"><img alt="Template Firework" class="align-center" src="_images/templatetask.png" style="width: 300px;" /></a>
<ol class="arabic">
<li><p class="first">Navigate to the tasks tutorial directory on your FireServer:</p>
<div class="highlight-python"><div class="highlight"><pre>cd &lt;INSTALL_DIR&gt;/fw_tutorials/firetask
</pre></div>
</div>
</li>
<li><p class="first">Look inside the file <tt class="docutils literal"><span class="pre">fw_multi.yaml</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre>spec:
  _tasks:
  - _fw_name: TemplateWriterTask
    context:
      opt1: 5.0
      opt2: fast method
    output_file: inputs.txt
    template_file: simple_template.txt
  - _fw_name: ScriptTask
    script: wc -w &lt; inputs.txt &gt; words.txt
    use_shell: true
  - _fw_name: FileTransferTask
    files:
    - dest: ~/words.txt
      src: words.txt
    mode: copy
</pre></div>
</div>
<p>There are now three tasks inside our <strong>spec</strong>: the <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt>, <tt class="docutils literal"><span class="pre">ScriptTask</span></tt>, and <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt>. The <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt> will load an example template called <tt class="docutils literal"><span class="pre">simple_template.txt</span></tt> from inside the FireWorks code, replace certain portions of the template using the <tt class="docutils literal"><span class="pre">context</span></tt>, and write the result to <tt class="docutils literal"><span class="pre">input.txt</span></tt>. Next, the <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> runs a word count on <tt class="docutils literal"><span class="pre">input.txt</span></tt> using the <tt class="docutils literal"><span class="pre">wc</span></tt> command and print the result to <tt class="docutils literal"><span class="pre">words.txt</span></tt>. Finally, <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt> will copy the resulting output file to your home directory.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you would like to know more about how templated input writing works and define your own templated files, you should consult the <a class="reference internal" href="templatewritertask.html"><em>TemplateWriterTask tutorial</em></a>. A copy of <tt class="docutils literal"><span class="pre">simple_template.txt</span></tt> is given in the directory as <tt class="docutils literal"><span class="pre">simple_template_copy.txt</span></tt> (however, modifying the copy won&#8217;t modify the actual template).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt> can do much more than copy a single file. For example, it can transfer your entire output directory to a remote server using SSH. For details, see the <a class="reference internal" href="fileiotasks.html"><em>FileTransferTask docs</em></a>.</p>
</div>
</li>
<li><p class="first">Run this multi-step Firework on your FireServer:</p>
<div class="highlight-python"><div class="highlight"><pre>lpad reset
lpad add fw_multi.yaml
rlaunch singleshot
</pre></div>
</div>
</li>
</ol>
<p>You should see two files written out to the system, <tt class="docutils literal"><span class="pre">inputs.txt</span></tt> and <tt class="docutils literal"><span class="pre">words.txt</span></tt>, confirming that you successfully ran the first two steps of your job! You can also navigate to your home directory and look for <tt class="docutils literal"><span class="pre">words.txt</span></tt> to make sure the third step also got completed correctly.</p>
<p>This combination of writing a file, executing a command, and perhaps moving the results could be used in many situations. For example, you could use <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt> to write a templated queue script, and then use the <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> to submit it (e.g., via the <em>qsub</em> command). (note, however, that FireWorks provides more powerful methods to <a class="reference internal" href="queue_tutorial.html"><em>submit jobs through queues</em></a>). Or, you could use the <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt> to write an input file, the <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> to execute a code that can read that input file, and finally the <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt> to move the results somewhere.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The only way to communicate information between FireTasks within the same Firework is by writing and reading files, such as in our example. If you want to perform more complicated information transfer, you might consider <a class="reference internal" href="workflow_tutorial.html"><em>defining a workflow</em></a> that connects FireWorks instead. You can pass information easily between different FireWorks in a Workflow through the <em>FWAction</em> object, but not between FireTasks within the same Firework (<a class="reference internal" href="index.html#wfmodel-label"><em>Workflow Model</em></a>).</p>
</div>
<div class="section" id="python-example-optional">
<h3>Python Example (optional)<a class="headerlink" href="#python-example-optional" title="Permalink to this headline">¶</a></h3>
<p>Here is a complete Python example that runs multiple FireTasks within a single Firework:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">fireworks</span> <span class="kn">import</span> <span class="n">Firework</span><span class="p">,</span> <span class="n">FWorker</span><span class="p">,</span> <span class="n">LaunchPad</span><span class="p">,</span> <span class="n">ScriptTask</span><span class="p">,</span> <span class="n">TemplateWriterTask</span><span class="p">,</span> <span class="n">FileTransferTask</span>
<span class="kn">from</span> <span class="nn">fireworks.core.rocket_launcher</span> <span class="kn">import</span> <span class="n">launch_rocket</span>

<span class="c"># set up the LaunchPad and reset it</span>
<span class="n">launchpad</span> <span class="o">=</span> <span class="n">LaunchPad</span><span class="p">()</span>
<span class="n">launchpad</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">require_password</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># create the Firework consisting of multiple tasks</span>
<span class="n">firetask1</span> <span class="o">=</span> <span class="n">TemplateWriterTask</span><span class="p">({</span><span class="s">&#39;context&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s">&#39;opt1&#39;</span><span class="p">:</span> <span class="mf">5.0</span><span class="p">,</span> <span class="s">&#39;opt2&#39;</span><span class="p">:</span> <span class="s">&#39;fast method&#39;</span><span class="p">},</span> <span class="s">&#39;template_file&#39;</span><span class="p">:</span> <span class="s">&#39;simple_template.txt&#39;</span><span class="p">,</span> <span class="s">&#39;output_file&#39;</span><span class="p">:</span> <span class="s">&#39;inputs.txt&#39;</span><span class="p">})</span>
<span class="n">firetask2</span> <span class="o">=</span> <span class="n">ScriptTask</span><span class="o">.</span><span class="n">from_str</span><span class="p">(</span><span class="s">&#39;wc -w &lt; inputs.txt &gt; words.txt&#39;</span><span class="p">)</span>
<span class="n">firetask3</span> <span class="o">=</span> <span class="n">FileTransferTask</span><span class="p">({</span><span class="s">&#39;files&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s">&#39;src&#39;</span><span class="p">:</span> <span class="s">&#39;words.txt&#39;</span><span class="p">,</span> <span class="s">&#39;dest&#39;</span><span class="p">:</span> <span class="s">&#39;~/words.txt&#39;</span><span class="p">}],</span> <span class="s">&#39;mode&#39;</span><span class="p">:</span> <span class="s">&#39;copy&#39;</span><span class="p">})</span>
<span class="n">fw</span> <span class="o">=</span> <span class="n">Firework</span><span class="p">([</span><span class="n">firetask1</span><span class="p">,</span> <span class="n">firetask2</span><span class="p">,</span> <span class="n">firetask3</span><span class="p">])</span>

<span class="c"># store workflow and launch it locally, single shot</span>
<span class="n">launchpad</span><span class="o">.</span><span class="n">add_wf</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>
<span class="n">launch_rocket</span><span class="p">(</span><span class="n">launchpad</span><span class="p">,</span> <span class="n">FWorker</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-a-custom-firetask">
<span id="customtask-label"></span><h2>Creating a custom FireTask<a class="headerlink" href="#creating-a-custom-firetask" title="Permalink to this headline">¶</a></h2>
<p>The <tt class="docutils literal"><span class="pre">TemplateWriterTask</span></tt>, <tt class="docutils literal"><span class="pre">ScriptTask</span></tt>, <tt class="docutils literal"><span class="pre">FileTransferTask</span></tt> are built-into FireWorks and can be used to perform useful operations. In fact, they might be all you need! In particular, because the <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> can run arbitrary shell scripts, it can in theory run any type of computation and is an &#8216;all-encompassing&#8217; FireTask. ScriptTask also has many additional features that are covered in the <a class="reference internal" href="scripttask.html"><em>ScriptTask tutorial</em></a>.</p>
<p>However, if you are comfortable with some basic Python, you can define your own custom FireTasks for the codes you run. A custom FireTask gives you more control over your jbos, clarifies the usage of your code, and guards against unintended behavior by restricting the commands that can be executed.</p>
<p>Even if you plan to only use the built-in tasks, we suggest that you still read through the next portion before continuing with the tutorial. We&#8217;ll be creating a custom FireTask that adds one or more numbers using Python&#8217;s <tt class="docutils literal"><span class="pre">sum()</span></tt> function, and later building workflows using this (and similar) FireTasks.</p>
<div class="section" id="how-fireworks-bootstraps-a-job">
<h3>How FireWorks bootstraps a job<a class="headerlink" href="#how-fireworks-bootstraps-a-job" title="Permalink to this headline">¶</a></h3>
<p>Before diving into an example of custom FireTask, it is worth understanding how FireWorks is bootstrapping jobs based on your specification. The basic process looks like this:</p>
<a class="reference internal image-reference" href="_images/spec_sketch.png"><img alt="FireWorks Bootstrap" class="align-center" src="_images/spec_sketch.png" style="width: 500px;" /></a>
<ol class="arabic simple">
<li>The first step of the image just shows how the <strong>spec</strong> section of the Firework is structured. There is a section that contains your FireTasks (one or many), as we saw in the previous examples. The <strong>spec</strong> also allows you to define arbitrary JSON data (labeled <em>input</em> in the diagram) to pass into your FireTasks as input. So far, we haven&#8217;t seen an example of this; the only information we gave in the spec in the previous examples was within the <strong>_tasks</strong> section.</li>
<li>In the second step, FireWorks dynamically loads Python objects based on your specified <strong>_tasks</strong>. It does this by searching a list of Python packages for Python objects that have a value of <em>_fw_name</em> that match your setting. When we set a <em>_fw_name</em> of <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> in the previous examples, FireWorks was loading a Python object with a <em>_fw_name</em> class variable set to <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> (and passing the <tt class="docutils literal"><span class="pre">script</span></tt> parameter to its constructor). The <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> is just one type of FireTask that&#8217;s built into FireWorks to help you run scripts easily. You can write code for custom FireTasks anywhere in the <strong>user_packages</strong> directory of FireWorks, and it will automatically be discovered. If you want to place your FireTasks in a package outside of FireWorks, please read the <a class="reference internal" href="config_tutorial.html"><em>FireWorks configuration tutorial</em></a>. You will just need to define what Python packages to search for your custom FireTasks, or use a special format that allows for direct loading of clases.</li>
<li>In the third step, we execute the code of the FireTask we loaded. Specifically, we execute the <tt class="docutils literal"><span class="pre">run_task</span></tt> method which must be implemented for every FireTask. FireWorks passes in the <em>entire</em> spec to the <tt class="docutils literal"><span class="pre">run_task</span></tt> method; the <tt class="docutils literal"><span class="pre">run_task</span></tt> method can therefore modify its behavior based on any input data present in the spec, or by detecting previous or future tasks in the spec.</li>
<li>When the FireTask is done executing, it returns a <em>FWAction</em> object that can modify the workflow (or continue as usual) and pass information to downstream FireWorks.</li>
</ol>
</div>
<div class="section" id="custom-firetask-example-addition-task">
<h3>Custom FireTask example: Addition Task<a class="headerlink" href="#custom-firetask-example-addition-task" title="Permalink to this headline">¶</a></h3>
<p>Let&#8217;s explore custom FireTasks with by writing custom Python for adding two numbers specified in the <strong>spec</strong>.</p>
<ol class="arabic">
<li><p class="first">Staying in the firetasks tutorial directory, remove any output from the previous step:</p>
<div class="highlight-python"><div class="highlight"><pre>rm howdy.txt FW.json words.txt
</pre></div>
</div>
</li>
<li><p class="first">Let&#8217;s first look at what a custom FireTask looks like in Python. Look inside the file <tt class="docutils literal"><span class="pre">addition_task.py</span></tt> which defines the <tt class="docutils literal"><span class="pre">Addition</span> <span class="pre">Task</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AdditionTask</span><span class="p">(</span><span class="n">FireTaskBase</span><span class="p">,</span> <span class="n">FWSerializable</span><span class="p">):</span>

    <span class="n">_fw_name</span> <span class="o">=</span> <span class="s">&quot;Addition Task&quot;</span>

    <span class="k">def</span> <span class="nf">run_task</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fw_spec</span><span class="p">):</span>
        <span class="n">input_array</span> <span class="o">=</span> <span class="n">fw_spec</span><span class="p">[</span><span class="s">&#39;input_array&#39;</span><span class="p">]</span>
        <span class="n">m_sum</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">input_array</span><span class="p">)</span>

        <span class="k">print</span><span class="p">(</span><span class="s">&quot;The sum of {} is: {}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">input_array</span><span class="p">,</span> <span class="n">m_sum</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">FWAction</span><span class="p">(</span><span class="n">stored_data</span><span class="o">=</span><span class="p">{</span><span class="s">&#39;sum&#39;</span><span class="p">:</span> <span class="n">m_sum</span><span class="p">})</span>
</pre></div>
</div>
</li>
<li><p class="first">A few notes about what&#8217;s going on (things will be clearer after the next step):</p>
<ul class="simple">
<li>In the class definition, we are extending <em>FireTaskBase</em> to tell FireWorks that this is a FireTask.</li>
<li>A special parameter named <em>_fw_name</em> is set to <tt class="docutils literal"><span class="pre">Addition</span> <span class="pre">Task</span></tt>. This parameter sets what this FireTask will be called by the outside world and is used to bootstrap the object, as described in the previous section. If we did not set this ourselves, the default would have been <tt class="docutils literal"><span class="pre">fireworks:AdditionTask</span></tt> (the root module name plus the class name separated by a colon).</li>
<li>The <tt class="docutils literal"><span class="pre">run_task()</span></tt> method is a special method name that gets called when the task is run. It can take in a Firework specification (<strong>spec</strong>) in order to modify its behavior.</li>
<li>When executing <tt class="docutils literal"><span class="pre">run_task()</span></tt>, the AdditionTask we defined first reads the <strong>input_array</strong> parameter of the Firework&#8217;s <strong>spec</strong>. It then sums all the values it finds in the <strong>input_array</strong> parameter of the Firework&#8217;s <strong>spec</strong> using Python&#8217;s <tt class="docutils literal"><span class="pre">sum()</span></tt> function. Next, the FireTask prints the inputs and the sum to the standard out. Finally, the task returns a <em>FWAction</em> object.</li>
<li>We&#8217;ll discuss the FWAction object in greater detail in future tutorials. For now, it is sufficient to know that this is an instruction that says we should store the sum we computed in the database (inside the Firework&#8217;s <tt class="docutils literal"><span class="pre">stored_data</span></tt> section).</li>
</ul>
</li>
<li><p class="first">Now let&#8217;s define a Firework that runs this FireTask to add the numbers <tt class="docutils literal"><span class="pre">1</span></tt> and <tt class="docutils literal"><span class="pre">2</span></tt>. Look inside the file <tt class="docutils literal"><span class="pre">fw_adder.yaml</span></tt> for this new Firework definition:</p>
<div class="highlight-python"><div class="highlight"><pre>spec:
  _tasks:
  - _fw_name: Addition Task
    parameters: {}
  input_array:
  - 1
  - 2
</pre></div>
</div>
</li>
<li><p class="first">Let&#8217;s match up this Firework with our code for our custom Firework:</p>
<ul class="simple">
<li>The <em>_fw_name</em> parameter is set to the same value as in our code for the FireTask (<tt class="docutils literal"><span class="pre">Addition</span> <span class="pre">Task</span></tt>). This is how FireWorks knows to run your custom FireTask rather than <tt class="docutils literal"><span class="pre">ScriptTask</span></tt> or some other FireTask.</li>
<li>This <strong>spec</strong> has an <strong>input_array</strong> field defined to <tt class="docutils literal"><span class="pre">1</span></tt> and <tt class="docutils literal"><span class="pre">2</span></tt>. Remember that our Python code was grabbing the values in the <strong>input_array</strong>, summing them, and printing them to standard out.</li>
</ul>
</li>
<li><p class="first">When you are comfortable that you roughly understand how a custom FireTask is set up, try running the Firework on the central server to confirm that the <tt class="docutils literal"><span class="pre">Addition</span> <span class="pre">Task</span></tt> works:</p>
<div class="highlight-python"><div class="highlight"><pre>lpad reset
lpad add fw_adder.yaml
rlaunch --silencer singleshot
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <tt class="docutils literal"><span class="pre">--silencer</span></tt> option suppresses log messages.</p>
</div>
</li>
<li><p class="first">Confirm that the <em>sum</em> is not only printed to the screen, but also stored in our Firework in the <tt class="docutils literal"><span class="pre">stored_data</span></tt> section:</p>
<div class="highlight-python"><div class="highlight"><pre>lpad get_fws -i 1 -d all
</pre></div>
</div>
</li>
</ol>
<p>should contain in its output a section that looks like this:</p>
<div class="highlight-python"><div class="highlight"><pre>...
&quot;action&quot;: {
    &quot;update_spec&quot;: {},
    &quot;mod_spec&quot;: [],
    &quot;stored_data&quot;: {
        &quot;sum&quot;: 3
    },
...
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>Python example (optional)<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Here is a complete Python example that runs a custom FireTask:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">fireworks</span> <span class="kn">import</span> <span class="n">Firework</span><span class="p">,</span> <span class="n">FWorker</span><span class="p">,</span> <span class="n">LaunchPad</span>
<span class="kn">from</span> <span class="nn">fireworks.core.rocket_launcher</span> <span class="kn">import</span> <span class="n">launch_rocket</span>
<span class="kn">from</span> <span class="nn">fw_tutorials.firetask.addition_task</span> <span class="kn">import</span> <span class="n">AdditionTask</span>

<span class="c"># set up the LaunchPad and reset it</span>
<span class="n">launchpad</span> <span class="o">=</span> <span class="n">LaunchPad</span><span class="p">()</span>
<span class="n">launchpad</span><span class="o">.</span><span class="n">reset</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="n">require_password</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

<span class="c"># create the Firework consisting of a custom &quot;Addition&quot; task</span>
<span class="n">firework</span> <span class="o">=</span> <span class="n">Firework</span><span class="p">(</span><span class="n">AdditionTask</span><span class="p">(),</span> <span class="n">spec</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;input_array&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]})</span>

<span class="c"># store workflow and launch it locally</span>
<span class="n">launchpad</span><span class="o">.</span><span class="n">add_wf</span><span class="p">(</span><span class="n">firework</span><span class="p">)</span>
<span class="n">launch_rocket</span><span class="p">(</span><span class="n">launchpad</span><span class="p">,</span> <span class="n">FWorker</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="next-up-workflows">
<h2>Next up: Workflows!<a class="headerlink" href="#next-up-workflows" title="Permalink to this headline">¶</a></h2>
<p>With custom FireTasks, you can go beyond the limitations of running shell commands and execute arbitrary Python code templates. Furthermore, these templates can operate on data from the <strong>spec</strong> of the Firework. For example, the <tt class="docutils literal"><span class="pre">Addition</span> <span class="pre">Task</span></tt> used the <tt class="docutils literal"><span class="pre">input_array</span></tt> from the <strong>spec</strong> to decide what numbers to add. By using the same Firework with different values in the <strong>spec</strong> (try it!), one could execute a data-parallel application.</p>
<p>While one could construct an entire workflow by chaining together multiple FireTasks within a single Firework, this is often not ideal. For example, we might want to switch between different FireWorkers for different parts of the workflow depending on the computing requirements for each step. Or, we might have a restriction on walltime that necessitates breaking up the workflow into more atomic steps. Finally, we might want to employ complex branching logic or error-correction that would be cumbersome to employ within a single Firework. The next step in the tutorial is to explore <a class="reference internal" href="workflow_tutorial.html"><em>connecting together FireWorks into a workflow</em></a>.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Defining Jobs using FireTasks</a><ul>
<li><a class="reference internal" href="#introduction-to-firetasks">Introduction to FireTasks</a></li>
<li><a class="reference internal" href="#running-multiple-firetasks">Running multiple FireTasks</a><ul>
<li><a class="reference internal" href="#python-example-optional">Python Example (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-custom-firetask">Creating a custom FireTask</a><ul>
<li><a class="reference internal" href="#how-fireworks-bootstraps-a-job">How FireWorks bootstraps a job</a></li>
<li><a class="reference internal" href="#custom-firetask-example-addition-task">Custom FireTask example: Addition Task</a></li>
<li><a class="reference internal" href="#id1">Python example (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#next-up-workflows">Next up: Workflows!</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="introduction.html"
                        title="previous chapter">Introductory Tutorial</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="workflow_tutorial.html"
                        title="next chapter">Creating Workflows</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/firetask_tutorial.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="workflow_tutorial.html" title="Creating Workflows"
             >next</a> |</li>
        <li class="right" >
          <a href="introduction.html" title="Introductory Tutorial"
             >previous</a> |</li>
        <li><a href="index.html">FireWorks 0.99 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="footer">
        &copy; Copyright 2013, Anubhav Jain.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.3.
    </div>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-53488807-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>