galaxy:
  shiny-app:
    instance-profile: service-shiny
  babble:
    instance-profile: service-babble
  druid:
    compute:
      instance-profile: service-druid-compute
    indexer:
      instance-profile: service-druid-indexer
    scv:
      instance-profile: service-druid-scv
  hadoop:
    instance-profile: service-hadoop
  ingest-s3:
    instance-type: m1.xlarge
    instance-profile: service-exhibitor
  kafka:
    instance-profile: service-kafka
  zk:
    instance-profile: service-exhibitor

keypair: mmx-20130702
sg:
  - galaxy-managed
regions:
  - us-east-1
AMIs:
  us-east-1:
    hvm: ami-7a857512
    paravirtual: ami-7c857514
instance-type:
  default:
    type: paravirtual
    ephemeralcount: 2
  t1.micro:
    type: paravirtual
    ephemeralcount: 0
  m1.small:
    type: paravirtual
    ephemeralcount: 1
  m1.medium:
    type: paravirtual
    ephemeralcount: 1
  c1.medium:
    type: paravirtual
    ephemeralcount: 1
  m2.xlarge:
    type: paravirtual
    ephemeralcount: 1
  m2.2xlarge:
    type: paravirtual
    ephemeralcount: 1
  m3.medium:
    type: hvm
    ephemeralcount: 1
  m3.large:
    type: hvm
    ephemeralcount: 1
  m3.xlarge:
    type: hvm
    ephemeralcount: 2
  m3.2xlarge:
    type: hvm
    ephemeralcount: 2
  c3.large:
    type: hvm
    ephemeralcount: 2
  c3.xlarge:
    type: hvm
    ephemeralcount: 2
  c3.2xlarge:
    type: hvm
    ephemeralcount: 2
  c3.4xlarge:
    type: hvm
    ephemeralcount: 2
  c3.8xlarge:
    type: hvm
    ephemeralcount: 2
  cc2.8xlarge:
    type: hvm
    ephemeralcount: 4
  d2.xlarge:
    type: hvm
    ephemeralcount: 3
  d2.2xlarge:
    type: hvm
    ephemeralcount: 6
  d2.4xlarge:
    type: hvm
    ephemeralcount: 12
  d2.8xlarge:
    type: hvm
    ephemeralcount: 24
  i2.xlarge:
    type: hvm
    ephemeralcount: 1
  i2.2xlarge:
    type: hvm
    ephemeralcount: 2
  i2.4xlarge:
    type: hvm
    ephemeralcount: 4
  i2.8xlarge:
    type: hvm
    ephemeralcount: 8
  cr1.8xlarge:
    type: hvm
    ephemeralcount: 2
  r3.large:
    type: hvm
    ephemeralcount: 1
  r3.xlarge:
    type: hvm
    ephemeralcount: 1
  r3.2xlarge:
    type: hvm
    ephemeralcount: 1
  r3.4xlarge:
    type: hvm
    ephemeralcount: 1
  r3.8xlarge:
    type: hvm
    ephemeralcount: 2
userdata:
  default:
    mnt_raid_level: "raid0"
    ebs_raid_level: "raid0"
    mnt_filesystem: "xfs"
    ebs_filesystem: "xfs"
    mnt_options: "noatime,attr2"
    ebs_options: "noatime,attr2,nobarrier"
    hugepages: "false"
    hyperthreading: "true"
    java: 0
    hostname: False
    hostname_dns: True
    domain: "mmx-dns.com"
    provider: False
    environment: False
    service: False
    application: False
    tags: |
      tags:
        automatic: no manual tags
    galaxy_agent: "true"
    galaxy_environment: "unknown"
    galaxy_version: "unknown"
    galaxy_type: "unknown"
    galaxy_start: "true"
    grains: |
      env: prod
      roles:
        - galaxy
  template: |
    #cloud-config
    
    write_files: 
      - content: |
            # Any valid mdadm RAID level, or jbod
            mnt_raid_level=$mnt_raid_level
            ebs_raid_level=$ebs_raid_level
            # Any valid filesystem
            mnt_filesystem=$mnt_filesystem
            ebs_filesystem=$ebs_filesystem
            # Any options for filesystem of choice; defaults for XFS
            mnt_options=$mnt_options
            ebs_options=$ebs_options
        owner: "root:root"
        path: /etc/metamarkets/raid-disks.conf
        permissions: "0644"
      - content: |
            # Number of hugepages, or false
            hugepages=$hugepages
            # Hyperthreading boolean 
            hyperthreading=$hyperthreading
        owner: "root:root"
        path: /etc/metamarkets/kernel-config.conf
        permissions: "0644"
      - content: |
            # Java version (invalid version accepts default)
            java_version=$java
        owner: "root:root"
        path: /etc/metamarkets/java-config.conf
        permissions: "0644"
      - content: |
          hostname: $hostname
          hostname_dns: $hostname_dns
          domain: $domain
          provider: $provider
          environment: $environment
          service: $service
          application: $application
          $tags
        owner: "root:root"
        path: /etc/metamarkets/sethostname.yaml
        permissions: "0644"
      - content: |
            # Should Galaxy agent run on boot?
            galaxy_agent=$galaxy_agent
            # Should Galaxy autoassign? Supply all three or it won't.
            galaxy_environment=$galaxy_environment
            galaxy_version=$galaxy_version
            galaxy_type=$galaxy_type
            # Should Galaxy autostart on boot?
            galaxy_start=$galaxy_start
        owner: "root:root"
        path: /etc/metamarkets/galaxy.conf
        permissions: "0644"
      - content: |
            env: prod
            roles:
             - galaxy
        owner: "root:root"
        path: /etc/salt/grains
        permissions: "0644"
