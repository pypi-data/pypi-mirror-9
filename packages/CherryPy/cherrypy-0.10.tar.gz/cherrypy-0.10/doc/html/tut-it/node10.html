<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>8. Usare la programmazione ad oggetti su un sito web</title>
<META NAME="description" CONTENT="8. Usare la programmazione ad oggetti su un sito web">
<META NAME="keywords" CONTENT="tut">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="tut.css" type='text/css'>
<link rel="first" href="tut.html">
<link rel="contents" href="contents.html" title="Contents">

<LINK REL="next" HREF="node11.html">
<LINK REL="previous" HREF="node9.html">
<LINK REL="up" HREF="tut.html">
<LINK REL="next" HREF="node11.html">
<meta name='aesop' content='information'>
</head>
<body>
<DIV CLASS="navigation">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><A HREF="node9.html"><img src="../icons/previous.gif"
  border="0" height="32"
  alt="Previous Page" width="32"></A></td>
<td><A HREF="tut.html"><img src="../icons/up.gif"
  border="0" height="32"
  alt="Up One Level" width="32"></A></td>
<td><A HREF="node11.html"><img src="../icons/next.gif"
  border="0" height="32"
  alt="Next Page" width="32"></A></td>
<td align="center" width="100%">CherryPy Tutorial</td>
<td><A HREF="node2.html"><img src="../icons/contents.gif"
  border="0" height="32"
  alt="Contents" width="32"></A></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
</tr></table>
<b class="navlabel">Previous:</b> <a class="sectref" HREF="node9.html">7. Classi, istanze, metodi</A>
<b class="navlabel">Up:</b> <a class="sectref" HREF="tut.html">CherryPy Tutorial</A>
<b class="navlabel">Next:</b> <a class="sectref" HREF="node11.html">9. Usare diversi moduli</A>
<br><hr>
</DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0010000000000000000000">
8. Usare la programmazione ad oggetti su un sito web</A>
</H1>

<P>
Una della caratteristiche pi&#249;  potenti di CherryPy &#232; che potete realmente usare un approccio <b>object oriented</b> per "programmare" il vostro sito web.

<P>
Quando guardiamo un sito web complesso, realizziamo che alcune parti hanno cose in comune:

<UL>
<LI>Usano le stesse funzionalit&#224; ma applicandole a differenti tipi di dati
</LI>
<LI>Visualizzano la stessa informazione, ma i dati sono visualizzati in modo differente (per esempio quando avete
versioni multiple di un sito o diverse versioni in lingue differenti)
</LI>
</UL>

<P>
In entrambi i casi, OOP provvede una soluzione elegante al problema e minimizza il codice richiesto per
implementare la soluzione.

<P>
Per mostrarci come &#232; possibile tutto questo, creeremo un sito web che ha due versioni: una in Inglese ed una in Francese.
Non cambia solo il testo, ma anche i colori ed il modo di visualizzare i moduli.

<P>
Digitiamo il seguente codice:
<div class="verbatim"><pre>
#######################
CherryClass Airline abstract:
#######################
function:
    def localize(self, stri):
        return self.dictionnary.get(stri, stri)
mask:
    def header(self):
        &lt;html&gt;&lt;body&gt;
            &lt;center&gt;
                &lt;H1 py-eval="self.localize('Welcome to CherryPy airline')"&gt;&lt;/H1&gt;
                &lt;div py-if="self==airlineFrench"&gt;
                    &lt;a py-attr="request.base+'/airlineEnglish/index'" href=""&gt;
                        Click here for English version
                    &lt;/a&gt;
                &lt;/div&gt;&lt;div py-else&gt;
                    &lt;a py-attr="request.base+'/airlineFrench/index'" href=""&gt;
                        Cliquez ici pour la version franÃ§aise
                    &lt;/a&gt;
                &lt;/div&gt;
                &lt;br&gt;&lt;br&gt;&lt;br&gt;&lt;br&gt;
    def footer(self):
            &lt;/center&gt;
        &lt;/body&gt;&lt;/html&gt;
    def squareWithText(self, title, text):
        &lt;table border=0 cellspacing=0 cellpadding=1 width=200&gt;&lt;tr&gt;
            &lt;td py-attr="self.borderColor" bgColor=""&gt;
                &lt;table border=0 cellspacing=0 cellpadding=5&gt;&lt;tr&gt;
                    &lt;td py-attr="self.insideColor" bgColor=""
                        align=center width=198 py-eval="'&lt;b&gt;%s&lt;/b&gt;&lt;br&gt;&lt;br&gt;%s'
                                %(title,text)"&gt;
                    &lt;/td&gt;
                &lt;/tr&gt;&lt;/table&gt;
            &lt;/td&gt;
        &lt;/tr&gt;&lt;/table&gt;
view:
    def bookAFlight(self):
        page=self.header()
        page+=self.squareWithText(self.localize('Booking a flight'),
            self.localize('To book a flight, think about where you want to go, and you should dream about it tonight'))
        page+=self.footer()
        return page


#######################
CherryClass AirlineFrench(Airline):
#######################
variable:
    insideColor='#FFFF99'
    borderColor='#FF6666'
    dictionnary={
        'Welcome to CherryPy airline': 'Bienvenue chez CherryPy airline',
        'Booking a flight': 'Réserver un vol',
        'To book a flight, think about where you want to go, and you should 
        dream about it tonight':
            'Pour réserver un vol, pensez très fort à la destination, et vous 
            devriez en rêver cette nuit'
    }    
view:
    def index(self):
        page=self.header()
        page+=self.squareWithText('Réserver un vol', 'Pour réserver un vol, 
        cliquez sur &lt;a href="%s/bookAFlight"&gt;rÃ©server&lt;/a&gt;'%self.getPath())+'&lt;br&gt;'
        page+=self.squareWithText('Présentation', 'CherryPy airline est la compagnie
        qui vous emmène au 7ème ciel')
        page+=self.footer()
        return page

#######################
CherryClass AirlineEnglish(Airline):
#######################
variable:
    insideColor='#00CCFF'
    borderColor='#3333FF'
    dictionnary={}    
view:
    def index(self):
        page=self.header()
        page+=self.squareWithText('Presentation', 'CherryPy airline is the company 
        that will take you to cloud 9')+'&lt;br&gt;'
        page+=self.squareWithText('Book a flight', '&lt;a href="%s/bookAFlight"&gt;Click here&lt;/a&gt; 
        to book a flight'%self.getPath())
        page+=self.footer()
        return page

#######################
CherryClass Root(AirlineEnglish):
#######################
</pre></div>

<P>
Questo programma usa alcune caratteristiche di CherryPy. Proviamo a capire come funzionano:

<P>
L'idea &#232; di usare una classe CherryClass generica (<var>Airline</var>) che contiene funzioni, mask e view che sono comuni ad entrambe le versioni (Inglese e Francese) o il sito web.
Quindi usiamo 2 classi CherryClasses (<var>AirlineFrench</var>
e <var>AirlineEnglish</var>) per implemetare azioni speifiche per ogni versione.

<P>
Abbiamo usato due modi differenti per implementare ogni versione:

<UL>
<LI>In uno la sola differenza sono le label (che sono tradotte in Francese per la versione Francese).
In questo caso abbbiamo usato un dizionario per implementare la traduzione.
</LI>
<LI>nell'altro cambia anche la presentazione delle informazioni. In questo caso abbiamo scritto 2 versioni per ogni
metodo.
</LI>
</UL>

<P>
Questo esempio mostra anche alcune nuove caratteristiche di CherryPy:

<UL>
<LI><b>Astrazione delle CherryClasses</b>: avrete notato che in questo esempio che la CherryClass <var>Airline</var> 
&#232; dichiarata "abstract". Questo significa solo che il server non creer&#224; nessuna istanza di una CherryClass
chiamata <var>airline</var>. 
Il risultato sar&#224; che non potrete usare l'URL <a class="url" href="http://localhost:8000/airline/index">http://localhost:8000/airline/index</a>.
L'idea &#232; che <var>Airline</var> non pu&#242; essere chiamata direttamente.
Deve essre derivata in una sotto classe, e solo questa sotto classe pu&#242; essere accessibile dal browser.
</LI>
<LI><b>Sezione variable</b>: avrete anche notato che questo esempio usa un nuovo tipo di sezione in una CherryClass: <var>variable</var>. 
Questa sezione &#232; usata per setttare le variabili di default per questa CherryClass.
</LI>
<LI><b>self.getPath()</b>: di default CherryPy crea un metodo chiamato <var>getPath</var> per ogni CherryClass.
Questo metodo ritorna l'URL della CherryClass. Per esempio, per la CherryClass <var>AirlineFrench</var>, <var>getPath</var> dovrebbe ritornare
<a class="url" href="http://localhost:8000/airlineFrench">http://localhost:8000/airlineFrench</a>
</LI>
</UL>

<P>
Nel prossimo capitolo, impareremo come dividere il nostro codice in diversi file sorgente...

<P>

<DIV CLASS="navigation">
<p><hr>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><A HREF="node9.html"><img src="../icons/previous.gif"
  border="0" height="32"
  alt="Previous Page" width="32"></A></td>
<td><A HREF="tut.html"><img src="../icons/up.gif"
  border="0" height="32"
  alt="Up One Level" width="32"></A></td>
<td><A HREF="node11.html"><img src="../icons/next.gif"
  border="0" height="32"
  alt="Next Page" width="32"></A></td>
<td align="center" width="100%">CherryPy Tutorial</td>
<td><A HREF="node2.html"><img src="../icons/contents.gif"
  border="0" height="32"
  alt="Contents" width="32"></A></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
</tr></table>
<b class="navlabel">Previous:</b> <a class="sectref" HREF="node9.html">7. Classi, istanze, metodi</A>
<b class="navlabel">Up:</b> <a class="sectref" HREF="tut.html">CherryPy Tutorial</A>
<b class="navlabel">Next:</b> <a class="sectref" HREF="node11.html">9. Usare diversi moduli</A>
<hr>
<span class="release-info">Release 0.10-beta, documentation updated on 14. gennaio 2004.</span>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</ADDRESS>
</BODY>
</HTML>
