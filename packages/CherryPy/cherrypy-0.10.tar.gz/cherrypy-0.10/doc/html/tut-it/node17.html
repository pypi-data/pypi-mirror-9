<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
<title>15. Approntare il vostro sito per la produzione</title>
<META NAME="description" CONTENT="15. Approntare il vostro sito per la produzione">
<META NAME="keywords" CONTENT="tut">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="STYLESHEET" href="tut.css" type='text/css'>
<link rel="first" href="tut.html">
<link rel="contents" href="contents.html" title="Contents">

<LINK REL="next" HREF="node18.html">
<LINK REL="previous" HREF="node16.html">
<LINK REL="up" HREF="tut.html">
<LINK REL="next" HREF="node18.html">
<meta name='aesop' content='information'>
</head>
<body>
<DIV CLASS="navigation">
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><A HREF="node16.html"><img src="../icons/previous.gif"
  border="0" height="32"
  alt="Previous Page" width="32"></A></td>
<td><A HREF="tut.html"><img src="../icons/up.gif"
  border="0" height="32"
  alt="Up One Level" width="32"></A></td>
<td><A HREF="node18.html"><img src="../icons/next.gif"
  border="0" height="32"
  alt="Next Page" width="32"></A></td>
<td align="center" width="100%">CherryPy Tutorial</td>
<td><A HREF="node2.html"><img src="../icons/contents.gif"
  border="0" height="32"
  alt="Contents" width="32"></A></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
</tr></table>
<b class="navlabel">Previous:</b> <a class="sectref" HREF="node16.html">14. Variabili e funzioni</A>
<b class="navlabel">Up:</b> <a class="sectref" HREF="tut.html">CherryPy Tutorial</A>
<b class="navlabel">Next:</b> <a class="sectref" HREF="node18.html">16. E poi ?</A>
<br><hr>
</DIV>
<!--End of Navigation Panel-->
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"><STRONG>Subsections</STRONG></a>

<UL CLASS="ChildLinks">
<LI><A href="node17.html#SECTION0017100000000000000000">15.1 Scelta della configurazione</a>
<UL>
<LI><A href="node17.html#SECTION0017110000000000000000">15.1.1 Dovrei usare CherryPy HTTP server direttamente o con un altro webserver come Apache ?</a>
<UL>
<LI><A href="node17.html#SECTION0017111000000000000000">15.1.1.1 Uso diretto</a>
<LI><A href="node17.html#SECTION0017112000000000000000">15.1.1.2 Uso dietro Apache</a>
</ul>
<LI><A href="node17.html#SECTION0017120000000000000000">15.1.2 Opzioni per utilizzare CherryPy direttamente</a>
<UL>
<LI><A href="node17.html#SECTION0017121000000000000000">15.1.2.1 Single thread/process</a>
<LI><A href="node17.html#SECTION0017122000000000000000">15.1.2.2 Forking server</a>
<LI><A href="node17.html#SECTION0017123000000000000000">15.1.2.3 Threading server</a>
<LI><A href="node17.html#SECTION0017124000000000000000">15.1.2.4 Process pool</a>
<LI><A href="node17.html#SECTION0017125000000000000000">15.1.2.5 Thread pool</a>
<LI><A href="node17.html#SECTION0017126000000000000000">15.1.2.6 Altre alternative</a>
</ul>
<LI><A href="node17.html#SECTION0017130000000000000000">15.1.3 Opzioni per utilizzare CherryPy dietro in altro webserver</a>
</ul>
<LI><A href="node17.html#SECTION0017200000000000000000">15.2 Opzioni del file di configurazione</a>
</ul>
<!--End of Table of Child-Links-->
<HR>

<H1><A NAME="SECTION0017000000000000000000">
15. Approntare il vostro sito per la produzione</A>
</H1>

<P>
Siete giunti ad avere un grosso sito su cui avete speso settimane di lavoro per approntarlo.
E siete finalmente pronti per farlo usare al mondo !

<P>
Ma state ancora decidendo come <b>utilizzarlo</b>, il che significa: come configurarlo per le macchine di produzione.

<P>

<H1><A NAME="SECTION0017100000000000000000">
15.1 Scelta della configurazione</A>
</H1>

<P>
Durante la fase di sviluppo del vostro sito, siete i soli (forse con qualche altro sviluppatore) ad accedere al sito, cos&#236; non &#232; necessario sia veloce e robusto. Ma ad un sito per la produzione accederanno molte persone (se siete fortunati). Il che comporta la scelta di una configurazione
del CherryPy appropriata in modo da provvedere un servizio veloce e costante ai vostri utenti.

<P>
Un criterio per aiutarvi a scegliere una configurazione, include:

<UL>
<LI><b>Cosa vi permette di fare il vostro hosting provider ?</b> Se usate una macchina condivisa,
potreste non poter fare cosa volete.
Per esempio, potreste solo poter usare CGI, e il vostro hosting provider potrebbe solo
provvedere un hosting virtuale basato su Apache.
</LI>
<LI><b>Quanto traffico prevedete di avere ?</b> Prevedete di avere solo qualche centinaio di utenti al giorno o alcune decine di migliaia ?
</LI>
<LI><b>Di quante macchine/processori disponete ? </b> Se prevedete di avere molto traffico, potrebbe essere meglio usare alcune macchine/processori  (che potrebbero avere un discreto costo).
</LI>
<LI><b>Avrete un webmaster per controllare il vostro sito ?</b> Se non avete nessuno che controlli il vostro sito, potreste volere che il sito riparta automaticamente in caso di crash.
</LI>
</UL>

<P>
<b>Notate che c'&#232; un HowTo chiamato "Sample deployment configuration for a
real-world website" che contiene un esempio completo di configurazione raccomandato per la maggior parte dei siti.</b>

<P>

<H2><A NAME="SECTION0017110000000000000000">
15.1.1 Dovrei usare CherryPy HTTP server direttamente o con un altro webserver come Apache ?</A>
</H2>
La prima decisione da prendere &#232; se usare CherryPy HTTP server direttamente o dietro in altro
webserver come Apache.
Ecco una lista di vantaggi per ogni metodo:

<H3><A NAME="SECTION0017111000000000000000">
15.1.1.1 Uso diretto</A>
</H3>

<UL>
<LI>E' pi&#249; veloce e usa meno risorse (nessun processo Apache e nessuna necessit&#224; di dialogo
tra Apache e CherryPy)
</LI>
<LI>E' facile da implementare
</LI>
</UL>
<H3><A NAME="SECTION0017112000000000000000">
15.1.1.2 Uso dietro Apache</A>
</H3>

<UL>
<LI>Potrebbe esser pi&#249; veloce per contenuti statici (come immagini)
</LI>
<LI>Hosting provider potrebbe forzare l'uso di Apache
</LI>
</UL>

<P>
Una volta deciso se usare CherryPy direttamente o dietro un altro webserver, dovrete decidere fra alcune configurazioni...

<P>

<H2><A NAME="SECTION0017120000000000000000">
15.1.2 Opzioni per utilizzare CherryPy direttamente</A>
</H2>
Le sezioni che seguono vi mostreranno le diverse opzioni e i loro vantaggi/svantaggi:

<H3><A NAME="SECTION0017121000000000000000">
15.1.2.1 Single thread/process</A>
</H3>
<b>Spiegazione</b>: il CherryPy HTTP server verr&#224; eseguito in solo thread/process. Durante l'esame di una richiesta, non ci possono essere altre connessioni.

<P>
Vantaggi:

<UL>
<LI>Velocit&#224; su ogni richiesta (nessuna necessit&#224; di creare un processo per ogni richiesta)
</LI>
</UL>
Svantaggi:

<UL>
<LI>Non possono essere esaminate richieste concorrenti
</LI>
</UL>
<b>Conclusione</b>: Questo &#232; il metodo di default e funziona bene per la fase di sviluppo,
ma dovrebbe essere vietata per la produzione se avrete diversi utenti che accedono al sito nello stesso momento.

<P>

<H3><A NAME="SECTION0017122000000000000000">
15.1.2.2 Forking server</A>
</H3>
<b>Spiegazione</b>: il CherryPy HTTP server creer&#224; un nuovo processo
per esaminare ogni richiesta. Dopo che &#232; stata inviata la risposta, il processo viene distrutto.

<P>
Vantaggi:

<UL>
<LI>Possibilit&#224; di esaminare richieste multiple allo stesso tempo.
</LI>
<LI>Su una macchina multiprocessore, un forking server trarr&#224;  vantaggio dai processori multipli.
</LI>
</UL>
Svantaggi:

<UL>
<LI>La creazione di un processo per ogni richiesta potrebbe prendere diverse risorse (specialmente se le richieste arrivano molto velocemente)
</LI>
<LI>Forking non funziona su Windows
</LI>
<LI>Non si possono usare le sessioni in modo semplice cos&#236; come non  si possono facilmente condividere session data tra processi.
</LI>
</UL>
<b>Conclusione</b>: Questo metodo pu&#242; essere usato su sistemi non-Windows se il traffico non &#232; molto elevato.

<P>

<H3><A NAME="SECTION0017123000000000000000">
15.1.2.3 Threading server</A>
</H3>
<b>Spiegazione</b>:  il CherryPy HTTP server creer&#224; un nuovo thread per esaminare ogni richiesta. Dopo la risposta, il thread &#232; distrutto.

<P>
Vantaggi:

<UL>
<LI>Possibilit&#224; di esaminare pi&#249; richieste alla volta
</LI>
<LI>Funziona su tutte le piattaforme (incluso Windows)
</LI>
</UL>
Svantaggi:

<UL>
<LI>Potrebbe essere dispendioso in fatto di risorse creare un nuovo thread per ogni richiesta (bench&#233; meno dispendioso rispetto ai processi) specialmente se le richieste arrivano molto velocemente
</LI>
<LI>Su macchine multiprocessore, un threading server <b>non</b> trarr&#224; vantaggio dai processori multipli ( a causa del global interpreter lock del Python)
</LI>
</UL>
<b>Conclusione</b>: Questo metodo pu&#242; essere usato per siti con un traffico non molto alto.

<P>

<H3><A NAME="SECTION0017124000000000000000">
15.1.2.4 Process pool</A>
</H3>
<b>Spiegazione</b>: in questo caso il CherryPy HTTP server creer&#224; un numero fissato di processi all'avvio i quali persisteranno tutto il tempo di vita del server. Se un processo &#232; occupato ad esaminare una richiesta e ne arriva un'altra, un altro processo si prender&#224; in carico l'esame di questa nuova richiesta.

<P>
Vantaggi:

<UL>
<LI>Possono essere esaminte pi&#249; richieste alla volta
</LI>
<LI>Veloce, dato che non c'&#232; bisogno di creare un thread o un processo per ogni richiesta
</LI>
<LI>Trae vantaggio da macchine multiprocessore
</LI>
</UL>
Svantaggi:

<UL>
<LI>Non funziona sotto Windows
</LI>
<LI>Non si possono usare le sessioni in modo semplice cos&#236; come non  si possono facilmente condividere session data tra processi.
</LI>
</UL>
<b>Conclusione</b>: Questo metodo funziona bene su macchine non-Windows a finch&#233; non arrivano
centinaia di utenti concorrenti.

<P>

<H3><A NAME="SECTION0017125000000000000000">
15.1.2.5 Thread pool</A>
</H3>
<b>Spiegazione</b>:  questo &#232; il caso un cui il CherryPy HTTP server creer&#224; un numero fissato di thread all'avvio e questi rimarrano attivi per tutto il tempo di vita del server. Se un thread
&#232; occupato ad esaminare una richiesta e arriva un'altra richiesta, questa viene presa in carico da un altro thread.

<P>
Vantaggi:

<UL>
<LI>Possono essere esaminate pi&#249; richieste alla volta
</LI>
<LI>Veloce, perch&#233; non sar&#224; creato un thread o un processo per ogni richiesta
</LI>
</UL>
Svantaggi:

<UL>
<LI>Non trae vantaggio da macchine multiprocessore
</LI>
<LI>Il numero dei thread non aumenta se abbiamo pi&#249; utenti concorrenti
</LI>
</UL>
<b>Conclusione</b>: Questo metodo funziona molto bene ed &#232; quello raccomandato in molti casi (finch&#233; non ci sono centinaia di utenti concorrenti).

<P>

<H3><A NAME="SECTION0017126000000000000000">
15.1.2.6 Altre alternative</A>
</H3>
Se avete <b>realmente</b> molto traffico e i metodi sin qui presentanti non sono sufficienti
o non potete usarli (se per esempio usate Windows), potete allora usare un generico load-balancing. C'&#232; un HowTo nella documentazione che ne parla.

<P>

<H2><A NAME="SECTION0017130000000000000000">
15.1.3 Opzioni per utilizzare CherryPy dietro in altro webserver</A>
</H2>
Tutte le configurazioni descritte nella precedente sezione sono disponibili anche utilizzando
CherryPy dietro un altro webserver. Webserver di terze parti sono generalmente
multi-thread o multi-processo. C'&#232; un HowTo nella documentazione che spiega la configurazione
in questo caso.

<P>

<H1><A NAME="SECTION0017200000000000000000">
15.2 Opzioni del file di configurazione</A>
</H1>
Segue una lista di opzioni che sono usate per specificare come sar&#224; utilizzato il CherryPy server. Tutte queste opzioni sono poste nella sezione <var>[server]</var> del file di configurazione. (confronta il capitolo "Configurare CherryPy").

<UL>
<LI><b>socketPort</b>: indica su che porta il server dovrebbe essere in ascolto: Per esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
</pre></div>
</LI>
<LI><b>socketHost</b>: indica l'indirizzo del server (di default &#232; localhost). Esempio:
<div class="verbatim"><pre>
[server]
socketHost=192.168.0.23
</pre></div>
</LI>
<LI><b>socketFile</b>: usata solo in Unix, se vogliamo usare un socket AF_UNIX invece di un
socket AF_INET. Esempio:
<div class="verbatim"><pre>
[server]
socketFile=/tmp/mySocket.soc
</pre></div>
</LI>
<LI><b>forking</b>: ponete questa a  1 se volete un forking server. Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
forking=1
</pre></div>
</LI>
<LI><b>threading</b>: ponete questa a 1 se volete un threading server. Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
threading=1
</pre></div>
</LI>
<LI><b>processPool</b>: ponete questa a n (n&gt;1) se volete creare n processi all'avvio del server. Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
processPool=10
</pre></div>
</LI>
<LI><b>threadPool</b>: ponete questa a n (n&gt;1) se volete creare n thread all'avvio del server. Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
threadPool=10
</pre></div>
</LI>
<LI><b>reverseDNS</b>: ponete questa a 1 se volete abilitare un reverse DNS (in questo modo il nome completo del dominio dei client sar&#224; scritto nei log). Di default &#232; 0. Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
reverseDNS=1
</pre></div>
</LI>
<LI><b>socketQueueSize</b>: dimensione della coda del socket (questo valore sar&#224; passato alla funzione listen()). Il default &#232; 5: Esempio:
<div class="verbatim"><pre>
[server]
socketPort=80
socketQueueSize=5
</pre></div>
</LI>
<LI><b>sslKeyFile e sslCertificateFile</b>:  usate se avete un server SSL. C'&#232; un HowTo nella documentazione per questo.
</LI>
<LI><b>xmlRpc</b>: usata se avete un server XML-RPC. C'&#232; un HowTo nella documentazione per questo.
</LI>
</UL>

<P>
Alcune di queste opzioni non possono ovviamente essere usate insieme altrimenti causerebbero un conflitto:

<UL>
<LI><b>socketFile</b> e <b>socketPort</b> ovviamente entrano in conflitto una con l'altra
</LI>
<LI><b>threading</b>, <b>forking</b>, <b>processPool</b> e <b>threadPool</b> entrano in conflitto tra loro
</LI>
</UL>

<P>

<DIV CLASS="navigation">
<p><hr>
<table align="center" width="100%" cellpadding="0" cellspacing="2">
<tr>
<td><A HREF="node16.html"><img src="../icons/previous.gif"
  border="0" height="32"
  alt="Previous Page" width="32"></A></td>
<td><A HREF="tut.html"><img src="../icons/up.gif"
  border="0" height="32"
  alt="Up One Level" width="32"></A></td>
<td><A HREF="node18.html"><img src="../icons/next.gif"
  border="0" height="32"
  alt="Next Page" width="32"></A></td>
<td align="center" width="100%">CherryPy Tutorial</td>
<td><A HREF="node2.html"><img src="../icons/contents.gif"
  border="0" height="32"
  alt="Contents" width="32"></A></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
<td><img src="../icons/blank.gif"
  border="0" height="32"
  alt="" width="32"></td>
</tr></table>
<b class="navlabel">Previous:</b> <a class="sectref" HREF="node16.html">14. Variabili e funzioni</A>
<b class="navlabel">Up:</b> <a class="sectref" HREF="tut.html">CherryPy Tutorial</A>
<b class="navlabel">Next:</b> <a class="sectref" HREF="node18.html">16. E poi ?</A>
<hr>
<span class="release-info">Release 0.10-beta, documentation updated on 14. gennaio 2004.</span>
</DIV>
<!--End of Navigation Panel-->
<ADDRESS>
See <i><a href="about.html">About this document...</a></i> for information on suggesting changes.
</ADDRESS>
</BODY>
</HTML>
