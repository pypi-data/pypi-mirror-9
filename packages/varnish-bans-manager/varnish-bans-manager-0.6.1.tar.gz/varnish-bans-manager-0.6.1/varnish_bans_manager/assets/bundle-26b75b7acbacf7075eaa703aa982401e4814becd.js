(function(c){var a={},b=0;c.fn.once=function(g,e){if(typeof g!="string"){if(!(g in a)){a[g]=++b}if(!e){e=g}g="jquery-once-"+a[g]}var d=g+"-processed";var f=this.not("."+d).addClass(d);return c.isFunction(e)?f.each(e):f};c.fn.removeOnce=function(g,e){var d=g+"-processed";var f=this.filter("."+d).removeClass(d);return c.isFunction(e)?f.each(e):f}})(jQuery);
/*
 * jQuery Form Plugin
 * version: 3.25.0-2013.01.18
 * @requires jQuery v1.5 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Project repository: https://github.com/malsup/form
 * Dual licensed under the MIT and GPL licenses:
 *    http://malsup.github.com/mit-license.txt
 *    http://malsup.github.com/gpl-license-v2.txt
 */
(function(e){var c={};c.fileapi=e("<input type='file'/>").get(0).files!==undefined;c.formdata=window.FormData!==undefined;e.fn.ajaxSubmit=function(h){if(!this.length){d("ajaxSubmit: skipping submit process - no element selected");return this}var g,y,j,m=this;if(typeof h=="function"){h={success:h}}g=this.attr("method");y=this.attr("action");j=(typeof y==="string")?e.trim(y):"";j=j||window.location.href||"";if(j){j=(j.match(/^([^#]+)/)||[])[1]}h=e.extend(true,{url:j,success:e.ajaxSettings.success,type:g||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},h);var s={};this.trigger("form-pre-serialize",[this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-pre-serialize trigger");return this}if(h.beforeSerialize&&h.beforeSerialize(this,h)===false){d("ajaxSubmit: submit aborted via beforeSerialize callback");return this}var l=h.traditional;if(l===undefined){l=e.ajaxSettings.traditional}var p=[];var B,C=this.formToArray(h.semantic,p);if(h.data){h.extraData=h.data;B=e.param(h.data,l)}if(h.beforeSubmit&&h.beforeSubmit(C,this,h)===false){d("ajaxSubmit: submit aborted via beforeSubmit callback");return this}this.trigger("form-submit-validate",[C,this,h,s]);if(s.veto){d("ajaxSubmit: submit vetoed via form-submit-validate trigger");return this}var w=e.param(C,l);if(B){w=(w?(w+"&"+B):B)}if(h.type.toUpperCase()=="GET"){h.url+=(h.url.indexOf("?")>=0?"&":"?")+w;h.data=null}else{h.data=w}var E=[];if(h.resetForm){E.push(function(){m.resetForm()})}if(h.clearForm){E.push(function(){m.clearForm(h.includeHidden)})}if(!h.dataType&&h.target){var i=h.success||function(){};E.push(function(q){var k=h.replaceTarget?"replaceWith":"html";e(h.target)[k](q).each(i,arguments)})}else{if(h.success){E.push(h.success)}}h.success=function(H,q,I){var G=h.context||this;for(var F=0,k=E.length;F<k;F++){E[F].apply(G,[H,q,I||m,m])}};var A=e('input[type=file]:enabled[value!=""]',this);var n=A.length>0;var z="multipart/form-data";var v=(m.attr("enctype")==z||m.attr("encoding")==z);var u=c.fileapi&&c.formdata;d("fileAPI :"+u);var o=(n||v)&&!u;var t;if(h.iframe!==false&&(h.iframe||o)){if(h.closeKeepAlive){e.get(h.closeKeepAlive,function(){t=D(C)})}else{t=D(C)}}else{if((n||v)&&u){t=r(C)}else{t=e.ajax(h)}}m.removeData("jqxhr").data("jqxhr",t);for(var x=0;x<p.length;x++){p[x]=null}this.trigger("form-submit-notify",[this,h]);return this;function f(H){var I=e.param(H).split("&");var q=I.length;var k={};var G,F;for(G=0;G<q;G++){I[G]=I[G].replace(/\+/g," ");F=I[G].split("=");k[decodeURIComponent(F[0])]=decodeURIComponent(F[1])}return k}function r(q){var k=new FormData();for(var F=0;F<q.length;F++){k.append(q[F].name,q[F].value)}if(h.extraData){var I=f(h.extraData);for(var J in I){if(I.hasOwnProperty(J)){k.append(J,I[J])}}}h.data=null;var H=e.extend(true,{},e.ajaxSettings,h,{contentType:false,processData:false,cache:false,type:g||"POST"});if(h.uploadProgress){H.xhr=function(){var K=jQuery.ajaxSettings.xhr();if(K.upload){K.upload.onprogress=function(O){var N=0;var L=O.loaded||O.position;var M=O.total;if(O.lengthComputable){N=Math.ceil(L/M*100)}h.uploadProgress(O,L,M,N)}}return K}}H.data=null;var G=H.beforeSend;H.beforeSend=function(L,K){K.data=k;if(G){G.call(this,L,K)}};return e.ajax(H)}function D(ad){var I=m[0],H,Z,T,ab,W,K,O,M,N,X,aa,R;var L=!!e.fn.prop;var ag=e.Deferred();if(e("[name=submit],[id=submit]",I).length){alert('Error: Form elements must not have name or id of "submit".');ag.reject();return ag}if(ad){for(Z=0;Z<p.length;Z++){H=e(p[Z]);if(L){H.prop("disabled",false)}else{H.removeAttr("disabled")}}}T=e.extend(true,{},e.ajaxSettings,h);T.context=T.context||T;W="jqFormIO"+(new Date().getTime());if(T.iframeTarget){K=e(T.iframeTarget);X=K.attr("name");if(!X){K.attr("name",W)}else{W=X}}else{K=e('<iframe name="'+W+'" src="'+T.iframeSrc+'" />');K.css({position:"absolute",top:"-1000px",left:"-1000px"})}O=K[0];M={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(ah){var ai=(ah==="timeout"?"timeout":"aborted");d("aborting upload... "+ai);this.aborted=1;try{if(O.contentWindow.document.execCommand){O.contentWindow.document.execCommand("Stop")}}catch(aj){}K.attr("src",T.iframeSrc);M.error=ai;if(T.error){T.error.call(T.context,M,ai,ah)}if(ab){e.event.trigger("ajaxError",[M,T,ai])}if(T.complete){T.complete.call(T.context,M,ai)}}};ab=T.global;if(ab&&0===e.active++){e.event.trigger("ajaxStart")}if(ab){e.event.trigger("ajaxSend",[M,T])}if(T.beforeSend&&T.beforeSend.call(T.context,M,T)===false){if(T.global){e.active--}ag.reject();return ag}if(M.aborted){ag.reject();return ag}N=I.clk;if(N){X=N.name;if(X&&!N.disabled){T.extraData=T.extraData||{};T.extraData[X]=N.value;if(N.type=="image"){T.extraData[X+".x"]=I.clk_x;T.extraData[X+".y"]=I.clk_y}}}var S=1;var P=2;function Q(ai){var ah=ai.contentWindow?ai.contentWindow.document:ai.contentDocument?ai.contentDocument:ai.document;return ah}var G=e("meta[name=csrf-token]").attr("content");var F=e("meta[name=csrf-param]").attr("content");if(F&&G){T.extraData=T.extraData||{};T.extraData[F]=G}function Y(){var aj=m.attr("target"),ah=m.attr("action");I.setAttribute("target",W);if(!g){I.setAttribute("method","POST")}if(ah!=T.url){I.setAttribute("action",T.url)}if(!T.skipEncodingOverride&&(!g||/post/i.test(g))){m.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"})}if(T.timeout){R=setTimeout(function(){aa=true;V(S)},T.timeout)}function ak(){try{var am=Q(O).readyState;d("state = "+am);if(am&&am.toLowerCase()=="uninitialized"){setTimeout(ak,50)}}catch(an){d("Server abort: ",an," (",an.name,")");V(P);if(R){clearTimeout(R)}R=undefined}}var ai=[];try{if(T.extraData){for(var al in T.extraData){if(T.extraData.hasOwnProperty(al)){if(e.isPlainObject(T.extraData[al])&&T.extraData[al].hasOwnProperty("name")&&T.extraData[al].hasOwnProperty("value")){ai.push(e('<input type="hidden" name="'+T.extraData[al].name+'">').val(T.extraData[al].value).appendTo(I)[0])}else{ai.push(e('<input type="hidden" name="'+al+'">').val(T.extraData[al]).appendTo(I)[0])}}}}if(!T.iframeTarget){K.appendTo("body");if(O.attachEvent){O.attachEvent("onload",V)}else{O.addEventListener("load",V,false)}}setTimeout(ak,15);I.submit()}finally{I.setAttribute("action",ah);if(aj){I.setAttribute("target",aj)}else{m.removeAttr("target")}e(ai).remove()}}if(T.forceSync){Y()}else{setTimeout(Y,10)}var ae,af,ac=50,J;function V(am){if(M.aborted||J){return}try{af=Q(O)}catch(ap){d("cannot access response document: ",ap);am=P}if(am===S&&M){M.abort("timeout");ag.reject(M,"timeout");return}else{if(am==P&&M){M.abort("server abort");ag.reject(M,"error","server abort");return}}if(!af||af.location.href==T.iframeSrc){if(!aa){return}}if(O.detachEvent){O.detachEvent("onload",V)}else{O.removeEventListener("load",V,false)}var ak="success",ao;try{if(aa){throw"timeout"}var aj=T.dataType=="xml"||af.XMLDocument||e.isXMLDoc(af);d("isXml="+aj);if(!aj&&window.opera&&(af.body===null||!af.body.innerHTML)){if(--ac){d("requeing onLoad callback, DOM not available");setTimeout(V,250);return}}var aq=af.body?af.body:af.documentElement;M.responseText=aq?aq.innerHTML:null;M.responseXML=af.XMLDocument?af.XMLDocument:af;if(aj){T.dataType="xml"}M.getResponseHeader=function(au){var at={"content-type":T.dataType};return at[au]};if(aq){M.status=Number(aq.getAttribute("status"))||M.status;M.statusText=aq.getAttribute("statusText")||M.statusText}var ah=(T.dataType||"").toLowerCase();var an=/(json|script|text)/.test(ah);if(an||T.textarea){var al=af.getElementsByTagName("textarea")[0];if(al){M.responseText=al.value;M.status=Number(al.getAttribute("status"))||M.status;M.statusText=al.getAttribute("statusText")||M.statusText}else{if(an){var ai=af.getElementsByTagName("pre")[0];var ar=af.getElementsByTagName("body")[0];if(ai){M.responseText=ai.textContent?ai.textContent:ai.innerText}else{if(ar){M.responseText=ar.textContent?ar.textContent:ar.innerText}}}}}else{if(ah=="xml"&&!M.responseXML&&M.responseText){M.responseXML=U(M.responseText)}}try{ae=k(M,ah,T)}catch(am){ak="parsererror";M.error=ao=(am||ak)}}catch(am){d("error caught: ",am);ak="error";M.error=ao=(am||ak)}if(M.aborted){d("upload aborted");ak=null}if(M.status){ak=(M.status>=200&&M.status<300||M.status===304)?"success":"error"}if(ak==="success"){if(T.success){T.success.call(T.context,ae,"success",M)}ag.resolve(M.responseText,"success",M);if(ab){e.event.trigger("ajaxSuccess",[M,T])}}else{if(ak){if(ao===undefined){ao=M.statusText}if(T.error){T.error.call(T.context,M,ak,ao)}ag.reject(M,"error",ao);if(ab){e.event.trigger("ajaxError",[M,T,ao])}}}if(ab){e.event.trigger("ajaxComplete",[M,T])}if(ab&&!--e.active){e.event.trigger("ajaxStop")}if(T.complete){T.complete.call(T.context,M,ak)}J=true;if(T.timeout){clearTimeout(R)}setTimeout(function(){if(!T.iframeTarget){K.remove()}M.responseXML=null},100)}var U=e.parseXML||function(ah,ai){if(window.ActiveXObject){ai=new ActiveXObject("Microsoft.XMLDOM");ai.async="false";ai.loadXML(ah)}else{ai=(new DOMParser()).parseFromString(ah,"text/xml")}return(ai&&ai.documentElement&&ai.documentElement.nodeName!="parsererror")?ai:null};var q=e.parseJSON||function(ah){return window["eval"]("("+ah+")")};var k=function(am,ak,aj){var ai=am.getResponseHeader("content-type")||"",ah=ak==="xml"||!ak&&ai.indexOf("xml")>=0,al=ah?am.responseXML:am.responseText;if(ah&&al.documentElement.nodeName==="parsererror"){if(e.error){e.error("parsererror")}}if(aj&&aj.dataFilter){al=aj.dataFilter(al,ak)}if(typeof al==="string"){if(ak==="json"||!ak&&ai.indexOf("json")>=0){al=q(al)}else{if(ak==="script"||!ak&&ai.indexOf("javascript")>=0){e.globalEval(al)}}}return al};return ag}};e.fn.ajaxForm=function(f){f=f||{};f.delegation=f.delegation&&e.isFunction(e.fn.on);if(!f.delegation&&this.length===0){var g={s:this.selector,c:this.context};if(!e.isReady&&g.s){d("DOM not ready, queuing ajaxForm");e(function(){e(g.s,g.c).ajaxForm(f)});return this}d("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)"));return this}if(f.delegation){e(document).off("submit.form-plugin",this.selector,b).off("click.form-plugin",this.selector,a).on("submit.form-plugin",this.selector,f,b).on("click.form-plugin",this.selector,f,a);return this}return this.ajaxFormUnbind().bind("submit.form-plugin",f,b).bind("click.form-plugin",f,a)};function b(g){var f=g.data;if(!g.isDefaultPrevented()){g.preventDefault();e(this).ajaxSubmit(f)}}function a(j){var i=j.target;var g=e(i);if(!(g.is("[type=submit],[type=image]"))){var f=g.closest("[type=submit]");if(f.length===0){return}i=f[0]}var h=this;h.clk=i;if(i.type=="image"){if(j.offsetX!==undefined){h.clk_x=j.offsetX;h.clk_y=j.offsetY}else{if(typeof e.fn.offset=="function"){var k=g.offset();h.clk_x=j.pageX-k.left;h.clk_y=j.pageY-k.top}else{h.clk_x=j.pageX-i.offsetLeft;h.clk_y=j.pageY-i.offsetTop}}}setTimeout(function(){h.clk=h.clk_x=h.clk_y=null},100)}e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};e.fn.formToArray=function(w,f){var u=[];if(this.length===0){return u}var k=this[0];var o=w?k.getElementsByTagName("*"):k.elements;if(!o){return u}var q,p,m,x,l,s,h;for(q=0,s=o.length;q<s;q++){l=o[q];m=l.name;if(!m){continue}if(w&&k.clk&&l.type=="image"){if(!l.disabled&&k.clk==l){u.push({name:m,value:e(l).val(),type:l.type});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}continue}x=e.fieldValue(l,true);if(x&&x.constructor==Array){if(f){f.push(l)}for(p=0,h=x.length;p<h;p++){u.push({name:m,value:x[p]})}}else{if(c.fileapi&&l.type=="file"&&!l.disabled){if(f){f.push(l)}var g=l.files;if(g.length){for(p=0;p<g.length;p++){u.push({name:m,value:g[p],type:l.type})}}else{u.push({name:m,value:"",type:l.type})}}else{if(x!==null&&typeof x!="undefined"){if(f){f.push(l)}u.push({name:m,value:x,type:l.type,required:l.required})}}}}if(!w&&k.clk){var r=e(k.clk),t=r[0];m=t.name;if(m&&!t.disabled&&t.type=="image"){u.push({name:m,value:r.val()});u.push({name:m+".x",value:k.clk_x},{name:m+".y",value:k.clk_y})}}return u};e.fn.formSerialize=function(f){return e.param(this.formToArray(f))};e.fn.fieldSerialize=function(g){var f=[];this.each(function(){var l=this.name;if(!l){return}var j=e.fieldValue(this,g);if(j&&j.constructor==Array){for(var k=0,h=j.length;k<h;k++){f.push({name:l,value:j[k]})}}else{if(j!==null&&typeof j!="undefined"){f.push({name:this.name,value:j})}}});return e.param(f)};e.fn.fieldValue=function(l){for(var k=[],h=0,f=this.length;h<f;h++){var j=this[h];var g=e.fieldValue(j,l);if(g===null||typeof g=="undefined"||(g.constructor==Array&&!g.length)){continue}if(g.constructor==Array){e.merge(k,g)}else{k.push(g)}}return k};e.fieldValue=function(f,m){var h=f.name,s=f.type,u=f.tagName.toLowerCase();if(m===undefined){m=true}if(m&&(!h||f.disabled||s=="reset"||s=="button"||(s=="checkbox"||s=="radio")&&!f.checked||(s=="submit"||s=="image")&&f.form&&f.form.clk!=f||u=="select"&&f.selectedIndex==-1)){return null}if(u=="select"){var o=f.selectedIndex;if(o<0){return null}var q=[],g=f.options;var k=(s=="select-one");var p=(k?o+1:g.length);for(var j=(k?o:0);j<p;j++){var l=g[j];if(l.selected){var r=l.value;if(!r){r=(l.attributes&&l.attributes.value&&!(l.attributes.value.specified))?l.text:l.value}if(k){return r}q.push(r)}}return q}return e(f).val()};e.fn.clearForm=function(f){return this.each(function(){e("input,select,textarea",this).clearFields(f)})};e.fn.clearFields=e.fn.clearInputs=function(f){var g=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,h=this.tagName.toLowerCase();if(g.test(i)||h=="textarea"){this.value=""}else{if(i=="checkbox"||i=="radio"){this.checked=false}else{if(h=="select"){this.selectedIndex=-1}else{if(i=="file"){if(/MSIE/.test(navigator.userAgent)){e(this).replaceWith(e(this).clone())}else{e(this).val("")}}else{if(f){if((f===true&&/hidden/.test(i))||(typeof f=="string"&&e(this).is(f))){this.value=""}}}}}}})};e.fn.resetForm=function(){return this.each(function(){if(typeof this.reset=="function"||(typeof this.reset=="object"&&!this.reset.nodeType)){this.reset()}})};e.fn.enable=function(f){if(f===undefined){f=true}return this.each(function(){this.disabled=!f})};e.fn.selected=function(f){if(f===undefined){f=true}return this.each(function(){var g=this.type;if(g=="checkbox"||g=="radio"){this.checked=f}else{if(this.tagName.toLowerCase()=="option"){var h=e(this).parent("select");if(f&&h[0]&&h[0].type=="select-one"){h.find("option").selected(false)}this.selected=f}}})};e.fn.ajaxSubmit.debug=false;function d(){if(!e.fn.ajaxSubmit.debug){return}var f="[jquery.form] "+Array.prototype.join.call(arguments,"");if(window.console&&window.console.log){window.console.log(f)}else{if(window.opera&&window.opera.postError){window.opera.postError(f)}}}})(jQuery);(function(a){a.widget("ech.notify",{options:{speed:500,expires:5000,stack:"below",custom:false,queue:false},_create:function(){var b=this;this.templates={};this.keys=[];this.element.addClass("ui-notify").children().addClass("ui-notify-message ui-notify-message-style").each(function(d){var c=this.id||d;b.keys.push(c);b.templates[c]=a(this).removeAttr("id").wrap("<div></div>").parent().html()}).end().empty().show()},create:function(c,e,d){if(typeof c==="object"){d=e;e=c;c=null}var b=this.templates[c||this.keys[0]];if(d&&d.custom){b=a(b).removeClass("ui-notify-message-style").wrap("<div></div>").parent().html()}this.openNotifications=this.openNotifications||0;return new a.ech.notify.instance(this)._create(e,a.extend({},this.options,d),b)}});a.extend(a.ech.notify,{instance:function(b){this.__super=b;this.isOpen=false}});a.extend(a.ech.notify.instance.prototype,{_create:function(h,e,g){this.options=e;var d=this,f=g.replace(/#(?:\{|%7B)(.*?)(?:\}|%7D)/g,function(i,j){return(j in h)?h[j]:""}),c=(this.element=a(f)),b=c.find(".ui-notify-close");if(typeof this.options.click==="function"){c.addClass("ui-notify-click").bind("click",function(i){d._trigger("click",i,d)})}if(b.length){b.bind("click",function(){d.close();return false})}this.__super.element.queue("notify",function(){d.open();if(typeof e.expires==="number"&&e.expires>0){setTimeout(a.proxy(d.close,d),e.expires)}});if(!this.options.queue||this.__super.openNotifications<=this.options.queue-1){this.__super.element.dequeue("notify")}return this},close:function(){var b=this.options.speed;this.element.fadeTo(b,0).slideUp(b,a.proxy(function(){this._trigger("close");this.isOpen=false;this.element.remove();this.__super.openNotifications-=1;this.__super.element.dequeue("notify")},this));return this},open:function(){if(this.isOpen||this._trigger("beforeopen")===false){return this}var b=this;this.__super.openNotifications+=1;this.element[this.options.stack==="above"?"prependTo":"appendTo"](this.__super.element).css({display:"none",opacity:""}).fadeIn(this.options.speed,function(){b._trigger("open");b.isOpen=true});return this},widget:function(){return this.element},_trigger:function(c,d,b){return this.__super._trigger.call(this,c,d,b)}})})(jQuery);(function(b,d){var a=b.History=b.History||{},c=b.jQuery;if(typeof a.Adapter!=="undefined"){throw new Error("History.js Adapter has already been loaded...")}a.Adapter={bind:function(e,f,g){c(e).bind(f,g)},trigger:function(f,g,e){c(f).trigger(g,e)},extractEventData:function(g,h,f){var e=(h&&h.originalEvent&&h.originalEvent[g])||(f&&f[g])||d;return e},onDomLoad:function(e){c(e)}};if(typeof a.init!=="undefined"){a.init()}})(window);(function(g,a){var d=g.console||a,i=g.document,l=g.navigator,k=g.sessionStorage||false,c=g.setTimeout,j=g.clearTimeout,e=g.setInterval,n=g.clearInterval,m=g.JSON,h=g.alert,b=g.History=g.History||{},f=g.history;m.stringify=m.stringify||m.encode;m.parse=m.parse||m.decode;if(typeof b.init!=="undefined"){throw new Error("History.js Core has already been loaded...")}b.init=function(){if(typeof b.Adapter==="undefined"){return false}if(typeof b.initCore!=="undefined"){b.initCore()}if(typeof b.initHtml4!=="undefined"){b.initHtml4()}return true};b.initCore=function(){if(typeof b.initCore.initialized!=="undefined"){return false}else{b.initCore.initialized=true}b.options=b.options||{};b.options.hashChangeInterval=b.options.hashChangeInterval||100;b.options.safariPollInterval=b.options.safariPollInterval||500;b.options.doubleCheckInterval=b.options.doubleCheckInterval||500;b.options.storeInterval=b.options.storeInterval||1000;b.options.busyDelay=b.options.busyDelay||250;b.options.debug=b.options.debug||false;b.options.initialTitle=b.options.initialTitle||i.title;b.intervalList=[];b.clearAllIntervals=function(){var r,q=b.intervalList;if(typeof q!=="undefined"&&q!==null){for(r=0;r<q.length;r++){n(q[r])}b.intervalList=null}};b.debug=function(){if((b.options.debug||false)){b.log.apply(b,arguments)}};b.log=function(){var w=!(typeof d==="undefined"||typeof d.log==="undefined"||typeof d.log.apply==="undefined"),r=i.getElementById("log"),v,u,x,s,q;if(w){s=Array.prototype.slice.call(arguments);v=s.shift();if(typeof d.debug!=="undefined"){d.debug.apply(d,[v,s])}else{d.log.apply(d,[v,s])}}else{v=("\n"+arguments[0]+"\n")}for(u=1,x=arguments.length;u<x;++u){q=arguments[u];if(typeof q==="object"&&typeof m!=="undefined"){try{q=m.stringify(q)}catch(t){}}v+="\n"+q+"\n"}if(r){r.value+=v+"\n-----\n";r.scrollTop=r.scrollHeight-r.clientHeight}else{if(!w){h(v)}}return true};b.getInternetExplorerMajorVersion=function(){var q=b.getInternetExplorerMajorVersion.cached=(typeof b.getInternetExplorerMajorVersion.cached!=="undefined")?b.getInternetExplorerMajorVersion.cached:(function(){var r=3,t=i.createElement("div"),s=t.getElementsByTagName("i");while((t.innerHTML="<!--[if gt IE "+(++r)+"]><i></i><![endif]-->")&&s[0]){}return(r>4)?r:false})();return q};b.isInternetExplorer=function(){var q=b.isInternetExplorer.cached=(typeof b.isInternetExplorer.cached!=="undefined")?b.isInternetExplorer.cached:Boolean(b.getInternetExplorerMajorVersion());return q};b.emulated={pushState:!Boolean(g.history&&g.history.pushState&&g.history.replaceState&&!((/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i).test(l.userAgent)||(/AppleWebKit\/5([0-2]|3[0-2])/i).test(l.userAgent))),hashChange:Boolean(!(("onhashchange" in g)||("onhashchange" in i))||(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8))};b.enabled=!b.emulated.pushState;b.bugs={setHash:Boolean(!b.emulated.pushState&&l.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(l.userAgent)),safariPoll:Boolean(!b.emulated.pushState&&l.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(l.userAgent)),ieDoubleCheck:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<7)};b.isEmptyObject=function(r){for(var q in r){return false}return true};b.cloneObject=function(s){var r,q;if(s){r=m.stringify(s);q=m.parse(r)}else{q={}}return q};b.getRootUrl=function(){var q=i.location.protocol+"//"+(i.location.hostname||i.location.host);if(i.location.port||false){q+=":"+i.location.port}q+="/";return q};b.getBaseHref=function(){var q=i.getElementsByTagName("base"),s=null,r="";if(q.length===1){s=q[0];r=s.href.replace(/[^\/]+$/,"")}r=r.replace(/\/+$/,"");if(r){r+="/"}return r};b.getBaseUrl=function(){var q=b.getBaseHref()||b.getBasePageUrl()||b.getRootUrl();return q};b.getPageUrl=function(){var q=b.getState(false,false),s=(q||{}).url||i.location.href,r;r=s.replace(/\/+$/,"").replace(/[^\/]+$/,function(v,u,t){return(/\./).test(v)?v:v+"/"});return r};b.getBasePageUrl=function(){var q=i.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(t,s,r){return(/[^\/]$/).test(t)?"":t}).replace(/\/+$/,"")+"/";return q};b.getFullUrl=function(r,t){var q=r,s=r.substring(0,1);t=(typeof t==="undefined")?true:t;if(/[a-z]+\:\/\//.test(r)){}else{if(s==="/"){q=b.getRootUrl()+r.replace(/^\/+/,"")}else{if(s==="#"){q=b.getPageUrl().replace(/#.*/,"")+r}else{if(s==="?"){q=b.getPageUrl().replace(/[\?#].*/,"")+r}else{if(t){q=b.getBaseUrl()+r.replace(/^(\.\/)+/,"")}else{q=b.getBasePageUrl()+r.replace(/^(\.\/)+/,"")}}}}}return q.replace(/\#$/,"")};b.getShortUrl=function(s){var r=s,t=b.getBaseUrl(),q=b.getRootUrl();if(b.emulated.pushState){r=r.replace(t,"")}r=r.replace(q,"/");if(b.isTraditionalAnchor(r)){r="./"+r}r=r.replace(/^(\.\/)+/g,"./").replace(/\#$/,"");return r};b.store={};b.idToState=b.idToState||{};b.stateToId=b.stateToId||{};b.urlToId=b.urlToId||{};b.storedStates=b.storedStates||[];b.savedStates=b.savedStates||[];b.normalizeStore=function(){b.store.idToState=b.store.idToState||{};b.store.urlToId=b.store.urlToId||{};b.store.stateToId=b.store.stateToId||{}};b.getState=function(s,r){if(typeof s==="undefined"){s=true}if(typeof r==="undefined"){r=true}var q=b.getLastSavedState();if(!q&&r){q=b.createStateObject()}if(s){q=b.cloneObject(q);q.url=q.cleanUrl||q.url}return q};b.getIdByState=function(q){var s=b.extractId(q.url),r;if(!s){r=b.getStateString(q);if(typeof b.stateToId[r]!=="undefined"){s=b.stateToId[r]}else{if(typeof b.store.stateToId[r]!=="undefined"){s=b.store.stateToId[r]}else{while(true){s=(new Date()).getTime()+String(Math.random()).replace(/\D/g,"");if(typeof b.idToState[s]==="undefined"&&typeof b.store.idToState[s]==="undefined"){break}}b.stateToId[r]=s;b.idToState[s]=q}}}return s};b.normalizeState=function(r){var s,q;if(!r||(typeof r!=="object")){r={}}if(typeof r.normalized!=="undefined"){return r}if(!r.data||(typeof r.data!=="object")){r.data={}}s={};s.normalized=true;s.title=r.title||"";s.url=b.getFullUrl(b.unescapeString(r.url||i.location.href));s.hash=b.getShortUrl(s.url);s.data=b.cloneObject(r.data);s.id=b.getIdByState(s);s.cleanUrl=s.url.replace(/\??\&_suid.*/,"");s.url=s.cleanUrl;q=!b.isEmptyObject(s.data);if(s.title||q){s.hash=b.getShortUrl(s.url).replace(/\??\&_suid.*/,"");if(!/\?/.test(s.hash)){s.hash+="?"}s.hash+="&_suid="+s.id}s.hashedUrl=b.getFullUrl(s.hash);if((b.emulated.pushState||b.bugs.safariPoll)&&b.hasUrlDuplicate(s)){s.url=s.hashedUrl}return s};b.createStateObject=function(s,t,r){var q={data:s,title:t,url:r};q=b.normalizeState(q);return q};b.getStateById=function(r){r=String(r);var q=b.idToState[r]||b.store.idToState[r]||a;return q};b.getStateString=function(r){var q,s,t;q=b.normalizeState(r);s={data:q.data,title:r.title,url:r.url};t=m.stringify(s);return t};b.getStateId=function(r){var q,s;q=b.normalizeState(r);s=q.id;return s};b.getHashByState=function(r){var q,s;q=b.normalizeState(r);s=q.hash;return s};b.extractId=function(s){var t,r,q;r=/(.*)\&_suid=([0-9]+)$/.exec(s);q=r?(r[1]||s):s;t=r?String(r[2]||""):"";return t||false};b.isTraditionalAnchor=function(r){var q=!(/[\/\?\.]/.test(r));return q};b.extractState=function(t,s){var q=null,u,r;s=s||false;u=b.extractId(t);if(u){q=b.getStateById(u)}if(!q){r=b.getFullUrl(t);u=b.getIdByUrl(r)||false;if(u){q=b.getStateById(u)}if(!q&&s&&!b.isTraditionalAnchor(t)){q=b.createStateObject(null,null,r)}}return q};b.getIdByUrl=function(q){var r=b.urlToId[q]||b.store.urlToId[q]||a;return r};b.getLastSavedState=function(){return b.savedStates[b.savedStates.length-1]||a};b.getLastStoredState=function(){return b.storedStates[b.storedStates.length-1]||a};b.hasUrlDuplicate=function(s){var r=false,q;q=b.extractState(s.url);r=q&&q.id!==s.id;return r};b.storeState=function(q){b.urlToId[q.url]=q.id;b.storedStates.push(b.cloneObject(q));return q};b.isLastSavedState=function(t){var s=false,r,q,u;if(b.savedStates.length){r=t.id;q=b.getLastSavedState();u=q.id;s=(r===u)}return s};b.saveState=function(q){if(b.isLastSavedState(q)){return false}b.savedStates.push(b.cloneObject(q));return true};b.getStateByIndex=function(r){var q=null;if(typeof r==="undefined"){q=b.savedStates[b.savedStates.length-1]}else{if(r<0){q=b.savedStates[b.savedStates.length+r]}else{q=b.savedStates[r]}}return q};b.getHash=function(){var q=b.unescapeHash(i.location.hash);return q};b.unescapeString=function(s){var q=s,r;while(true){r=g.unescape(q);if(r===q){break}q=r}return q};b.unescapeHash=function(r){var q=b.normalizeHash(r);q=b.unescapeString(q);return q};b.normalizeHash=function(r){var q=r.replace(/[^#]*#/,"").replace(/#.*/,"");return q};b.setHash=function(u,r){var q,s,t;if(r!==false&&b.busy()){b.pushQueue({scope:b,callback:b.setHash,args:arguments,queue:r});return false}q=b.escapeHash(u);b.busy(true);s=b.extractState(u,true);if(s&&!b.emulated.pushState){b.pushState(s.data,s.title,s.url,false)}else{if(i.location.hash!==q){if(b.bugs.setHash){t=b.getPageUrl();b.pushState(null,null,t+"#"+q,false)}else{i.location.hash=q}}}return b};b.escapeHash=function(r){var q=b.normalizeHash(r);q=g.escape(q);if(!b.bugs.hashEscape){q=q.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")}return q};b.getHashByUrl=function(q){var r=String(q).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");r=b.unescapeHash(r);return r};b.setTitle=function(s){var t=s.title,r;if(!t){r=b.getStateByIndex(0);if(r&&r.url===s.url){t=r.title||b.options.initialTitle}}try{i.getElementsByTagName("title")[0].innerHTML=t.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(q){}i.title=t;return b};b.queues=[];b.busy=function(r){if(typeof r!=="undefined"){b.busy.flag=r}else{if(typeof b.busy.flag==="undefined"){b.busy.flag=false}}if(!b.busy.flag){j(b.busy.timeout);var q=function(){var t,s,u;if(b.busy.flag){return}for(t=b.queues.length-1;t>=0;--t){s=b.queues[t];if(s.length===0){continue}u=s.shift();b.fireQueueItem(u);b.busy.timeout=c(q,b.options.busyDelay)}};b.busy.timeout=c(q,b.options.busyDelay)}return b.busy.flag};b.busy.flag=false;b.fireQueueItem=function(q){return q.callback.apply(q.scope||b,q.args||[])};b.pushQueue=function(q){b.queues[q.queue||0]=b.queues[q.queue||0]||[];b.queues[q.queue||0].push(q);return b};b.queue=function(r,q){if(typeof r==="function"){r={callback:r}}if(typeof q!=="undefined"){r.queue=q}if(b.busy()){b.pushQueue(r)}else{b.fireQueueItem(r)}return b};b.clearQueue=function(){b.busy.flag=false;b.queues=[];return b};b.stateChanged=false;b.doubleChecker=false;b.doubleCheckComplete=function(){b.stateChanged=true;b.doubleCheckClear();return b};b.doubleCheckClear=function(){if(b.doubleChecker){j(b.doubleChecker);b.doubleChecker=false}return b};b.doubleCheck=function(q){b.stateChanged=false;b.doubleCheckClear();if(b.bugs.ieDoubleCheck){b.doubleChecker=c(function(){b.doubleCheckClear();if(!b.stateChanged){q()}return true},b.options.doubleCheckInterval)}return b};b.safariStatePoll=function(){var r=b.extractState(i.location.href),q;if(!b.isLastSavedState(r)){q=r}else{return}if(!q){q=b.createStateObject()}b.Adapter.trigger(g,"popstate");return b};b.back=function(q){if(q!==false&&b.busy()){b.pushQueue({scope:b,callback:b.back,args:arguments,queue:q});return false}b.busy(true);b.doubleCheck(function(){b.back(false)});f.go(-1);return true};b.forward=function(q){if(q!==false&&b.busy()){b.pushQueue({scope:b,callback:b.forward,args:arguments,queue:q});return false}b.busy(true);b.doubleCheck(function(){b.forward(false)});f.go(1);return true};b.go=function(r,q){var s;if(r>0){for(s=1;s<=r;++s){b.forward(q)}}else{if(r<0){for(s=-1;s>=r;--s){b.back(q)}}else{throw new Error("History.go: History.go requires a positive or negative integer passed.")}}return b};if(b.emulated.pushState){var p=function(){};b.pushState=b.pushState||p;b.replaceState=b.replaceState||p}else{b.onPopState=function(t,q){var v=false,u=false,s,r;b.doubleCheckComplete();s=b.getHash();if(s){r=b.extractState(s||i.location.href,true);if(r){b.replaceState(r.data,r.title,r.url,false)}else{b.Adapter.trigger(g,"anchorchange");b.busy(false)}b.expectedStateId=false;return false}v=b.Adapter.extractEventData("state",t,q)||false;if(v){u=b.getStateById(v)}else{if(b.expectedStateId){u=b.getStateById(b.expectedStateId)}else{u=b.extractState(i.location.href)}}if(!u){u=b.createStateObject(null,null,i.location.href)}b.expectedStateId=false;if(b.isLastSavedState(u)){b.busy(false);return false}b.storeState(u);b.saveState(u);b.setTitle(u);b.Adapter.trigger(g,"statechange");b.busy(false);return true};b.Adapter.bind(g,"popstate",b.onPopState);b.pushState=function(s,u,r,q){if(b.getHashByUrl(r)&&b.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(q!==false&&b.busy()){b.pushQueue({scope:b,callback:b.pushState,args:arguments,queue:q});return false}b.busy(true);var t=b.createStateObject(s,u,r);if(b.isLastSavedState(t)){b.busy(false)}else{b.storeState(t);b.expectedStateId=t.id;f.pushState(t.id,t.title,t.url);b.Adapter.trigger(g,"popstate")}return true};b.replaceState=function(s,u,r,q){if(b.getHashByUrl(r)&&b.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(q!==false&&b.busy()){b.pushQueue({scope:b,callback:b.replaceState,args:arguments,queue:q});return false}b.busy(true);var t=b.createStateObject(s,u,r);if(b.isLastSavedState(t)){b.busy(false)}else{b.storeState(t);b.expectedStateId=t.id;f.replaceState(t.id,t.title,t.url);b.Adapter.trigger(g,"popstate")}return true}}if(k){try{b.store=m.parse(k.getItem("History.store"))||{}}catch(o){b.store={}}b.normalizeStore()}else{b.store={};b.normalizeStore()}b.Adapter.bind(g,"beforeunload",b.clearAllIntervals);b.Adapter.bind(g,"unload",b.clearAllIntervals);b.saveState(b.storeState(b.extractState(i.location.href,true)));if(k){b.onUnload=function(){var q,s;try{q=m.parse(k.getItem("History.store"))||{}}catch(r){q={}}q.idToState=q.idToState||{};q.urlToId=q.urlToId||{};q.stateToId=q.stateToId||{};for(s in b.idToState){if(!b.idToState.hasOwnProperty(s)){continue}q.idToState[s]=b.idToState[s]}for(s in b.urlToId){if(!b.urlToId.hasOwnProperty(s)){continue}q.urlToId[s]=b.urlToId[s]}for(s in b.stateToId){if(!b.stateToId.hasOwnProperty(s)){continue}q.stateToId[s]=b.stateToId[s]}b.store=q;b.normalizeStore();k.setItem("History.store",m.stringify(q))};b.intervalList.push(e(b.onUnload,b.options.storeInterval));b.Adapter.bind(g,"beforeunload",b.onUnload);b.Adapter.bind(g,"unload",b.onUnload)}if(!b.emulated.pushState){if(b.bugs.safariPoll){b.intervalList.push(e(b.safariStatePoll,b.options.safariPollInterval))}if(l.vendor==="Apple Computer, Inc."||(l.appCodeName||"")==="Mozilla"){b.Adapter.bind(g,"hashchange",function(){b.Adapter.trigger(g,"popstate")});if(b.getHash()){b.Adapter.onDomLoad(function(){b.Adapter.trigger(g,"hashchange")})}}}};b.init()})(window);(function(d,g){var a=d.document,e=d.setTimeout||e,f=d.clearTimeout||f,b=d.setInterval||b,c=d.History=d.History||{};if(typeof c.initHtml4!=="undefined"){throw new Error("History.js HTML4 Support has already been loaded...")}c.initHtml4=function(){if(typeof c.initHtml4.initialized!=="undefined"){return false}else{c.initHtml4.initialized=true}c.enabled=true;c.savedHashes=[];c.isLastHash=function(h){var j=c.getHashByIndex(),i;i=h===j;return i};c.saveHash=function(h){if(c.isLastHash(h)){return false}c.savedHashes.push(h);return true};c.getHashByIndex=function(h){var i=null;if(typeof h==="undefined"){i=c.savedHashes[c.savedHashes.length-1]}else{if(h<0){i=c.savedHashes[c.savedHashes.length+h]}else{i=c.savedHashes[h]}}return i};c.discardedHashes={};c.discardedStates={};c.discardState=function(l,h,k){var i=c.getHashByState(l),j;j={discardedState:l,backState:k,forwardState:h};c.discardedStates[i]=j;return true};c.discardHash=function(i,h,k){var j={discardedHash:i,backState:k,forwardState:h};c.discardedHashes[i]=j;return true};c.discardedState=function(h){var j=c.getHashByState(h),i;i=c.discardedStates[j]||false;return i};c.discardedHash=function(i){var h=c.discardedHashes[i]||false;return h};c.recycleState=function(h){var i=c.getHashByState(h);if(c.discardedState(h)){delete c.discardedStates[i]}return true};if(c.emulated.hashChange){c.hashChangeInit=function(){c.checkerFunction=null;var h="",l,i,j,k;if(c.isInternetExplorer()){l="historyjs-iframe";i=a.createElement("iframe");i.setAttribute("id",l);i.style.display="none";a.body.appendChild(i);i.contentWindow.document.open();i.contentWindow.document.close();j="";k=false;c.checkerFunction=function(){if(k){return false}k=true;var n=c.getHash()||"",m=c.unescapeHash(i.contentWindow.document.location.hash)||"";if(n!==h){h=n;if(m!==n){j=m=n;i.contentWindow.document.open();i.contentWindow.document.close();i.contentWindow.document.location.hash=c.escapeHash(n)}c.Adapter.trigger(d,"hashchange")}else{if(m!==j){j=m;c.setHash(m,false)}}k=false;return true}}else{c.checkerFunction=function(){var m=c.getHash();if(m!==h){h=m;c.Adapter.trigger(d,"hashchange")}return true}}c.intervalList.push(b(c.checkerFunction,c.options.hashChangeInterval));return true};c.Adapter.onDomLoad(c.hashChangeInit)}if(c.emulated.pushState){c.onHashChange=function(l){var m=((l&&l.newURL)||a.location.href),k=c.getHashByUrl(m),j=null,h=null,n=null,i;if(c.isLastHash(k)){c.busy(false);return false}c.doubleCheckComplete();c.saveHash(k);if(k&&c.isTraditionalAnchor(k)){c.Adapter.trigger(d,"anchorchange");c.busy(false);return false}j=c.extractState(c.getFullUrl(k||a.location.href,false),true);if(c.isLastSavedState(j)){c.busy(false);return false}h=c.getHashByState(j);i=c.discardedState(j);if(i){if(c.getHashByIndex(-2)===c.getHashByState(i.forwardState)){c.back(false)}else{c.forward(false)}return false}c.pushState(j.data,j.title,j.url,false);return true};c.Adapter.bind(d,"hashchange",c.onHashChange);c.pushState=function(l,p,h,n){if(c.getHashByUrl(h)){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(n!==false&&c.busy()){c.pushQueue({scope:c,callback:c.pushState,args:arguments,queue:n});return false}c.busy(true);var k=c.createStateObject(l,p,h),i=c.getHashByState(k),j=c.getState(false),m=c.getHashByState(j),o=c.getHash();c.storeState(k);c.expectedStateId=k.id;c.recycleState(k);c.setTitle(k);if(i===m){c.busy(false);return false}if(i!==o&&i!==c.getShortUrl(a.location.href)){c.setHash(i,false);return false}c.saveState(k);c.Adapter.trigger(d,"statechange");c.busy(false);return true};c.replaceState=function(l,n,k,h){if(c.getHashByUrl(k)){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")}if(h!==false&&c.busy()){c.pushQueue({scope:c,callback:c.replaceState,args:arguments,queue:h});return false}c.busy(true);var m=c.createStateObject(l,n,k),j=c.getState(false),i=c.getStateByIndex(-2);c.discardState(j,m,i);c.pushState(m.data,m.title,m.url,false);return true}}if(c.emulated.pushState){if(c.getHash()&&!c.emulated.hashChange){c.Adapter.onDomLoad(function(){c.Adapter.trigger(d,"hashchange")})}}};if(typeof c.init!=="undefined"){c.init()}})(window);(function(a){vbm.attach_behaviors=function(b){b=b||document;a.each(vbm.behaviors,function(){if(a.isFunction(this.attach)){this.attach(b)}})};vbm.detach_behaviors=function(b){b=b||document;a.each(vbm.behaviors,function(){if(a.isFunction(this.detach)){this.detach(b)}})};vbm.execute_commands=function(b,e,c){e=e||this;c=a.extend({},vbm.commands,c);b.sort(function(h,g){return h.weight-g.weight});var f=false;for(var d in b){if(b[d]["cmd"]&&b[d]["args"]&&c[b[d]["cmd"]]){f=c[b[d]["cmd"]].apply(e,b[d]["args"])||f}}return f};vbm.ready=function(e,b,c){function d(i,f,g,h){if((typeof(f)=="function")&&(f()===false)){window.setTimeout(function(){d(i,f,g,h)},100)}else{if(vbm.client.browser.ie>=1&&vbm.client.browser.ie<=9){i(a(document))}else{i(h)}if(typeof(g)=="function"){vbm.unload(g(h))}}}if(!vbm.behaviors.ready){vbm.behaviors.ready={callbacks:[],attach:function(f){a(document).ready(function(){var h=vbm.behaviors.ready.callbacks;delete vbm.behaviors.ready;for(var g=0;g<h.length;g++){d(h[g]["callback"],h[g]["is_ready"],h[g]["unloader"],f)}})}}}vbm.behaviors.ready.callbacks.push({callback:e,is_ready:b,unloader:c})};vbm.unload=function(b){if(!vbm.behaviors.unload){vbm.behaviors.unload={callbacks:[],attach:function(c){},detach:function(d){for(var c=0;c<vbm.behaviors.unload.callbacks.length;c++){var e=vbm.behaviors.unload.callbacks[c];if(e(d)){vbm.behaviors.unload.callbacks.splice(c,1);c--}}if(vbm.behaviors.unload.callbacks.length===0){delete vbm.behaviors.unload}}}}vbm.behaviors.unload.callbacks.push(b)};vbm.modal={open:function(b){vbm.modal.close_all();a("#overlay").append(b);vbm.attach_behaviors(b.show());b.on("hidden",function(){vbm.detach_behaviors(this);a(this).remove()});b.modal("show")},close_all:function(){a("#overlay .modal").modal("hide")}};vbm.scroll_to=function(c,b){if(vbm.client.system.ipad||vbm.client.system.iphone){a("html,body").scrollTop(a("#"+c).offset().top+b)}else{a("html,body").animate({scrollTop:a("#"+c).offset().top+b},"slow")}};vbm.scroll_top=function(){if(vbm.client.system.ipad||vbm.client.system.iphone){a("html,body").scrollTop(0)}else{a("html,body").animate({scrollTop:0},"slow")}};vbm.register_overlay_handler=function(c,b){vbm.overlay_handlers[c]=b};vbm.close_all_overlays=function(){for(var b in vbm.overlay_handlers){(vbm.overlay_handlers[b])()}};a.fn.toggleAttr=function(d,c,b){var e=c;if(a(this).attr(d)==c){e=b}return a(this).attr(d,e)};a.fn.oid=function(){if(this.length>0){var b=this.first();if(typeof(b.data("oid"))=="undefined"){b.data("oid","oid#"+vbm.serial++)}return b.data("oid")}};a(document).ready(function(){vbm.register_overlay_handler("notifications",vbm.notifications.close_all);vbm.register_overlay_handler("modals",function(){vbm.modal.close_all()});vbm.register_overlay_handler("tooltips",function(){a(".tooltip").remove()});vbm.register_overlay_handler("popovers",function(){a('[rel="popover"]').popover("hide")});vbm.register_overlay_handler("dropdowns",function(){a(".dropdown").removeClass("open")});vbm.register_overlay_handler("btn-groups",function(){a(".btn-group").removeClass("open")});vbm.attach_behaviors(this);a(window).bind("statechange",vbm.navigation.statechange);a("#floating-notifications-container").notify({speed:300,expires:7000,stack:"above"});if(vbm.client.system.ipad||vbm.client.system.iphone){a("body").on("touchstart.dropdown",".dropdown-menu",function(b){b.stopPropagation()})}})})(jQuery);(function(b){var a=[];vbm.notifications=vbm.notifications||{};vbm.notifications.notify=function(e,f,d,c){c=(typeof(c)!="undefined")?c:"cool";if((c=="cool")||(c=="floating")){vbm.notifications[c](e,f,d)}else{vbm.notifications.inline(e,f,d,c)}};vbm.notifications.inline=function(f,g,d,c){var e=b(html+'<p><div class="notification inline-notification '+f+'"><a class="close" href="#">&times;</a></p></div>');b(c).append(e);vbm.attach_behaviors(e);if(d){setTimeout(function(){b("a.close",e).click()},d)}b(".inline-notification-close",e).click(function(){b(this).parent().slideUp("fast",function(){b(this).remove()});return false})};vbm.notifications.floating=function(e,g,d){var c={type:e,text:g};var f=b("#floating-notifications-container").notify("create","default-template",c,{expires:(typeof(d)!="undefined")?d:7000,click:function(i,h){if(i.metaKey){vbm.notifications.close_all()}}});vbm.attach_behaviors(f.element);a.push(f)};vbm.notifications.cool=function(e,f,c){b("#overlay .cool-notification").remove();var d=b('<div class="'+e+' notification cool-notification"><p>'+f+"</p></div>");b("#overlay").append(d);vbm.attach_behaviors(d);b(d).css("bottom",-b(d).outerHeight()).animate({bottom:"0"},500);if(c){setTimeout(function(){b(d).click()},c)}b(d).click(function(){b(this).animate({bottom:-b(this).outerHeight()},500,"linear",function(){b(this).remove()})})};vbm.notifications.close_all=function(){for(var c=0;c<a.length;c++){a[c].close()}a=[];b("#overlay .cool-notification").click();b(".inline-notifications-container .inline-notification-close").click()}})(jQuery);(function(b){var a=[];vbm.ajax=vbm.ajax||{};b.ajaxSetup({cache:false,traditional:true});vbm.ajax.call=function(c){c.type=c.type||"POST";c.context=c.context||b(document);c.element=c.element||null;c.navigation=c.navigation||false;c.data=c.data||{};c.commands=c.commands||{};c.before_send=c.before_send||null;c.success=c.success||null;c.error=c.error||null;b.ajax({url:c.url,data:c.data,type:c.type,dataType:"json",beforeSend:function(f,e){var d=true;f.vbm={weight:100};if(c.navigation){f.setRequestHeader("X-Navigation",1)}if(c.before_send){d=c.before_send(f,e)}if(d&&c.element){b(c.element).addClass("ajaxing")}return d},complete:function(e,d){if(c.element){b(c.element).removeClass("ajaxing")}},success:function(e,d,g){var f=vbm.execute_commands(e,c.context,c.commands);if(c.success){c.success(e,d,g,f)}},error:function(f,d,e){if(!f.aborted&&(d!="abort")&&(d!="aborted")){vbm.notifications.notify("error",gettext("We are sorry, but the request couldn't be processed. Please, try again later."))}if(c.error){c.error(f,d)}}})};b(document).ajaxSend(function(g,j,f){function c(k){var m=document.location.host;var n=document.location.protocol;var l="//"+m;var i=n+l;return(k==i||k.slice(0,i.length+1)==i+"/")||(k==l||k.slice(0,l.length+1)==l+"/")||!(/^(\/\/|http:|https:).*/.test(k))}function e(i){return(/^(GET|HEAD|OPTIONS|TRACE)$/.test(i))}var h={id:vbm.serial++,weight:100};b.extend(h,j.vbm||{});j.vbm=h;for(var d=0;d<a.length;d++){if((a[d].vbm.weight>0)&&(a[d].vbm.weight<=j.vbm.weight)){a[d].abort()}}a.push(j);b("body").addClass("ajaxing");if(!e(f.type)&&c(f.url)){j.setRequestHeader("X-CSRFToken",vbm.csrf_token)}});b(document).ajaxComplete(function(e,f,d){for(var c=0;c<a.length;c++){if(a[c].vbm.id===f.vbm.id){a.splice(c,1);break}}if(a.length===0){b("body").removeClass("ajaxing")}})})(jQuery);(function(e){vbm.navigation=vbm.navigation||{};function c(){return window.History.enabled}function f(){var g=(window.location.hostname||window.location.host);if(window.location.port||false){g+=":"+window.location.port}return g}function a(g){return(g.indexOf("http")===0)}function b(h){var g=f();return h.replace("http://"+g,"").replace("https://"+g,"")}function d(i,h){var g=b(h);vbm.ajax.call({url:h,type:"GET",data:i,navigation:true,before_send:function(l,j){vbm.close_all_overlays();e("#content").animate({opacity:0.2},200);if(vbm.layout=="authenticated"){var k="/"+vbm.language+"/home/";e("#navbar .nav li").removeClass("active");if(g==k){e("#primary-navbar .nav li:first").addClass("active")}else{e("#primary-navbar ul.nav > li").each(function(){if(g.indexOf("/"+vbm.language+e(this).attr("data-path"))===0){e(this).addClass("active")}})}}},success:function(k,j,l){e("#content").stop(true,true).css("opacity",1).show()},error:function(k,j){if(!k.aborted&&(j!="abort")&&(j!="aborted")){window.location=h}},commands:{set_content:function(j){vbm.commands.set_content(j);vbm.scroll_top()}}})}History.base_escapeHash=History.escapeHash;History.escapeHash=function(k){var j=History.base_escapeHash(k);var g="";for(var h=0;h<j.length;h++){g+=j.charAt(h).charCodeAt(0).toString(36)}return g};History.base_unescapeHash=History.unescapeHash;History.unescapeHash=function(k){var g=History.normalizeHash(k);var j="";for(var h=0;h<g.length;){j+=String.fromCharCode(parseInt(""+g.charAt(h++)+g.charAt(h++),36))}return History.base_unescapeHash(j)};vbm.navigation.navigate=function(j,i){i=i||{};var k=i.layout||null;var m=i.submit||{};if(c()){var h=b(j);var g=window.History.getState();var n=null;if(g){n=b(g.url)}var l={ajax:true,submit:m,serial:(new Date()).getTime()+String(Math.random()).replace(/\D/g,"")+"-"+(vbm.serial++)};if(h==n){window.History.replaceState(l,null,j)}else{window.History.pushState(l,null,j)}}else{window.location=j}};vbm.navigation.statechange=function(){var i=window.History.getState();var g=i.url;var h=i.data.submit?i.data.submit:{};if((typeof(i.data.ajax)=="undefined")||(!i.data.ajax)){window.location=g;return}d(h,g)};vbm.navigation.submit=function(g,h){vbm.ajax.call({url:g,type:"POST",data:h,navigation:true,before_send:function(j,i){vbm.close_all_overlays();e("#content").animate({opacity:0.2},200)},success:function(j,i,l,k){if(!k){e("#content").stop(true,true).css("opacity",1).show()}},commands:{set_content:function(i){vbm.commands.set_content(i);vbm.scroll_top()}}})}})(jQuery);(function(a){vbm.behaviors=vbm.behaviors||{};vbm.behaviors.navigation={attach:function(b){a("a.navigation",b).once("navigation",function(){a(this).click(function(c){if((c.which==2)||c.metaKey){return true}else{c.preventDefault();vbm.navigation.navigate(a(this).attr("href"),{layout:a(this).attr("layout")||null});return false}})})}};vbm.behaviors.form={attach:function(c){function b(d,e){a(d).find("input[name=_iframe_upload]").remove().end().find(":input").removeAttr("disabled").end().find("input[type=submit],button[type=submit]").removeClass("ajaxing").end().removeClass("ajaxing");if(!e){a(d).stop(true,true).css("opacity",1)}}a("form.ajax",c).once("ajax-form",function(){var e=this;var d={url:a(this).attr("data-url"),data:{csrfmiddlewaretoken:vbm.csrf_token},beforeSerialize:function(g,f){if(f.iframe){a(g).append('<input type="hidden" name="_iframe_upload" value="1"/>')}},beforeSubmit:function(f,h,g){vbm.notifications.close_all();a(h).find(":input").attr("disabled",true).end().find("input[type=submit], button[type=submit]").addClass("ajaxing").end().addClass("ajaxing").animate({opacity:0.2},200)},success:function(g,f,j,h){var i=vbm.execute_commands(g,h,{});b(h,i)},error:function(g,f){if(!g.aborted&&(f!="abort")&&(f!="aborted")){vbm.notifications.notify("error",gettext("We are sorry, but the request couldn't be processed. Please, try again later."))}b(e,false)},type:(a(this).attr("data-type")||"POST").toUpperCase(),dataType:"json",iframe:false};a(e).ajaxForm(d)})}};vbm.behaviors.confirm={attach:function(b){a("a.confirm",b).once("confirm",function(){a(this).bind("click.confirm",function(f){target=a(this);if(!target.data("confirmed")){var h=target.attr("data-title")||gettext("Are you sure?");var g=target.attr("data-text")||gettext("This action can't be undone.");var d=target.attr("data-cancel-button")||gettext("Cancel");var e=target.attr("data-confirm-button")||gettext("Yes");vbm.modal.open(a('<div class="modal hide fade">  <div class="modal-header">    <h3>'+h+'</h3>  </div>  <div class="modal-body">'+g+'</div>  <div class="modal-footer">    <a href="#" class="btn" data-dismiss="modal"><i class="icon-remove"></i> '+d+'</a>    <a href="#" class="btn btn-danger btn-confirm"><i class="icon-ok icon-white"></i> '+e+"</a>  </div></div>").find(".btn-confirm").click(function(){target.data("confirmed",true).click()}).end());f.stopImmediatePropagation();f.preventDefault()}else{target.data("confirmed",false)}});var c=a._data(this,"events");if(typeof c!="undefined"){if(c.click.length>1){c.click.unshift(c.click.pop())}}else{a(this).unbind("click.confirm")}})}};vbm.behaviors.image_file_input={attach:function(b){a("div.image-file-input",b).each(function(){file_input=a(this).find('input[type="file"]');preview_link=a(this).find(".image-file-input-preview");delete_button=a(this).find(".image-file-input-delete");clear_input=a(this).find(".image-file-input-clear");if(delete_button.length>0){clear_input.hide();file_input.hide();preview_link.show();delete_button.show();delete_button.click(function(){clear_input[0].checked=true;preview_link.hide();delete_button.hide();file_input.show();return false})}})}};vbm.behaviors.link={attach:function(b){a("a.ajax",b).once("ajax-link",function(){a(this).click(function(){var c=a(this).attr("data-url");var d=(a(this).attr("data-type")||"GET").toUpperCase();if((d=="POST")&&a(this).hasClass("submit")){vbm.navigation.submit(c,{})}else{vbm.ajax.call({url:c,type:d,element:this})}return false})})}};vbm.behaviors.bootstrap_initializations={attach:function(b){a('.help-popover[rel="popover"]',b).once("bootstrap",function(){a(this).popover({trigger:"hover",delay:{show:500,hide:100}})});a(".tip",b).tooltip();a(".tip-left",b).tooltip({placement:"left"});a(".tip-right",b).tooltip({placement:"right"});a(".tip-top",b).tooltip({placement:"top"});a(".tip-bottom",b).tooltip({placement:"bottom"})}};vbm.behaviors.bootstrap_form_tweaks={attach:function(b){a(".input-prepend",b).once("input-decoration",function(){a(this).find("input").wrap('<div class="input-decoration-wrapper"></div>')})}}})(jQuery);(function(e){var g=76;var c=60;function b(h){e(h).css({top:e("#content").offset().top,left:e("#content").offset().left,position:"fixed"})}function f(j){var i=e(j).find(".btn-more");if(i.length>0){var k=e(j).parent().find("> .collapsed");e(k).fadeOut().data({is_visible:false});var h=e(j).find(".nav li").length;var l=Math.round((e(j).innerHeight()-80)/g);if(l<2){l=2}if(h>l){a(j,k,h-l)}else{d(j,k,l-h)}e(i).toggle(e(k).find(".nav li").length>0)}}function a(m,p,q){if((q>1)||(e(p).find(".nav li").length>0)){var k=e(m).find(".nav li");var o=e(p).find(".nav");for(var l=k.length-2,h=0;h<q;l--,h++){e(o).prepend(k[l])}}}function d(o,p,q){if(e(p).find(".nav li").length-q===1){q+=1}var k=e(p).find(".nav li");var m=e(o).find(".btn-more").parents("li");for(var l=0,h=0;h<q;l++,h++){m.before(k[l])}}vbm.behaviors.fixed_sidebar={attach:function(h){e(".sidebar").once("sidebar",function(){e(this).after('<div class="collapsed">  <div class="arrow"></div>  <ul class="nav nav-pills"></ul></div>');b(this);f(this);e(this).find(".btn-more").bind("click",function(i){i.preventDefault();var k=e(this).parents(".sidebar").parent().find("> .collapsed");if(e(k).find(".nav li").length>0){if(e(k).data("is_visible")!==undefined&&e(k).data("is_visible")){e(k).data({is_visible:false});e(k).fadeOut()}else{e(k).data({is_visible:true});var j=e(this).find(".icon").offset();e(k).css({top:j.top-15-window.scrollY+"px",left:j.left+c+"px"}).fadeIn()}}})});e("body").once("sidebar",function(){e(window).resize(function(){var i=e(".sidebar");if(i.length>0){b(i);f(i)}})})}}})(jQuery);(function(a){vbm.commands=vbm.commands||{};vbm.commands.update_page_id=function(b){a("body").removeClass(vbm.page_id+"-page");vbm.page_id=b;a("body").addClass(vbm.page_id+"-page")};vbm.commands.check_version=function(b){if((b.js.major!=vbm.version.js.major)||(b.css.major!=vbm.version.css.major)){window.location.reload();return true}};vbm.commands.navigate=function(b){vbm.navigation.navigate(b);return true};vbm.commands.redirect=function(b){window.location=b;return true};vbm.commands.download=function(b){window.location=b};vbm.commands.set_content=function(b){vbm.detach_behaviors("#content");a("#content").html(b);vbm.attach_behaviors("#content")};vbm.commands.alert=function(b){alert(b)};vbm.commands.modal=function(c){a(c).filter("script").appendTo("body");var b=a(c).filter(".modal");if(b.length==1){vbm.modal.open(b)}};vbm.commands.close_modal=function(){vbm.modal.close_all()};vbm.commands.notify=function(e){if(e.length>0){var c=a(".inline-notifications-container").last();if(a(c).length>0){a(c).html("")}for(var d=0;d<e.length;d++){if((e[d].tags.indexOf("inline")!=-1)&&(a(c).length>0)){vbm.notifications.notify(e[d].type,e[d].message,null,c)}else{var b=null;if((e[d].type!="error")){b=5000+100*e[d].message.length}vbm.notifications.notify(e[d].type,e[d].message,b,(e.length>1)?"floating":"cool")}}}};vbm.commands.debug=function(b){var c=a("#debug-toolbar .log");vbm.detach_behaviors(c);c.html(b);vbm.attach_behaviors(c)};vbm.commands.timer=function(b){a("#debug-toolbar .execution-time").html(b)}})(jQuery);(function(d){var b=null;var e=null;function a(f,g){b=setTimeout(function(){vbm.ajax.call({type:"GET",url:f,error:function(i,h){a(f,g)}})},g)}function c(f,i,h,g){if(i>0){e=setTimeout(function(){var j=parseFloat(d(f).attr("data-value"))+h;if(j<=(f).attr("data-max")){d(f).attr("data-value",j).css("width",j+"%");c(f,i-1,h,g)}},g)}}vbm.commands.show_progress=function(g,f,i,j){var h=d('<div class="modal hide fade" id="progress-modal" data-url="'+g+'">  <div class="modal-header">    <h3>'+j+'</h3>  </div>  <div class="modal-body">    <div class="progress progress-striped active" style="display: none;">      <div class="bar" data-max="0" data-value="0" style="width: 0%;"></div>    </div>    <p class="pull-right"><i class="font-awesome font-awesome-warning-sign"></i> '+gettext("Please, be patient. <strong>Do not close or reload the page!</strong>")+'</p>  </div>  <div class="modal-footer">    <a href="#" class="btn btn-danger"><i class="icon-remove icon-white"></i> '+gettext("Abort")+"</a>  </div></div>");d(".modal-footer .btn",h).click(function(){clearInterval(b);clearInterval(e);vbm.ajax.call({url:f,type:"POST",element:this});return false});vbm.modal.open(h);a(g,i)};vbm.commands.update_progress=function(i,h){modal=d("#progress-modal");if(modal.length>0){if(i){d(modal).find(".progress").show();var g=d(modal).find(".bar");var j=i-d(g).attr("data-max");if(j>0){d(g).attr("data-max",i);var f=Math.ceil(h/100);c(g,f,j/f,100)}}a(d(modal).attr("data-url"),h)}};vbm.commands.hide_progress=function(){modal=d("#progress-modal");if(modal.length>0){d(modal).modal("hide")}}})(jQuery);(function(a){vbm.partials=vbm.partials||{registry:{}};vbm.partials.ready=function(d,c){if(d in vbm.partials.registry){var b=vbm.partials.registry[d](c);vbm.ready(b.callback,b.ready,b.unloader)}}})(jQuery);(function(a){vbm.partials.registry["bans-submit-errors-modal"]=function(b){return{callback:function(c){a(c).filter(".modal").on("hidden",function(){vbm.navigation.navigate(b.destination)})}}}})(jQuery);(function(a){vbm.partials.registry["caches-browse-page"]=function(b){return{callback:function(c){var d=[];var e=a(".groups",c);e.sortable({axis:"y",containment:e,handle:".group-sortable-handle",items:".group[data-group-id]",opacity:0.5,tolerance:"pointer",stop:function(g,h){a.each(d,function(i,j){j.sortable("disable")});var f=a.map(e.find(".group"),function(i){return a(i).data("group-id")});vbm.ajax.call({url:b.groups_reorder_url,type:"POST",data:{ids:f},success:function(){a.each(d,function(i,j){j.sortable("enable")})},error:function(){e.sortable("cancel");a.each(d,function(i,j){j.sortable("enable")})},})}});d.push(e);e.find(".group .nodes").each(function(){var f=a(this);f.sortable({connectWith:".nodes",containment:e,handle:".node-sortable-handle",items:".node[data-node-id]",opacity:0.5,tolerance:"pointer",stop:function(h,i){a.each(d,function(j,k){k.sortable("disable")});var g=a.map(i.item.closest(".nodes").find(".node"),function(j){return a(j).data("node-id")});vbm.ajax.call({url:b.nodes_reorder_url,type:"POST",data:{group_id:i.item.closest(".group").data("group-id"),node_ids:g,target_id:i.item.data("node-id"),},success:function(){a.each(d,function(j,k){k.sortable("enable")})},error:function(){f.sortable("cancel");a.each(d,function(j,k){k.sortable("enable")})},})}});d.push(f)})}}}})(jQuery);(function(a){vbm.partials.registry["users-browse-page"]=function(b){return{callback:function(d){var c=a(d).find(".users-browser");(function(e){function g(j){return{page:j||1,items_per_page:e.find(".collection-items-per-page li.active").attr("data-collection-items-per-page"),email:e.find('.collection-filter input[name="email"]').val(),first_name:e.find('.collection-filter input[name="first_name"]').val(),last_name:e.find('.collection-filter input[name="last_name"]').val(),sort_criteria:e.find(".collection-sort li.active").attr("data-sort-criteria"),sort_direction:e.find(".collection-sort li.active").attr("data-sort-direction")}}function i(j){vbm.navigation.navigate(b.browse_url,{submit:g(j)})}function h(l){var k=e.find(".collection-pager li.active").attr("data-page");var j=g(k);j.op=l;if(e.find("thead th.collection-selector input").is(":checked")){j.all_items=true}else{j.items=a.map(e.find("tbody td.collection-selector input:checked"),function(m){return a(m).attr("data-id")})}vbm.navigation.submit(b.bulk_url,j)}function f(k){var j=(k.find("tbody td.collection-selector input:checked").length===0);e.find(".collection-bulk button").toggleClass("disabled",j)}a(".collection-filter form",e).submit(function(){i();return false});a(".collection-sort li",e).click(function(){a(this).find("i:not(.icon-empty)").closest("li").toggleAttr("data-sort-direction","asc","desc");a(this).addClass("active").siblings("li").removeClass("active");i();return false});a(".collection-bulk li",e).click(function(){h(a(this).closest("li").attr("data-op"));return false});a(".collection-items-per-page li",e).click(function(){a(this).addClass("active").siblings("li").removeClass("active");i();return false});a(".collection-pager li:not(.disabled)",e).click(function(){i(a(this).attr("data-page"));return false});a("thead th.collection-selector input",e).change(function(){var j=a(this).closest("table");j.find("tbody td.collection-selector input").prop("checked",a(this).is(":checked"));f(j)});a("tbody td.collection-selector input",e).change(function(){var j=a(this).closest("table");if(!a(this).is(":checked")){j.find("thead th.collection-selector input").prop("checked",false)}f(j)})})(c)}}}})(jQuery);(function(a){vbm.partials.registry["bans-submissions-page"]=function(b){return{callback:function(d){var c=a(d).find(".submissions-browser");(function(e){function f(h){return{page:h||1,items_per_page:e.find(".collection-items-per-page li.active").attr("data-collection-items-per-page"),user:e.find('.collection-filter select[name="user"]').val(),ban_type:e.find('.collection-filter select[name="ban_type"]').val(),target:e.find('.collection-filter select[name="target"]').val(),sort_criteria:e.find(".collection-sort li.active").attr("data-sort-criteria"),sort_direction:e.find(".collection-sort li.active").attr("data-sort-direction")}}function g(h){vbm.navigation.navigate(b.browse_url,{submit:f(h)})}a(".collection-filter form",e).submit(function(){g();return false});a(".collection-sort li",e).click(function(){a(this).find("i:not(.icon-empty)").closest("li").toggleAttr("data-sort-direction","asc","desc");a(this).addClass("active").siblings("li").removeClass("active");g();return false});a(".collection-items-per-page li",e).click(function(){a(this).addClass("active").siblings("li").removeClass("active");g();return false});a(".collection-pager li:not(.disabled)",e).click(function(){g(a(this).attr("data-page"));return false});a("table .expand-ban-submission-details a",e).click(function(){a(this).hide();a(this).closest("td").find(".expanded-ban-submission-details").slideDown();return false});a("table .collapse-ban-submission-details a",e).click(function(){a(this).closest(".expanded-ban-submission-details").slideUp(200,function(){a(this).closest("td").find(".expand-ban-submission-details a").show()});return false})})(c)}}}})(jQuery);