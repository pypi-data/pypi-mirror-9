{% extends "djmicrosip_cotizador\base.html" %}
{% block title %}Estructura{% endblock %}

<!-- CSS Code -->
{% block style_css %}
<link rel="stylesheet" href="{{ STATIC_URL}}djmicrosip_cotizador/css/estructura.css">
<link rel="stylesheet" href="{{STATIC_URL}}djmicrosip_organizador/css/style.min.css" />
{% endblock %}

<!-- JavaScript Code -->
{% block js_code %}
{% include 'autocomplete_light/static.html' %}
<script src='{{STATIC_URL}}js/jquery.formset.js'></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.checkbox.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.contextmenu.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.dnd.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.search.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.sort.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.state.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.types.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.unique.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/jstree/jstree.wholerow.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/estructura.js"></script>
<script src="{{STATIC_URL}}djmicrosip_cotizador/js/estructura/estructura.js"></script>
<script>
$(function() {
  $('#id_detalles_data tbody tr').formset({
    prefix: '{{ formset.prefix }}',
    addCssClass:'btn btn-success',
    addText:'Nuevo detalle',
    deleteText:'Eliminar',
    added: agregar,
  });
});
</script>
{% endblock %}

{% block breadcrumb %}{{ block.super }}  {% endblock %}
{% block content %}
<form method="post" class="form-horizontal" action="" width="300px"  enctype='multipart/form-data'>{% csrf_token %}
	{{ form.errors }}
	<div class="page-header">
		<h1>Estructura  <small>{{ estructura.nombre }} </small> <button type="submit" class="btn"><i class="glyphicon glyphicon-save"></i> Guardar</button>  </h1>
	</div>
		<div class="col-md-4 col-xs-2 col-sm-4">
			<div id="div_puntos">
				<label>Nombre</label>
				<div class="input-prepend input-append">{{ form.nombre }}</div>
			</div>
		</div>	
		<div class="col-md-4 col-xs-2 col-sm-4">
			<div id="div_puntos">
				<label>Imagen</label>
				<div class="input-prepend input-append">{{ form.imagen }}</div>
			</div>
		</div>	
		<div class="col-md-4 col-xs-2 col-sm-4">
			<div id="div_puntos">
				<label>Carpeta Base</label>
				<div class="input-prepend input-append">{{ form.carpeta_base}}</div>
			</div>
		</div>

		<table class="table tableCell table-hover" id="id_detalles_data">
		<thead>
		  <tr>
		    <th>Carpeta</th>
		    <th>Cantidad</th>
		    <th></th>
		  </tr>
		</thead>
		<tbody>
		  {% for form in formset.forms%}
		  <tr id="{{ form.prefix }}-row" class="form-container">
		    {{ form.errors }}
		    <td>
		    	{{ form.carpeta }}
		    	<span class="div hilight">
		    		<a href="#" class="deleteSelecction">
		    			<i class="glyphicon glyphicon-pencil"></i>
		    			<span class="folderFullPath"></span>
		    		</a>
		    		
		    	</span>
		    </td>
		    <td>{{ form.cantidad }}
		     {% for fld in form.hidden_fields %}{{ fld }}{% endfor %}</td>
		    <td>{% if form.instance.pk %}{{ form.DELETE }}{% endif %}</td>
		  </tr>
		  {% endfor %}
		</tbody>
		</table>
		{{ formset.management_form }}

</form>
<div class="modal fade" id="modal_arbol" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <div class="row">
        	<input type="hidden" value="" name="folders" id="selectedFolderId" />
        	Seleciona una carpeta
        	<div class="col-md-1"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>
        </div>
      </div>
      <div class="modal-body">
        <div id="id_tree_container" class="col-md-3 col-xs-6 col-sm-6"></div>
        <div class="row" style="clear: both;">
        </div>
      </div>
      <div class="modal-footer">
      	<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>
      	<a href="#" id="id_selectFolderBtn" class="btn btn-default">Seleccionar</a>

      </div>
    </div>
  </div>
</div>
<br style="clear:both">
{% endblock %}