<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="master.html" />
  <xi:include href="stroller_commons.html" />  

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" py:replace="''"/>
  <title>Category: ${category.name}</title>
</head>

<body>
    <div id="stroller">
        ${render_cart()}
        ${stroller_search()}
        <div id="manage" style="float: right; padding-bottom: 2px; padding-top: 6px; margin-right: 10px;" py:if="request.identity and 'stroller' in request.identity['groups']">
          <a href="${h.stroller_url('/manage/list_orders')}">Manage Orders</a>
          <a href="${h.stroller_url('/manage/usermanage')}">Manage Users</a>
        </div>
        ${breadcrumbs(category)}
        <div style="clear: both;"></div>

	    <div id="top_section">
	        <div id="subcategories">
		        <div class="categories_header">
		            ${category.name}
		            <a py:if="request.identity and 'stroller' in request.identity['groups']"
	                   class="stroller_cmd" 
	                   href="${h.stroller_url('/manage/create_category', parent=category.uid)}">add category</a>
		        </div>
		        <ul>
			        <li py:for="subcategory in category.subcategories" py:if="subcategory.is_visible(request.identity and request.identity['user'])">
				        <a href="${h.stroller_url('/category/%s' % subcategory.uid)}"
						        py:content="subcategory.name"></a>
                        <span py:if="request.identity and 'stroller' in request.identity['groups']"
			                 class="stroller_product_commands">
			                <a href="${h.stroller_url('/manage/front_add', c=subcategory.uid)}"
			                   py:if="not subcategory.featured">
			                    ${Markup(h.icons['featured_add'])}
			                </a>
			            </span>
			        </li>
		        </ul>
	        </div>

	        <div id="products">
                <ul id="front_categories" py:if="category.show_subcategories">
                    <li py:for="cat in category.subcategories"
                        class="stroller_front_category">
                        <a href="${h.stroller_url('/category/%s' % cat.uid)}">
                            ${Markup(h.category_icon(cat))}
                            ${cat.name}
                        </a>
                    </li>
                </ul>

		        <div id="category-title">
		            ${category.name.capitalize()} Products
		            <a py:if="request.identity and 'stroller' in request.identity['groups']"
		                  class="stroller_cmd"
		                  href="${h.stroller_url('/manage/add_product', category=category.uid)}">add product</a>
                </div>
		        <ul>
			        <li py:for="product in category.all_products" class="stroller_product" py:if="product.is_visible">
                        ${product_preview(product)}

			        </li>
		        </ul>
                <div id="stroller_delete_category_btn">
                    <a py:if="request.identity and 'stroller' in request.identity['groups']"
                       href="${h.stroller_url('/manage/do_delete_category', category_id=category.uid)}"
                       class="stroller_cmd">
                        delete this category
                    </a>
                </div>
	        </div>
	        
            <div style="clear: both;"></div>
	    </div>
    </div>
</body>
</html>
