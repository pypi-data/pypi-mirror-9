<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:py="http://genshi.edgewall.org/"
      xmlns:xi="http://www.w3.org/2001/XInclude">

  <xi:include href="master.html" />
  <xi:include href="stroller_commons.html" />  

<head>
  <meta content="text/html; charset=UTF-8" http-equiv="content-type" py:replace="''"/>
  <title>Category: ${category.name}</title>
  <style>
    #subcategories {
        float: right;
    }
  </style>
</head>

<body>
    <div id="stroller">
        ${render_cart()}
        ${stroller_search()}
        <div id="manage" style="float: right; padding-bottom: 2px; padding-top: 6px; margin-right: 10px;" py:if="request.identity and 'stroller' in request.identity['groups']">
          <a href="${h.stroller_url('/manage/list_orders')}">Manage Orders</a>
          <a href="${h.stroller_url('/manage/usermanage')}">Manage Users</a>
        </div>
        ${breadcrumbs(category)}
        <div style="clear: both;"></div>

	    <div id="top_section">
	        <div id="subcategories">
		        <div class="categories_header">
		            ${category.name}
		            <a py:if="request.identity and 'stroller' in request.identity['groups']"
	                   class="stroller_cmd" 
	                   href="${h.stroller_url('/manage/create_category', parent=category.uid)}">add category</a>
		        </div>
		        <ul>
			        <li py:for="subcategory in category.subcategories"
                        py:if="subcategory.is_visible(request.identity and request.identity['user'])">
				            <a href="${h.stroller_url('/category/%s' % subcategory.uid)}"
						        py:content="subcategory.name"></a>

                        <span py:if="request.identity and 'stroller' in request.identity['groups']"
			                 class="stroller_product_commands">
			                <a href="${h.stroller_url('/manage/front_add', c=subcategory.uid)}"
			                   py:if="not subcategory.featured">
			                    ${Markup(h.icons['featured_add'])}
			                </a>
			            </span>
			        </li>
		        </ul>
	        </div>

	        <div id="frontbox">
	            <ul id="front_categories">
	                <li py:for="cat in front_categories"
                        py:if="cat.is_visible(request.identity and request.identity['user'])"
	                     class="stroller_front_category">
	                    <a href="${h.stroller_url('/category/%s' % cat.uid)}">
        	                ${Markup(h.category_icon(cat))}
        	                ${cat.name}
        	            </a>
  			            <div py:if="request.identity and 'stroller' in request.identity['groups']"
			                 class="stroller_product_commands">
			                <a href="${h.stroller_url('/manage/front_del', c=cat.uid)}">
			                    ${Markup(h.icons['featured_del'])}
			                </a>
			            </div>
	                </li>
	            </ul>
	            
		        <div id="category-title">
		            Featured Products
                </div>
		        <ul id="featured_products">
			        <li py:for="product in featured" class="stroller_product" py:if="product.is_visible">
                        ${product_preview(product)}
			        </li>
		        </ul>

                
                <div id="category-title" style="margin-top: 10px;">
		            Users' favourite products
                </div>
		        <ul id="feav_products">
			        <li py:for="product in favourites" class="stroller_product" py:if="product.is_visible">
			            ${product_preview(product)}
			        </li>
		        </ul>
	        </div>
	        
            <div style="clear: both;"></div>	
	    </div>
    </div>
</body>
</html>
