{% extends "django-microsip-consolidador/base.html" %}
{% block title %}Articulo{% endblock %}

<!-- CSS Code -->
{% block style_css %}{% endblock %}

<!-- JavaScript Code -->
{% block js_code %}
{% include 'autocomplete_light/static.html' %}
<script type="text/javascript">
	$('#id_articulo_text').addClass('form-control');
	var value = $("#id_articulo").find("option:selected").val();
	if (value != undefined) {
		$("#id_clave").hide();
		$("#id_clave").val('');
	}
	else{
		$("#id_clave").show();
	}

	$("#id_articulo").on('change', function(){
		var value = $(this).find("option:selected").val();
		if (value != undefined) {
			$("#id_clave").hide();
		}
		else{
			$("#id_clave").show();
		}
	});
	
	$(document).ready(function(){
	  $('#clave_id').focus();
	  $('#clave_id').live('keydown', function(e) { 
	    var keyCode = e.keyCode || e.which; 
	    if (keyCode == 13)
	    {
	      event.preventDefault();
	      window.location.href = '/consolidador/articulo_consolidado/'+ $('#clave_id').val()+'/';
	    } 

	   $("#clave_id").bind('keyup', function (e) {
	      if (e.which >= 97 && e.which <= 122) {
	          var newKey = e.which - 32;
	          // I have tried setting those
	          e.keyCode = newKey;
	          e.charCode = newKey;
	      }

	      $("#clave_id").val(($("#clave_id").val()).toUpperCase());
	    });
	  });
	});  
</script>
{% endblock %}

{% block breadcrumb %}{{ block.super }}
  <li class='active'> Buscar articulo</li> 
{% endblock %}
{% block content %}
<form method="POST" action="" class="form-inline" enctype='multipart/form-data'>{% csrf_token %}
	{{ form.errors }}
	{{ form.articulo }}
	{{ form.clave }}
	<button type="submit" class="btn"><i class="glyphicon glyphicon-download-alt"></i> Buscar</button>
</form>
<!-- <form role="search">
  <div class="form-group">
    <input type="text" id='clave_id' class="form-control" placeholder="Clave articulo... ">
  </div>
</form> -->
<hr/>
<h3 class="">{{ articulo_nombre }} ({{ clave }})</h3>  

<table class="table table-striped">
		<tr>
			<th>Sucursal</th>
			<th>Existencia</th>
			{% if show_ahorro == '1' %} 
				<th class="hidden-xs">Precio</th> 
				<th class="hidden-xs">Ahorro</th>
			{% endif %}
			<th>Precio</th>
		</tr>
	{% for key,value in sucursales.items %}
		<tr>
			<td>{{ key }}</td>
			<td>{{ value.existencia }}</td>
			{% if show_ahorro == '1' %}
				<td class="hidden-xs">${{ value.precio_original }}</td> 
				<td class="hidden-xs">{{ value.descuento }}%  ${{ value.ahorro }}</td> 
			{% endif %}
			<td>${{ value.precio_con_descuento }}</td>
		</tr>
	{% endfor %}
</table>
{% endblock %}