import json
from django.views.generic import View
from django.http import HttpResponse
from djinn_i18n.tool import TOOL


class POView(View):

    def get(self, request, *args, **kwargs):

        self.entry = TOOL.get_entry(self.msgid, self.locale)

        return super(TransView, self).get(request, *args, **kwargs)

    def post(self, request, *args, **kwargs):

        TOOL.translate(self.msgid, request.POST.get('msgstr'), self.locale)

        if self.request.is_ajax():
            return HttpResponse(json.dumps({'status': 'ok'}, skipkeys=True))
        else:
            return HttpResponseRedirect(reverse("djinn_i18n_index"))
