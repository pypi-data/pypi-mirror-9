{% extends 'layout.html' %}

{% block title %} Repository {{ repo.name }} {% endblock %}
{% block page_title %} Repository &laquo;{{ repo.name }}&raquo; {% endblock %}

{% block toolbar %}
    <a href="{{ url_for('web.home') }}">Return to the repositories list</a>
{% endblock %}

{% block content %}
    {% if repo.packages|count == 0 %}
    <p>Sorry, but there are no packages in this repository.</p>
    {% elif repo.packages|count == 1 %}
    <p>There is 1 package in this repository:</p>
    {% else %}
    <p>There are {{ repo.packages|count }} packages in this repository:</p>
    {% endif %}

    {% set packages_to_show = repo.packages %}
    {% include 'packages_list.html' %}

    {% for inheritance in repo.inheritances %}
        {% set inheritance_packages =
           repo.packages_via_inheritance(inheritance) %}
        {% if inheritance_packages|count == 0 %}
        <p>
            This repository also inherits no packages from the
            {% if inheritance.private %}
            <span class="private">private</span>
            {% endif %}
            repository
            <a href="{{ url_for('web.repo', repo=inheritance.name) }}">
                {{ inheritance.name }}</a>.
        </p>
        {% else %}
        <p>
            This repository also inherits
            {% if inheritance_packages|count == 1 %}
            1 package
            {% else %}
            {{ inheritance_packages|count }}
            packages
            {% endif %}
            from the
            {% if inheritance.private %}
            <span class="private">private</span>
            {% endif %}
            repository
            <a href="{{ url_for('web.repo', repo=inheritance.name) }}">
                {{ inheritance.name }}</a>:
        </p>
        {% set packages_to_show = inheritance_packages %}
        {% include 'packages_list.html' %}
        {% endif %}
    {% endfor %}
{% endblock %}
