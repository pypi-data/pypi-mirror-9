var TableTools;(function(h,f,g){var e=function(b,c){var d={version:"1.0.4-TableTools2",clients:{},moviePath:"",nextId:1,$:function(j){if(typeof(j)=="string"){j=f.getElementById(j)}if(!j.addClass){j.hide=function(){this.style.display="none"};j.show=function(){this.style.display=""};j.addClass=function(i){this.removeClass(i);this.className+=" "+i};j.removeClass=function(i){this.className=this.className.replace(new RegExp("\\s*"+i+"\\s*")," ").replace(/^\s+/,"").replace(/\s+$/,"")};j.hasClass=function(i){return !!this.className.match(new RegExp("\\s*"+i+"\\s*"))}}return j},setMoviePath:function(j){this.moviePath=j},dispatch:function(m,o,n){var p=this.clients[m];if(p){p.receiveEvent(o,n)}},register:function(k,l){this.clients[k]=l},getDOMObjectPosition:function(k){var l={left:0,top:0,width:k.width?k.width:k.offsetWidth,height:k.height?k.height:k.offsetHeight};if(k.style.width!==""){l.width=k.style.width.replace("px","")}if(k.style.height!==""){l.height=k.style.height.replace("px","")}while(k){l.left+=k.offsetLeft;l.top+=k.offsetTop;k=k.offsetParent}return l},Client:function(j){this.handlers={};this.id=d.nextId++;this.movieId="ZeroClipboard_TableToolsMovie_"+this.id;d.register(this.id,this);if(j){this.glue(j)}}};d.Client.prototype={id:0,ready:false,movie:null,clipText:"",fileName:"",action:"copy",handCursorEnabled:true,cssEffects:true,handlers:null,sized:false,glue:function(p,o){this.domElement=d.$(p);var n=99;if(this.domElement.style.zIndex){n=parseInt(this.domElement.style.zIndex,10)+1}var q=d.getDOMObjectPosition(this.domElement);this.div=f.createElement("div");var r=this.div.style;r.position="absolute";r.left="0px";r.top="0px";r.width=(q.width)+"px";r.height=q.height+"px";r.zIndex=n;if(typeof o!="undefined"&&o!==""){this.div.title=o}if(q.width!==0&&q.height!==0){this.sized=true}if(this.domElement){this.domElement.appendChild(this.div);this.div.innerHTML=this.getHTML(q.width,q.height).replace(/&/g,"&amp;")}},positionElement:function(){var l=d.getDOMObjectPosition(this.domElement);var m=this.div.style;m.position="absolute";m.width=l.width+"px";m.height=l.height+"px";if(l.width!==0&&l.height!==0){this.sized=true}else{return}var n=this.div.childNodes[0];n.width=l.width;n.height=l.height},getHTML:function(o,r){var p="";var q="id="+this.id+"&width="+o+"&height="+r;if(navigator.userAgent.match(/MSIE/)){var n=location.href.match(/^https/i)?"https://":"http://";p+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+n+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" width="'+o+'" height="'+r+'" id="'+this.movieId+'" align="middle"><param name="allowScriptAccess" value="always" /><param name="allowFullScreen" value="false" /><param name="movie" value="'+d.moviePath+'" /><param name="loop" value="false" /><param name="menu" value="false" /><param name="quality" value="best" /><param name="bgcolor" value="#ffffff" /><param name="flashvars" value="'+q+'"/><param name="wmode" value="transparent"/></object>'}else{p+='<embed id="'+this.movieId+'" src="'+d.moviePath+'" loop="false" menu="false" quality="best" bgcolor="#ffffff" width="'+o+'" height="'+r+'" name="'+this.movieId+'" align="middle" allowScriptAccess="always" allowFullScreen="false" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" flashvars="'+q+'" wmode="transparent" />'}return p},hide:function(){if(this.div){this.div.style.left="-2000px"}},show:function(){this.reposition()},destroy:function(){if(this.domElement&&this.div){this.hide();this.div.innerHTML="";var l=f.getElementsByTagName("body")[0];try{l.removeChild(this.div)}catch(k){}this.domElement=null;this.div=null}},reposition:function(l){if(l){this.domElement=d.$(l);if(!this.domElement){this.hide()}}if(this.domElement&&this.div){var m=d.getDOMObjectPosition(this.domElement);var n=this.div.style;n.left=""+m.left+"px";n.top=""+m.top+"px"}},clearText:function(){this.clipText="";if(this.ready){this.movie.clearText()}},appendText:function(j){this.clipText+=j;if(this.ready){this.movie.appendText(j)}},setText:function(j){this.clipText=j;if(this.ready){this.movie.setText(j)}},setCharSet:function(j){this.charSet=j;if(this.ready){this.movie.setCharSet(j)}},setBomInc:function(j){this.incBom=j;if(this.ready){this.movie.setBomInc(j)}},setFileName:function(j){this.fileName=j;if(this.ready){this.movie.setFileName(j)}},setAction:function(j){this.action=j;if(this.ready){this.movie.setAction(j)}},addEventListener:function(l,k){l=l.toString().toLowerCase().replace(/^on/,"");if(!this.handlers[l]){this.handlers[l]=[]}this.handlers[l].push(k)},setHandCursor:function(j){this.handCursorEnabled=j;if(this.ready){this.movie.setHandCursor(j)}},setCSSEffects:function(j){this.cssEffects=!!j},receiveEvent:function(p,o){var q;p=p.toString().toLowerCase().replace(/^on/,"");switch(p){case"load":this.movie=f.getElementById(this.movieId);if(!this.movie){q=this;setTimeout(function(){q.receiveEvent("load",null)},1);return}if(!this.ready&&navigator.userAgent.match(/Firefox/)&&navigator.userAgent.match(/Windows/)){q=this;setTimeout(function(){q.receiveEvent("load",null)},100);this.ready=true;return}this.ready=true;this.movie.clearText();this.movie.appendText(this.clipText);this.movie.setFileName(this.fileName);this.movie.setAction(this.action);this.movie.setCharSet(this.charSet);this.movie.setBomInc(this.incBom);this.movie.setHandCursor(this.handCursorEnabled);break;case"mouseover":if(this.domElement&&this.cssEffects){if(this.recoverActive){this.domElement.addClass("active")}}break;case"mouseout":if(this.domElement&&this.cssEffects){this.recoverActive=false;if(this.domElement.hasClass("active")){this.domElement.removeClass("active");this.recoverActive=true}}break;case"mousedown":if(this.domElement&&this.cssEffects){this.domElement.addClass("active")}break;case"mouseup":if(this.domElement&&this.cssEffects){this.domElement.removeClass("active");this.recoverActive=false}break}if(this.handlers[p]){for(var r=0,s=this.handlers[p].length;r<s;r++){var t=this.handlers[p][r];if(typeof(t)=="function"){t(this,o)}else{if((typeof(t)=="object")&&(t.length==2)){t[0][t[1]](this,o)}else{if(typeof(t)=="string"){h[t](this,o)}}}}}}};h.ZeroClipboard_TableTools=d;var a;(function(l,m,n){a=function(j,k){if(!this instanceof a){alert("Warning: TableTools must be initialised with the keyword 'new'")}var i=l.fn.dataTable.Api?new l.fn.dataTable.Api(j).settings()[0]:j.fnSettings();this.s={that:this,dt:i,print:{saveStart:-1,saveLength:-1,saveScroll:-1,funcEnd:function(){}},buttonCounter:0,select:{type:"",selected:[],preRowSelect:null,postSelected:null,postDeselected:null,all:false,selectedClass:""},custom:{},swfPath:"",buttonSet:[],master:false,tags:{}};this.dom={container:null,table:null,print:{hidden:[],message:null},collection:{collection:null,background:null}};this.classes=l.extend(true,{},a.classes);if(this.s.dt.bJUI){l.extend(true,this.classes,a.classes_themeroller)}this.fnSettings=function(){return this.s};if(typeof k=="undefined"){k={}}this._fnConstruct(k);return this};a.prototype={fnGetSelected:function(t){var i=[],k=this.s.dt.aoData,r=this.s.dt.aiDisplay,s,j;if(t){for(s=0,j=r.length;s<j;s++){if(k[r[s]]._DTTT_selected){i.push(k[r[s]].nTr)}}}else{for(s=0,j=k.length;s<j;s++){if(k[s]._DTTT_selected){i.push(k[s].nTr)}}}return i},fnGetSelectedData:function(){var i=[];var k=this.s.dt.aoData;var p,j;for(p=0,j=k.length;p<j;p++){if(k[p]._DTTT_selected){i.push(this.s.dt.oInstance.fnGetData(p))}}return i},fnIsSelected:function(i){var j=this.s.dt.oInstance.fnGetPosition(i);return(this.s.dt.aoData[j]._DTTT_selected===true)?true:false},fnSelectAll:function(j){var i=this._fnGetMasterSettings();this._fnRowSelect((j===true)?i.dt.aiDisplay:i.dt.aoData)},fnSelectNone:function(j){var i=this._fnGetMasterSettings();this._fnRowDeselect(this.fnGetSelected(j))},fnSelect:function(i){if(this.s.select.type=="single"){this.fnSelectNone();this._fnRowSelect(i)}else{if(this.s.select.type=="multi"){this._fnRowSelect(i)}}},fnDeselect:function(i){this._fnRowDeselect(i)},fnGetTitle:function(k){var j="";if(typeof k.sTitle!="undefined"&&k.sTitle!==""){j=k.sTitle}else{var i=n.getElementsByTagName("title");if(i.length>0){j=i[0].innerHTML}}if("\u00A1".toString().length<4){return j.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"")}else{return j.replace(/[^a-zA-Z0-9_\.,\-_ !\(\)]/g,"")}},fnCalcColRatios:function(u){var v=this.s.dt.aoColumns,i=this._fnColumnTargets(u.mColumns),w=[],t=0,k=0,x,j;for(x=0,j=i.length;x<j;x++){if(i[x]){t=v[x].nTh.offsetWidth;k+=t;w.push(t)}}for(x=0,j=w.length;x<j;x++){w[x]=w[x]/k}return w.join("\t")},fnGetTableData:function(i){if(this.s.dt){return this._fnGetDataTablesData(i)}},fnSetText:function(j,i){this._fnFlashSetText(j,i)},fnResizeButtons:function(){for(var j in d.clients){if(j){var i=d.clients[j];if(typeof i.domElement!="undefined"&&i.domElement.parentNode){i.positionElement()}}}},fnResizeRequired:function(){for(var j in d.clients){if(j){var i=d.clients[j];if(typeof i.domElement!="undefined"&&i.domElement.parentNode==this.dom.container&&i.sized===false){return true}}}return false},fnPrint:function(j,i){if(i===g){i={}}if(j===g||j){this._fnPrintStart(i)}else{this._fnPrintEnd()}},fnInfo:function(j,k){var i=l("<div/>").addClass(this.classes.print.info).html(j).appendTo("body");setTimeout(function(){i.fadeOut("normal",function(){i.remove()})},k)},fnContainer:function(){return this.dom.container},_fnConstruct:function(i){var j=this;this._fnCustomiseSettings(i);this.dom.container=n.createElement(this.s.tags.container);this.dom.container.className=this.classes.container;if(this.s.select.type!="none"){this._fnRowSelectConfig()}this._fnButtonDefinations(this.s.buttonSet,this.dom.container);this.s.dt.aoDestroyCallback.push({sName:"TableTools",fn:function(){l(j.s.dt.nTBody).off("click.DTTT_Select","tr");l(j.dom.container).empty()}})},_fnCustomiseSettings:function(i){if(typeof this.s.dt._TableToolsInit=="undefined"){this.s.master=true;this.s.dt._TableToolsInit=true}this.dom.table=this.s.dt.nTable;this.s.custom=l.extend({},a.DEFAULTS,i);this.s.swfPath=this.s.custom.sSwfPath;if(typeof d!="undefined"){d.moviePath=this.s.swfPath}this.s.select.type=this.s.custom.sRowSelect;this.s.select.preRowSelect=this.s.custom.fnPreRowSelect;this.s.select.postSelected=this.s.custom.fnRowSelected;this.s.select.postDeselected=this.s.custom.fnRowDeselected;if(this.s.custom.sSelectedClass){this.classes.select.row=this.s.custom.sSelectedClass}this.s.tags=this.s.custom.oTags;this.s.buttonSet=this.s.custom.aButtons},_fnButtonDefinations:function(s,k){var i;for(var t=0,j=s.length;t<j;t++){if(typeof s[t]=="string"){if(typeof a.BUTTONS[s[t]]=="undefined"){alert("TableTools: Warning - unknown button type: "+s[t]);continue}i=l.extend({},a.BUTTONS[s[t]],true)}else{if(typeof a.BUTTONS[s[t].sExtends]=="undefined"){alert("TableTools: Warning - unknown button type: "+s[t].sExtends);continue}var o=l.extend({},a.BUTTONS[s[t].sExtends],true);i=l.extend(o,s[t],true)}k.appendChild(this._fnCreateButton(i,l(k).hasClass(this.classes.collection.container)))}},_fnCreateButton:function(k,j){var i=this._fnButtonBase(k,j);if(k.sAction.match(/flash/)){this._fnFlashConfig(i,k)}else{if(k.sAction=="text"){this._fnTextConfig(i,k)}else{if(k.sAction=="div"){this._fnTextConfig(i,k)}else{if(k.sAction=="collection"){this._fnTextConfig(i,k);this._fnCollectionConfig(i,k)}}}}return i},_fnButtonBase:function(o,i){var x,v,k;if(i){x=o.sTag&&o.sTag!=="default"?o.sTag:this.s.tags.collection.button;v=o.sLinerTag&&o.sLinerTag!=="default"?o.sLiner:this.s.tags.collection.liner;k=this.classes.collection.buttons.normal}else{x=o.sTag&&o.sTag!=="default"?o.sTag:this.s.tags.button;v=o.sLinerTag&&o.sLinerTag!=="default"?o.sLiner:this.s.tags.liner;k=this.classes.buttons.normal}var w=n.createElement(x),j=n.createElement(v),u=this._fnGetMasterSettings();w.className=k+" "+o.sButtonClass;w.setAttribute("id","ToolTables_"+this.s.dt.sInstance+"_"+u.buttonCounter);w.appendChild(j);j.innerHTML=o.sButtonText;u.buttonCounter++;return w},_fnGetMasterSettings:function(){if(this.s.master){return this.s}else{var k=a._aInstances;for(var i=0,j=k.length;i<j;i++){if(this.dom.table==k[i].s.dt.nTable){return k[i].s}}}},_fnCollectionConfig:function(j,i){var k=n.createElement(this.s.tags.collection.container);k.style.display="none";k.className=this.classes.collection.container;i._collection=k;n.body.appendChild(k);this._fnButtonDefinations(i.aButtons,k)},_fnCollectionShow:function(k,J){var G=this,E=l(k).offset(),j=J._collection,B=E.left,C=E.top+l(k).outerHeight(),H=l(m).height(),i=l(n).height(),I=l(m).width(),F=l(n).width();j.style.position="absolute";j.style.left=B+"px";j.style.top=C+"px";j.style.display="block";l(j).css("opacity",0);var A=n.createElement("div");A.style.position="absolute";A.style.left="0px";A.style.top="0px";A.style.height=((H>i)?H:i)+"px";A.style.width=((I>F)?I:F)+"px";A.className=this.classes.collection.background;l(A).css("opacity",0);n.body.appendChild(A);n.body.appendChild(j);var z=l(j).outerWidth();var D=l(j).outerHeight();if(B+z>F){j.style.left=(F-z)+"px"}if(C+D>i){j.style.top=(C-D-l(k).outerHeight())+"px"}this.dom.collection.collection=j;this.dom.collection.background=A;setTimeout(function(){l(j).animate({opacity:1},500);l(A).animate({opacity:0.25},500)},10);this.fnResizeButtons();l(A).click(function(){G._fnCollectionHide.call(G,null,null)})},_fnCollectionHide:function(j,i){if(i!==null&&i.sExtends=="collection"){return}if(this.dom.collection.collection!==null){l(this.dom.collection.collection).animate({opacity:0},500,function(k){this.style.display="none"});l(this.dom.collection.background).animate({opacity:0},500,function(k){this.parentNode.removeChild(this)});this.dom.collection.collection=null;this.dom.collection.background=null}},_fnRowSelectConfig:function(){if(this.s.master){var q=this,i,j,r=this.s.dt,k=this.s.dt.aoOpenRows;l(r.nTable).addClass(this.classes.select.table);if(this.s.select.type==="os"){l(r.nTBody).on("mousedown.DTTT_Select","tr",function(o){if(o.shiftKey){l(r.nTBody).css("-moz-user-select","none").one("selectstart.DTTT_Select","tr",function(){return false})}});l(r.nTBody).on("mouseup.DTTT_Select","tr",function(o){l(r.nTBody).css("-moz-user-select","")})}l(r.nTBody).on("click.DTTT_Select","tr",function(p){var B=q.s.select;var o=q.s.dt.oInstance.fnGetPosition(this);if(this.parentNode!=r.nTBody){return}if(r.oInstance.fnGetData(this)===null){return}if(B.type=="os"){if(p.ctrlKey||p.metaKey){if(q.fnIsSelected(this)){q._fnRowDeselect(this,p)}else{q._fnRowSelect(this,p)}}else{if(p.shiftKey){var y=q.s.dt.aiDisplay.slice();var z=l.inArray(B.lastRow,y);var A=l.inArray(o,y);if(q.fnGetSelected().length===0||z===-1){y.splice(l.inArray(o,y)+1,y.length)}else{if(z>A){var x=A;A=z;z=x}y.splice(A+1,y.length);y.splice(0,z)}if(!q.fnIsSelected(this)){q._fnRowSelect(y,p)}else{y.splice(l.inArray(o,y),1);q._fnRowDeselect(y,p)}}else{if(q.fnIsSelected(this)&&q.fnGetSelected().length===1){q._fnRowDeselect(this,p)}else{q.fnSelectNone();q._fnRowSelect(this,p)}}}}else{if(q.fnIsSelected(this)){q._fnRowDeselect(this,p)}else{if(B.type=="single"){q.fnSelectNone();q._fnRowSelect(this,p)}else{if(B.type=="multi"){q._fnRowSelect(this,p)}}}}B.lastRow=o});r.oApi._fnCallbackReg(r,"aoRowCreatedCallback",function(o,p,t){if(r.aoData[t]._DTTT_selected){l(o).addClass(q.classes.select.row)}},"TableTools-SelectAll")}},_fnRowSelect:function(k,t){var v=this,u=this._fnSelectData(k),x=u.length===0?null:u[0].nTr,i=[],w,j;for(w=0,j=u.length;w<j;w++){if(u[w].nTr){i.push(u[w].nTr)}}if(this.s.select.preRowSelect!==null&&!this.s.select.preRowSelect.call(this,t,i,true)){return}for(w=0,j=u.length;w<j;w++){u[w]._DTTT_selected=true;if(u[w].nTr){l(u[w].nTr).addClass(v.classes.select.row)}}if(this.s.select.postSelected!==null){this.s.select.postSelected.call(this,i)}a._fnEventDispatch(this,"select",i,true)},_fnRowDeselect:function(k,t){var w=this,v=this._fnSelectData(k),i=v.length===0?null:v[0].nTr,u=[],x,j;for(x=0,j=v.length;x<j;x++){if(v[x].nTr){u.push(v[x].nTr)}}if(this.s.select.preRowSelect!==null&&!this.s.select.preRowSelect.call(this,t,u,false)){return}for(x=0,j=v.length;x<j;x++){v[x]._DTTT_selected=false;if(v[x].nTr){l(v[x].nTr).removeClass(w.classes.select.row)}}if(this.s.select.postDeselected!==null){this.s.select.postDeselected.call(this,u)}a._fnEventDispatch(this,"select",u,false)},_fnSelectData:function(q){var i=[],k,r,j;if(q.nodeName){k=this.s.dt.oInstance.fnGetPosition(q);i.push(this.s.dt.aoData[k])}else{if(typeof q.length!=="undefined"){for(r=0,j=q.length;r<j;r++){if(q[r].nodeName){k=this.s.dt.oInstance.fnGetPosition(q[r]);i.push(this.s.dt.aoData[k])}else{if(typeof q[r]==="number"){i.push(this.s.dt.aoData[q[r]])}else{i.push(q[r])}}}return i}else{i.push(q)}}return i},_fnTextConfig:function(j,k){var i=this;if(k.fnInit!==null){k.fnInit.call(this,j,k)}if(k.sToolTip!==""){j.title=k.sToolTip}l(j).hover(function(){if(k.fnMouseover!==null){k.fnMouseover.call(this,j,k,null)}},function(){if(k.fnMouseout!==null){k.fnMouseout.call(this,j,k,null)}});if(k.fnSelect!==null){a._fnEventListen(this,"select",function(p){k.fnSelect.call(i,j,k,p)})}l(j).click(function(p){if(k.fnClick!==null){k.fnClick.call(i,j,k,null,p)}if(k.fnComplete!==null){k.fnComplete.call(i,j,k,null,null)}i._fnCollectionHide(j,k)})},_fnFlashConfig:function(i,k){var p=this;var j=new d.Client();if(k.fnInit!==null){k.fnInit.call(this,i,k)}j.setHandCursor(true);if(k.sAction=="flash_save"){j.setAction("save");j.setCharSet((k.sCharSet=="utf16le")?"UTF16LE":"UTF8");j.setBomInc(k.bBomInc);j.setFileName(k.sFileName.replace("*",this.fnGetTitle(k)))}else{if(k.sAction=="flash_pdf"){j.setAction("pdf");j.setFileName(k.sFileName.replace("*",this.fnGetTitle(k)))}else{j.setAction("copy")}}j.addEventListener("mouseOver",function(o){if(k.fnMouseover!==null){k.fnMouseover.call(p,i,k,j)}});j.addEventListener("mouseOut",function(o){if(k.fnMouseout!==null){k.fnMouseout.call(p,i,k,j)}});j.addEventListener("mouseDown",function(o){if(k.fnClick!==null){k.fnClick.call(p,i,k,j)}});j.addEventListener("complete",function(r,o){if(k.fnComplete!==null){k.fnComplete.call(p,i,k,j,o)}p._fnCollectionHide(i,k)});this._fnFlashGlue(j,i,k.sToolTip)},_fnFlashGlue:function(j,r,q){var i=this;var k=r.getAttribute("id");if(n.getElementById(k)){j.glue(r,q)}else{setTimeout(function(){i._fnFlashGlue(j,r,q)},100)}},_fnFlashSetText:function(k,i){var q=this._fnChunkData(i,8192);k.clearText();for(var r=0,j=q.length;r<j;r++){k.appendText(q[r])}},_fnColumnTargets:function(r){var k=[];var q=this.s.dt;var i,j;if(typeof r=="object"){for(i=0,j=q.aoColumns.length;i<j;i++){k.push(false)}for(i=0,j=r.length;i<j;i++){k[r[i]]=true}}else{if(r=="visible"){for(i=0,j=q.aoColumns.length;i<j;i++){k.push(q.aoColumns[i].bVisible?true:false)}}else{if(r=="hidden"){for(i=0,j=q.aoColumns.length;i<j;i++){k.push(q.aoColumns[i].bVisible?false:true)}}else{if(r=="sortable"){for(i=0,j=q.aoColumns.length;i<j;i++){k.push(q.aoColumns[i].bSortable?true:false)}}else{for(i=0,j=q.aoColumns.length;i<j;i++){k.push(true)}}}}}return k},_fnNewline:function(i){if(i.sNewLine=="auto"){return navigator.userAgent.match(/Windows/)?"\r\n":"\n"}else{return i.sNewLine}},_fnGetDataTablesData:function(L){var O,j,i,J;var R,P=[],T="",S;var k=this.s.dt,Q,G;var N=new RegExp(L.sFieldBoundary,"g");var E=this._fnColumnTargets(L.mColumns);var M=(typeof L.bSelectedOnly!="undefined")?L.bSelectedOnly:false;if(L.bHeader){R=[];for(O=0,j=k.aoColumns.length;O<j;O++){if(E[O]){T=k.aoColumns[O].sTitle.replace(/\n/g," ").replace(/<.*?>/g,"").replace(/^\s+|\s+$/g,"");T=this._fnHtmlDecode(T);R.push(this._fnBoundData(T,L.sFieldBoundary,N))}}P.push(R.join(L.sFieldSeperator))}var K=this.fnGetSelected();M=this.s.select.type!=="none"&&M&&K.length!==0;var I=k.oInstance.$("tr",L.oSelectorOpts).map(function(o,p){return M&&l.inArray(p,K)===-1?null:k.oInstance.fnGetPosition(p)}).get();for(i=0,J=I.length;i<J;i++){Q=k.aoData[I[i]].nTr;R=[];for(O=0,j=k.aoColumns.length;O<j;O++){if(E[O]){var F=k.oApi._fnGetCellData(k,I[i],O,"display");if(L.fnCellRender){T=L.fnCellRender(F,O,Q,I[i])+""}else{if(typeof F=="string"){T=F.replace(/\n/g," ");T=T.replace(/<img.*?\s+alt\s*=\s*(?:"([^"]+)"|'([^']+)'|([^\s>]+)).*?>/gi,"$1$2$3");T=T.replace(/<.*?>/g,"")}else{T=F+""}}T=T.replace(/^\s+/,"").replace(/\s+$/,"");T=this._fnHtmlDecode(T);R.push(this._fnBoundData(T,L.sFieldBoundary,N))}}P.push(R.join(L.sFieldSeperator));if(L.bOpenRows){S=l.grep(k.aoOpenRows,function(o){return o.nParent===Q});if(S.length===1){T=this._fnBoundData(l("td",S[0].nTr).html(),L.sFieldBoundary,N);P.push(T)}}}if(L.bFooter&&k.nTFoot!==null){R=[];for(O=0,j=k.aoColumns.length;O<j;O++){if(E[O]&&k.aoColumns[O].nTf!==null){T=k.aoColumns[O].nTf.innerHTML.replace(/\n/g," ").replace(/<.*?>/g,"");T=this._fnHtmlDecode(T);R.push(this._fnBoundData(T,L.sFieldBoundary,N))}}P.push(R.join(L.sFieldSeperator))}var H=P.join(this._fnNewline(L));return H},_fnBoundData:function(j,k,i){if(k===""){return j}else{return k+j.replace(i,k+k)+k}},_fnChunkData:function(j,r){var q=[];var k=j.length;for(var i=0;i<k;i+=r){if(i+r<k){q.push(j.substring(i,i+r))}else{q.push(j.substring(i,k))}}return q},_fnHtmlDecode:function(j){if(j.indexOf("&")===-1){return j}var i=n.createElement("div");return j.replace(/&([^\s]*);/g,function(p,k){if(p.substr(1,1)==="#"){return String.fromCharCode(Number(k.substr(1)))}else{i.innerHTML=p;return i.childNodes[0].nodeValue}})},_fnPrintStart:function(s){var t=this;var v=this.s.dt;this._fnPrintHideNodes(v.nTable);this.s.print.saveStart=v._iDisplayStart;this.s.print.saveLength=v._iDisplayLength;if(s.bShowAll){v._iDisplayStart=0;v._iDisplayLength=-1;if(v.oApi._fnCalculateEnd){v.oApi._fnCalculateEnd(v)}v.oApi._fnDraw(v)}if(v.oScroll.sX!==""||v.oScroll.sY!==""){this._fnPrintScrollStart(v);l(this.s.dt.nTable).bind("draw.DTTT_Print",function(){t._fnPrintScrollStart(v)})}var i=v.aanFeatures;for(var k in i){if(k!="i"&&k!="t"&&k.length==1){for(var u=0,j=i[k].length;u<j;u++){this.dom.print.hidden.push({node:i[k][u],display:"block"});i[k][u].style.display="none"}}}l(n.body).addClass(this.classes.print.body);if(s.sInfo!==""){this.fnInfo(s.sInfo,3000)}if(s.sMessage){l("<div/>").addClass(this.classes.print.message).html(s.sMessage).prepend("body")}this.s.print.saveScroll=l(m).scrollTop();m.scrollTo(0,0);l(n).bind("keydown.DTTT",function(o){if(o.keyCode==27){o.preventDefault();t._fnPrintEnd.call(t,o)}})},_fnPrintEnd:function(k){var r=this;var j=this.s.dt;var q=this.s.print;var i=this.dom.print;this._fnPrintShowNodes();if(j.oScroll.sX!==""||j.oScroll.sY!==""){l(this.s.dt.nTable).unbind("draw.DTTT_Print");this._fnPrintScrollEnd()}m.scrollTo(0,q.saveScroll);if(i.message!==null){n.body.removeChild(i.message);i.message=null}l(n.body).removeClass("DTTT_Print");j._iDisplayStart=q.saveStart;j._iDisplayLength=q.saveLength;if(j.oApi._fnCalculateEnd){j.oApi._fnCalculateEnd(j)}j.oApi._fnDraw(j);l(n).unbind("keydown.DTTT")},_fnPrintScrollStart:function(){var t=this.s.dt,r=t.nScrollHead.getElementsByTagName("div")[0],j=r.getElementsByTagName("table")[0],k=t.nTable.parentNode,i,s;i=t.nTable.getElementsByTagName("thead");if(i.length>0){t.nTable.removeChild(i[0])}if(t.nTFoot!==null){s=t.nTable.getElementsByTagName("tfoot");if(s.length>0){t.nTable.removeChild(s[0])}}i=t.nTHead.cloneNode(true);t.nTable.insertBefore(i,t.nTable.childNodes[0]);if(t.nTFoot!==null){s=t.nTFoot.cloneNode(true);t.nTable.insertBefore(s,t.nTable.childNodes[1])}if(t.oScroll.sX!==""){t.nTable.style.width=l(t.nTable).outerWidth()+"px";k.style.width=l(t.nTable).outerWidth()+"px";k.style.overflow="visible"}if(t.oScroll.sY!==""){k.style.height=l(t.nTable).outerHeight()+"px";k.style.overflow="visible"}},_fnPrintScrollEnd:function(){var j=this.s.dt,i=j.nTable.parentNode;if(j.oScroll.sX!==""){i.style.width=j.oApi._fnStringToCss(j.oScroll.sX);i.style.overflow="auto"}if(j.oScroll.sY!==""){i.style.height=j.oApi._fnStringToCss(j.oScroll.sY);i.style.overflow="auto"}},_fnPrintShowNodes:function(){var k=this.dom.print.hidden;for(var i=0,j=k.length;i<j;i++){k[i].node.style.display=k[i].display}k.splice(0,k.length)},_fnPrintHideNodes:function(i){var u=this.dom.print.hidden;var s=i.parentNode;var k=s.childNodes;for(var v=0,j=k.length;v<j;v++){if(k[v]!=i&&k[v].nodeType==1){var t=l(k[v]).css("display");if(t!="none"){u.push({node:k[v],display:t});k[v].style.display="none"}}}if(s.nodeName.toUpperCase()!="BODY"){this._fnPrintHideNodes(s)}}};a._aInstances=[];a._aListeners=[];a.fnGetMasters=function(){var i=[];for(var k=0,j=a._aInstances.length;k<j;k++){if(a._aInstances[k].s.master){i.push(a._aInstances[k])}}return i};a.fnGetInstance=function(k){if(typeof k!="object"){k=n.getElementById(k)}for(var i=0,j=a._aInstances.length;i<j;i++){if(a._aInstances[i].s.master&&a._aInstances[i].dom.table==k){return a._aInstances[i]}}return null};a._fnEventListen=function(k,i,j){a._aListeners.push({that:k,type:i,fn:j})};a._fnEventDispatch=function(k,t,s,u){var v=a._aListeners;for(var i=0,j=v.length;i<j;i++){if(k.dom.table==v[i].that.dom.table&&v[i].type==t){v[i].fn(s,u)}}};a.buttonBase={sAction:"text",sTag:"default",sLinerTag:"default",sButtonClass:"DTTT_button_text",sButtonText:"Button text",sTitle:"",sToolTip:"",sCharSet:"utf8",bBomInc:false,sFileName:"*.csv",sFieldBoundary:"",sFieldSeperator:"\t",sNewLine:"auto",mColumns:"all",bHeader:true,bFooter:true,bOpenRows:false,bSelectedOnly:false,oSelectorOpts:g,fnMouseover:null,fnMouseout:null,fnClick:null,fnSelect:null,fnComplete:null,fnInit:null,fnCellRender:null};a.BUTTONS={csv:l.extend({},a.buttonBase,{sAction:"flash_save",sButtonClass:"DTTT_button_csv",sButtonText:"CSV",sFieldBoundary:'"',sFieldSeperator:",",fnClick:function(i,k,j){this.fnSetText(j,this.fnGetTableData(k))}}),xls:l.extend({},a.buttonBase,{sAction:"flash_save",sCharSet:"utf16le",bBomInc:true,sButtonClass:"DTTT_button_xls",sButtonText:"Excel",fnClick:function(i,k,j){this.fnSetText(j,this.fnGetTableData(k))}}),copy:l.extend({},a.buttonBase,{sAction:"flash_copy",sButtonClass:"DTTT_button_copy",sButtonText:"Copy",fnClick:function(i,k,j){this.fnSetText(j,this.fnGetTableData(k))},fnComplete:function(t,s,u,k){var i=k.split("\n").length,j=this.s.dt.nTFoot===null?i-1:i-2,v=(j==1)?"":"s";this.fnInfo("<h6>Table copied</h6><p>Copied "+j+" row"+v+" to the clipboard.</p>",1500)}}),pdf:l.extend({},a.buttonBase,{sAction:"flash_pdf",sNewLine:"\n",sFileName:"*.pdf",sButtonClass:"DTTT_button_pdf",sButtonText:"PDF",sPdfOrientation:"portrait",sPdfSize:"A4",sPdfMessage:"",fnClick:function(i,k,j){this.fnSetText(j,"title:"+this.fnGetTitle(k)+"\nmessage:"+k.sPdfMessage+"\ncolWidth:"+this.fnCalcColRatios(k)+"\norientation:"+k.sPdfOrientation+"\nsize:"+k.sPdfSize+"\n--/TableToolsOpts--\n"+this.fnGetTableData(k))}}),print:l.extend({},a.buttonBase,{sInfo:"<h6>Print view</h6><p>Please use your browser's print function to print this table. Press escape when finished.</p>",sMessage:null,bShowAll:true,sToolTip:"View print view",sButtonClass:"DTTT_button_print",sButtonText:"Print",fnClick:function(j,i){this.fnPrint(true,i)}}),text:l.extend({},a.buttonBase),select:l.extend({},a.buttonBase,{sButtonText:"Select button",fnSelect:function(j,i){if(this.fnGetSelected().length!==0){l(j).removeClass(this.classes.buttons.disabled)}else{l(j).addClass(this.classes.buttons.disabled)}},fnInit:function(j,i){l(j).addClass(this.classes.buttons.disabled)}}),select_single:l.extend({},a.buttonBase,{sButtonText:"Select button",fnSelect:function(i,k){var j=this.fnGetSelected().length;if(j==1){l(i).removeClass(this.classes.buttons.disabled)}else{l(i).addClass(this.classes.buttons.disabled)}},fnInit:function(j,i){l(j).addClass(this.classes.buttons.disabled)}}),select_all:l.extend({},a.buttonBase,{sButtonText:"Select all",fnClick:function(j,i){this.fnSelectAll()},fnSelect:function(j,i){if(this.fnGetSelected().length==this.s.dt.fnRecordsDisplay()){l(j).addClass(this.classes.buttons.disabled)}else{l(j).removeClass(this.classes.buttons.disabled)}}}),select_none:l.extend({},a.buttonBase,{sButtonText:"Deselect all",fnClick:function(j,i){this.fnSelectNone()},fnSelect:function(j,i){if(this.fnGetSelected().length!==0){l(j).removeClass(this.classes.buttons.disabled)}else{l(j).addClass(this.classes.buttons.disabled)}},fnInit:function(j,i){l(j).addClass(this.classes.buttons.disabled)}}),ajax:l.extend({},a.buttonBase,{sAjaxUrl:"/xhr.php",sButtonText:"Ajax button",fnClick:function(i,k){var j=this.fnGetTableData(k);l.ajax({url:k.sAjaxUrl,data:[{name:"tableData",value:j}],success:k.fnAjaxComplete,dataType:"json",type:"POST",cache:false,error:function(){alert("Error detected when sending table data to server")}})},fnAjaxComplete:function(i){alert("Ajax complete")}}),div:l.extend({},a.buttonBase,{sAction:"div",sTag:"div",sButtonClass:"DTTT_nonbutton",sButtonText:"Text button"}),collection:l.extend({},a.buttonBase,{sAction:"collection",sButtonClass:"DTTT_button_collection",sButtonText:"Collection",fnClick:function(j,i){this._fnCollectionShow(j,i)}})};a.buttons=a.BUTTONS;a.classes={container:"DTTT_container",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"},collection:{container:"DTTT_collection",background:"DTTT_collection_background",buttons:{normal:"DTTT_button",disabled:"DTTT_disabled"}},select:{table:"DTTT_selectable",row:"DTTT_selected selected"},print:{body:"DTTT_Print",info:"DTTT_print_info",message:"DTTT_PrintMessage"}};a.classes_themeroller={container:"DTTT_container ui-buttonset ui-buttonset-multi",buttons:{normal:"DTTT_button ui-button ui-state-default"},collection:{container:"DTTT_collection ui-buttonset ui-buttonset-multi"}};a.DEFAULTS={sSwfPath:"../swf/copy_csv_xls_pdf.swf",sRowSelect:"none",sSelectedClass:null,fnPreRowSelect:null,fnRowSelected:null,fnRowDeselected:null,aButtons:["copy","csv","xls","pdf","print"],oTags:{container:"div",button:"a",liner:"span",collection:{container:"div",button:"a",liner:"span"}}};a.defaults=a.DEFAULTS;a.prototype.CLASS="TableTools";a.version="2.2.0-dev";if(l.fn.dataTable.Api){l.fn.dataTable.Api.register("tabletools()",function(){var i=null;if(this.context.length>0){i=a.fnGetInstance(this.context[0].nTable)}return i})}if(typeof l.fn.dataTable=="function"&&typeof l.fn.dataTableExt.fnVersionCheck=="function"&&l.fn.dataTableExt.fnVersionCheck("1.9.0")){l.fn.dataTableExt.aoFeatures.push({fnInit:function(k){var p=k.oInit;var i=p.tableTools||p.oTableTools||{};var j=new a(k.oInstance,i);a._aInstances.push(j);return j.dom.container},cFeature:"T",sFeature:"TableTools"})}else{alert("Warning: TableTools requires DataTables 1.9.0 or newer - www.datatables.net/download")}l.fn.DataTable.TableTools=a})(jQuery,h,f);if(typeof b.fn.dataTable=="function"&&typeof b.fn.dataTableExt.fnVersionCheck=="function"&&b.fn.dataTableExt.fnVersionCheck("1.9.0")){b.fn.dataTableExt.aoFeatures.push({fnInit:function(l){var m=typeof l.oInit.oTableTools!="undefined"?l.oInit.oTableTools:{};var n=new a(l.oInstance,m);a._aInstances.push(n);return n.dom.container},cFeature:"T",sFeature:"TableTools"})}else{alert("Warning: TableTools 2 requires DataTables 1.9.0 or newer - www.datatables.net/download")}b.fn.dataTable.TableTools=a;b.fn.DataTable.TableTools=a;return a};e(jQuery,jQuery.fn.dataTable)})(window,document);