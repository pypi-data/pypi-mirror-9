(function(i,k,h){function j(a){var b=[];for(var c=0,d=a.length;c<d;c++){b[a[c]]=c}return b}function l(c,a,b){var d=c.splice(a,1)[0];c.splice(b,0,d)}function g(c,o,a){var d=[];for(var e=0,f=c.childNodes.length;e<f;e++){if(c.childNodes[e].nodeType==1){d.push(c.childNodes[e])}}var b=d[o];if(a!==null){c.insertBefore(b,d[a])}else{c.appendChild(b)}}i.fn.dataTableExt.oApi.fnColReorder=function(x,z,a){var d,w,e,B,A=x.aoColumns.length,C,f;if(z==a){return}if(z<0||z>=A){this.oApi._fnLog(x,1,"ColReorder 'from' index is out of bounds: "+z);return}if(a<0||a>=A){this.oApi._fnLog(x,1,"ColReorder 'to' index is out of bounds: "+a);return}var b=[];for(d=0,w=A;d<w;d++){b[d]=d}l(b,z,a);var D=j(b);for(d=0,w=x.aaSorting.length;d<w;d++){x.aaSorting[d][0]=D[x.aaSorting[d][0]]}if(x.aaSortingFixed!==null){for(d=0,w=x.aaSortingFixed.length;d<w;d++){x.aaSortingFixed[d][0]=D[x.aaSortingFixed[d][0]]}}for(d=0,w=A;d<w;d++){f=x.aoColumns[d];for(e=0,B=f.aDataSort.length;e<B;e++){f.aDataSort[e]=D[f.aDataSort[e]]}}for(d=0,w=A;d<w;d++){f=x.aoColumns[d];if(typeof f.mData=="number"){f.mData=D[f.mData];f.fnGetData=x.oApi._fnGetObjectDataFn(f.mData);f.fnSetData=x.oApi._fnSetObjectDataFn(f.mData)}}if(x.aoColumns[z].bVisible){var y=this.oApi._fnColumnIndexToVisible(x,z);var c=null;d=a<z?a:a+1;while(c===null&&d<A){c=this.oApi._fnColumnIndexToVisible(x,d);d++}C=x.nTHead.getElementsByTagName("tr");for(d=0,w=C.length;d<w;d++){g(C[d],y,c)}if(x.nTFoot!==null){C=x.nTFoot.getElementsByTagName("tr");for(d=0,w=C.length;d<w;d++){g(C[d],y,c)}}for(d=0,w=x.aoData.length;d<w;d++){if(x.aoData[d].nTr!==null){g(x.aoData[d].nTr,y,c)}}}l(x.aoColumns,z,a);l(x.aoPreSearchCols,z,a);for(d=0,w=x.aoData.length;d<w;d++){if(i.isArray(x.aoData[d]._aData)){l(x.aoData[d]._aData,z,a)}l(x.aoData[d]._anHidden,z,a)}for(d=0,w=x.aoHeader.length;d<w;d++){l(x.aoHeader[d],z,a)}if(x.aoFooter!==null){for(d=0,w=x.aoFooter.length;d<w;d++){l(x.aoFooter[d],z,a)}}for(d=0,w=A;d<w;d++){x.aoColumns[d].aDataSort=[d];x.aoColumns[d]._ColReorder_iOrigCol=d;i(x.aoColumns[d].nTh).unbind("click");this.oApi._fnSortAttachListener(x,x.aoColumns[d].nTh,d)}if(typeof ColVis!="undefined"){ColVis.fnRebuild(x.oInstance)}i(x.oInstance).trigger("column-reorder",[x,{iFrom:z,iTo:a,aiInvertMapping:D}]);if(typeof x.oInstance._oPluginFixedHeader!="undefined"){x.oInstance._oPluginFixedHeader.fnUpdate()}};ColReorder=function(a,b){if(!this.CLASS||this.CLASS!="ColReorder"){alert("Warning: ColReorder must be initialised with the keyword 'new'")}if(typeof b=="undefined"){b={}}this.s={dt:null,init:b,allowReorder:true,allowResize:true,fixed:0,dropCallback:null,mouse:{startX:-1,startY:-1,offsetX:-1,offsetY:-1,target:-1,targetIndex:-1,fromIndex:-1},aoTargets:[]};this.dom={drag:null,resize:null,pointer:null};this.table_size=-1;this.s.dt=a.oInstance.fnSettings();this._fnConstruct();a.oApi._fnCallbackReg(a,"aoDestroyCallback",jQuery.proxy(this._fnDestroy,this),"ColReorder");ColReorder.aoInstances.push(this);return this};ColReorder.prototype={fnReset:function(){var b=[];for(var a=0,c=this.s.dt.aoColumns.length;a<c;a++){b.push(this.s.dt.aoColumns[a]._ColReorder_iOrigCol)}this._fnOrderColumns(b)},_fnConstruct:function(){var a=this;var b,f;if(typeof this.s.init.allowReorder!="undefined"){this.s.allowReorder=this.s.init.allowReorder}if(typeof this.s.init.allowResize!="undefined"){this.s.allowResize=this.s.init.allowResize}if(typeof this.s.init.iFixedColumns!="undefined"){this.s.fixed=this.s.init.iFixedColumns}if(typeof this.s.init.fnReorderCallback!="undefined"){this.s.dropCallback=this.s.init.fnReorderCallback}for(b=0,f=this.s.dt.aoColumns.length;b<f;b++){if(b>this.s.fixed-1){this._fnMouseListener(b,this.s.dt.aoColumns[b].nTh)}this.s.dt.aoColumns[b]._ColReorder_iOrigCol=b}this.s.dt.oApi._fnCallbackReg(this.s.dt,"aoStateSaveParams",function(m,o){a._fnStateSave.call(a,o)},"ColReorder_State");var e=null;if(typeof this.s.init.aiOrder!="undefined"){e=this.s.init.aiOrder.slice()}if(this.s.dt.oLoadedState&&typeof this.s.dt.oLoadedState.ColReorder!="undefined"&&this.s.dt.oLoadedState.ColReorder.length==this.s.dt.aoColumns.length){e=this.s.dt.oLoadedState.ColReorder}if(e){if(!a.s.dt._bInitComplete){var c=false;this.s.dt.aoDrawCallback.push({fn:function(){if(!a.s.dt._bInitComplete&&!c){c=true;var m=j(e);a._fnOrderColumns.call(a,m)}},sName:"ColReorder_Pre"})}else{var d=j(e);a._fnOrderColumns.call(a,d)}}},_fnOrderColumns:function(c){if(c.length!=this.s.dt.aoColumns.length){this.s.dt.oInstance.oApi._fnLog(oDTSettings,1,"ColReorder - array reorder does not match known number of columns. Skipping.");return}for(var b=0,d=c.length;b<d;b++){var a=i.inArray(b,c);if(b!=a){l(c,a,b);this.s.dt.oInstance.fnColReorder(a,b)}}if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing()}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt)},_fnStateSave:function(e){var d,f,c,b;var a=this.s.dt;for(d=0;d<e.aaSorting.length;d++){e.aaSorting[d][0]=a.aoColumns[e.aaSorting[d][0]]._ColReorder_iOrigCol}aSearchCopy=i.extend(true,[],e.aoSearchCols);e.ColReorder=[];for(d=0,f=a.aoColumns.length;d<f;d++){b=a.aoColumns[d]._ColReorder_iOrigCol;e.aoSearchCols[b]=aSearchCopy[d];e.abVisCols[b]=a.aoColumns[d].bVisible;e.ColReorder.push(b)}},_fnMouseListener:function(c,a){var b=this;i(a).unbind("mousemove.ColReorder");i(a).unbind("mousedown.ColReorder");if(this.s.allowResize){i(a).bind("mousemove.ColReorder",function(e){if(b.dom.drag===null&&b.dom.resize===null){var n=e.target.nodeName=="TH"?e.target:i(e.target).parents("TH")[0];var d=i(n).offset();var f=i(n).innerWidth();if(Math.abs(e.pageX-Math.round(d.left+f))<=5){i(n).css({cursor:"col-resize"})}else{i(n).css({cursor:"pointer"})}}})}i(a).bind("mousedown.ColReorder",function(d){b._fnMouseDown.call(b,d,a,c);return false})},_fnMouseDown:function(c,u,e){var d=this,a=this.s.dt.aoColumns;if(i(u).css("cursor")=="col-resize"){this.s.mouse.startX=c.pageX;this.s.mouse.startWidth=i(u).width();this.s.mouse.resizeElem=i(u);var t=i(u).next();this.s.mouse.nextStartWidth=i(t).width();d.dom.resize=true;this.s.dt.aoColumns[e].bSortable=false;this.s.dt.oFeatures.bAutoWidth=false}else{if(this.s.allowReorder){d.dom.resize=null;var b=c.target.nodeName=="TH"?c.target:i(c.target).parents("TH")[0];var f=i(b).offset();this.s.mouse.startX=c.pageX;this.s.mouse.startY=c.pageY;this.s.mouse.offsetX=c.pageX-f.left;this.s.mouse.offsetY=c.pageY-f.top;this.s.mouse.target=u;this.s.mouse.targetIndex=i("th",u.parentNode).index(u);this.s.mouse.fromIndex=this.s.dt.oInstance.oApi._fnVisibleToColumnIndex(this.s.dt,this.s.mouse.targetIndex);this.s.aoTargets.splice(0,this.s.aoTargets.length);this.s.aoTargets.push({x:i(this.s.dt.nTable).offset().left,to:0});var r=0;for(var e=0,s=a.length;e<s;e++){if(e!=this.s.mouse.fromIndex){r++}if(a[e].bVisible){this.s.aoTargets.push({x:i(a[e].nTh).offset().left+i(a[e].nTh).outerWidth(),to:r})}}if(this.s.fixed!==0){this.s.aoTargets.splice(0,this.s.fixed)}}}i(h).bind("mousemove.ColReorder",function(m){d._fnMouseMove.call(d,m,e)});i(h).bind("mouseup.ColReorder",function(m){setTimeout(function(){d._fnMouseUp.call(d,m,e)},10)})},_fnMouseMove:function(a,c){var b=this;var t;t=this.s.dt.oInit.sScrollX===""?false:true;if(this.table_size<0&&t&&i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)!=undefined){if(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper).length>0){this.table_size=i(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)[0].childNodes[0].childNodes[0]).width()}}if(this.dom.resize){var w=this.s.mouse.resizeElem;var v=i(w).next();var y=a.pageX-this.s.mouse.startX;if(y!=0&&!t){i(v).width(this.s.mouse.nextStartWidth-y)}i(w).width(this.s.mouse.startWidth+y);if(t&&i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)!=undefined){if(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper).length>0){i(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)[0].childNodes[0].childNodes[0]).width(this.table_size+y)}}var e;if(i("div.dataTables_scrollBody")!=null){if(i("div.dataTables_scrollBody").length>0){var x;e=-1;for(x=-1;x<this.s.dt.aoColumns.length-1&&x!=c;x++){if(this.s.dt.aoColumns[x+1].bVisible){e++}}tableScroller=i("div.dataTables_scrollBody",this.s.dt.nTableWrapper)[0];scrollingTableHead=i(tableScroller)[0].childNodes[0].childNodes[0].childNodes[0];if(y!=0&&!t){i(i(scrollingTableHead)[0].childNodes[e+1]).width(this.s.mouse.nextStartWidth-y)}i(i(scrollingTableHead)[0].childNodes[e]).width(this.s.mouse.startWidth+y);if(t){i(i(tableScroller)[0].childNodes[0]).width(this.table_size+y)}}}return}else{if(this.s.allowReorder){if(this.dom.drag===null){if(Math.pow(Math.pow(a.pageX-this.s.mouse.startX,2)+Math.pow(a.pageY-this.s.mouse.startY,2),0.5)<5){return}this._fnCreateDragNode()}this.dom.drag.style.left=(a.pageX-this.s.mouse.offsetX)+"px";this.dom.drag.style.top=(a.pageY-this.s.mouse.offsetY)+"px";var f=false;for(var d=1,u=this.s.aoTargets.length;d<u;d++){if(a.pageX<this.s.aoTargets[d-1].x+((this.s.aoTargets[d].x-this.s.aoTargets[d-1].x)/2)){this.dom.pointer.style.left=this.s.aoTargets[d-1].x+"px";this.s.mouse.toIndex=this.s.aoTargets[d-1].to;f=true;break}}if(!f){this.dom.pointer.style.left=this.s.aoTargets[this.s.aoTargets.length-1].x+"px";this.s.mouse.toIndex=this.s.aoTargets[this.s.aoTargets.length-1].to}}}},_fnMouseUp:function(c,r){var d=this;i(h).unbind("mousemove.ColReorder");i(h).unbind("mouseup.ColReorder");if(this.dom.drag!==null){h.body.removeChild(this.dom.drag);h.body.removeChild(this.dom.pointer);this.dom.drag=null;this.dom.pointer=null;this.s.dt.oInstance.fnColReorder(this.s.mouse.fromIndex,this.s.mouse.toIndex);if(this.s.dt.oScroll.sX!==""||this.s.dt.oScroll.sY!==""){this.s.dt.oInstance.fnAdjustColumnSizing()}if(this.s.dropCallback!==null){this.s.dropCallback.call(this)}this._fnConstruct();this.s.dt.oInstance.oApi._fnSaveState(this.s.dt)}else{if(this.dom.resize!==null){var f;var s;var b;var e;var a;var t;this.s.dt.aoColumns[r].bSortable=true;this.s.dt.aoColumns[r].sWidth=i(this.s.mouse.resizeElem).innerWidth()+"px";t=this.s.dt.oInit.sScrollX===""?false:true;if(!t){for(e=r+1;e<this.s.dt.aoColumns.length;e++){if(this.s.dt.aoColumns[e].bVisible){break}}for(a=r-1;a>=0;a--){if(this.s.dt.aoColumns[a].bVisible){break}}if(this.s.dt.aoColumns.length>e){this.s.dt.aoColumns[e].sWidth=i(this.s.mouse.resizeElem).next().innerWidth()+"px"}else{b=this.s.mouse.resizeElem;for(f=a;f>0;f--){if(this.s.dt.aoColumns[f].bVisible){b=i(b).prev();this.s.dt.aoColumns[f].sWidth=i(b).innerWidth()+"px"}}}}if(t&&i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)!=undefined){if(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper).length>0){this.table_size=i(i("div.dataTables_scrollHead",this.s.dt.nTableWrapper)[0].childNodes[0].childNodes[0]).width()}}this.s.dt.oInstance.oApi._fnSaveState(this.s.dt)}}this.dom.resize=null},_fnCreateDragNode:function(){var a=this;this.dom.drag=i(this.s.dt.nTHead.parentNode).clone(true)[0];this.dom.drag.className+=" DTCR_clonedTable";while(this.dom.drag.getElementsByTagName("caption").length>0){this.dom.drag.removeChild(this.dom.drag.getElementsByTagName("caption")[0])}while(this.dom.drag.getElementsByTagName("tbody").length>0){this.dom.drag.removeChild(this.dom.drag.getElementsByTagName("tbody")[0])}while(this.dom.drag.getElementsByTagName("tfoot").length>0){this.dom.drag.removeChild(this.dom.drag.getElementsByTagName("tfoot")[0])}i("thead tr:eq(0)",this.dom.drag).each(function(){i("th:not(:eq("+a.s.mouse.targetIndex+"))",this).remove()});i("tr",this.dom.drag).height(i("tr:eq(0)",a.s.dt.nTHead).height());i("thead tr:gt(0)",this.dom.drag).remove();i("thead th:eq(0)",this.dom.drag).each(function(b){this.style.width=i("th:eq("+a.s.mouse.targetIndex+")",a.s.dt.nTHead).width()+"px"});this.dom.drag.style.position="absolute";this.dom.drag.style.zIndex=1200;this.dom.drag.style.top="0px";this.dom.drag.style.left="0px";this.dom.drag.style.width=i("th:eq("+a.s.mouse.targetIndex+")",a.s.dt.nTHead).outerWidth()+"px";this.dom.pointer=h.createElement("div");this.dom.pointer.className="DTCR_pointer";this.dom.pointer.style.position="absolute";if(this.s.dt.oScroll.sX===""&&this.s.dt.oScroll.sY===""){this.dom.pointer.style.top=i(this.s.dt.nTable).offset().top+"px";this.dom.pointer.style.height=i(this.s.dt.nTable).height()+"px"}else{this.dom.pointer.style.top=i("div.dataTables_scroll",this.s.dt.nTableWrapper).offset().top+"px";this.dom.pointer.style.height=i("div.dataTables_scroll",this.s.dt.nTableWrapper).height()+"px"}h.body.appendChild(this.dom.pointer);h.body.appendChild(this.dom.drag)},_fnDestroy:function(){for(var a=0,b=ColReorder.aoInstances.length;a<b;a++){if(ColReorder.aoInstances[a]===this){ColReorder.aoInstances.splice(a,1);break}}i(this.s.dt.nTHead).find("*").unbind(".ColReorder");this.s.dt.oInstance._oPluginColReorder=null;this.s=null}};ColReorder.aoInstances=[];ColReorder.fnReset=function(b){for(var a=0,c=ColReorder.aoInstances.length;a<c;a++){if(ColReorder.aoInstances[a].s.dt.oInstance==b){ColReorder.aoInstances[a].fnReset()}}};ColReorder.prototype.CLASS="ColReorder";ColReorder.VERSION="1.0.7";ColReorder.prototype.VERSION=ColReorder.VERSION;if(typeof i.fn.dataTable=="function"&&typeof i.fn.dataTableExt.fnVersionCheck=="function"&&i.fn.dataTableExt.fnVersionCheck("1.9.3")){i.fn.dataTableExt.aoFeatures.push({fnInit:function(a){var c=a.oInstance;if(typeof c._oPluginColReorder=="undefined"){var b=typeof a.oInit.oColReorder!="undefined"?a.oInit.oColReorder:{};c._oPluginColReorder=new ColReorder(a,b)}else{c.oApi._fnLog(a,1,"ColReorder attempted to initialise twice. Ignoring second")}return null},cFeature:"R",sFeature:"ColReorder"})}else{alert("Warning: ColReorder requires DataTables 1.9.3 or greater - www.datatables.net/download")}})(jQuery,window,document);