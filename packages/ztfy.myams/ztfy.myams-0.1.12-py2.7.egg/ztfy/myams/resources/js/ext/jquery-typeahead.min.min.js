(function(J){var u={isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:false},isBlankString:function(a){return !a||/^\s*$/.test(a)},escapeRegExChars:function(a){return a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(a){return typeof a==="string"},isNumber:function(a){return typeof a==="number"},isArray:J.isArray,isFunction:J.isFunction,isObject:J.isPlainObject,isUndefined:function(a){return typeof a==="undefined"},bind:J.proxy,each:function(a,c){J.each(a,b);function b(e,d){return c(d,e)}},map:J.map,filter:J.grep,every:function(b,a){var c=true;if(!b){return c}J.each(b,function(e,d){if(!(c=a.call(null,d,e,b))){return false}});return !!c},some:function(b,a){var c=false;if(!b){return c}J.each(b,function(e,d){if(c=a.call(null,d,e,b)){return false}});return !!c},mixin:J.extend,getUniqueId:function(){var a=0;return function(){return a++}}(),templatify:function G(a){return J.isFunction(a)?a:b;function b(){return String(a)}},defer:function(a){setTimeout(a,0)},debounce:function(c,a,d){var b,e;return function(){var i=this,f=arguments,g,h;g=function(){b=null;if(!d){e=c.apply(i,f)}};h=d&&!b;clearTimeout(b);b=setTimeout(g,a);if(h){e=c.apply(i,f)}return e}},throttle:function(h,b){var c,d,g,f,a,e;a=0;e=function(){a=new Date();g=null;f=h.apply(c,d)};return function(){var j=new Date(),i=b-(j-a);c=this;d=arguments;if(i<=0){clearTimeout(g);g=null;a=j;f=h.apply(c,d)}else{if(!g){g=setTimeout(e,i)}}return f}},noop:function(){}};var x="0.10.0";var H=function(e,h){function a(j){this.maxSize=j||100;this.size=0;this.hash={};this.list=new b()}u.mixin(a.prototype,{set:function d(m,j){var k=this.list.tail,l;if(this.size>=this.maxSize){this.list.remove(k);delete this.hash[k.key]}if(l=this.hash[m]){l.val=j;this.list.moveToFront(l)}else{l=new f(m,j);this.list.add(l);this.hash[m]=l;this.size++}},get:function i(k){var j=this.hash[k];if(j){this.list.moveToFront(j);return j.val}}});function b(){this.head=this.tail=null}u.mixin(b.prototype,{add:function c(j){if(this.head){j.next=this.head;this.head.prev=j}this.head=j;this.tail=this.tail||j},remove:function g(j){j.prev?j.prev.next=j.next:this.head=j.next;j.next?j.next.prev=j.prev:this.tail=j.prev},moveToFront:function(j){this.remove(j);this.add(j)}});function f(k,j){this.key=k;this.val=j;this.prev=this.next=null}return a}(this);var w=function(){var e,d;try{e=window.localStorage;e.setItem("~~~","!");e.removeItem("~~~")}catch(g){e=null}function b(h){this.prefix=["__",h,"__"].join("");this.ttlKey="__ttl__";this.keyMatcher=new RegExp("^"+this.prefix)}if(e&&window.JSON){d={_prefix:function(h){return this.prefix+h},_ttlKey:function(h){return this._prefix(h)+this.ttlKey},get:function(h){if(this.isExpired(h)){this.remove(h)}return f(e.getItem(this._prefix(h)))},set:function(j,i,h){if(u.isNumber(h)){e.setItem(this._ttlKey(j),a(c()+h))}else{e.removeItem(this._ttlKey(j))}return e.setItem(this._prefix(j),a(i))},remove:function(h){e.removeItem(this._ttlKey(h));e.removeItem(this._prefix(h));return this},clear:function(){var j,k,i=[],h=e.length;for(j=0;j<h;j++){if((k=e.key(j)).match(this.keyMatcher)){i.push(k.replace(this.keyMatcher,""))}}for(j=i.length;j--;){this.remove(i[j])}return this},isExpired:function(i){var h=f(e.getItem(this._ttlKey(i)));return u.isNumber(h)&&c()>h?true:false}}}else{d={get:u.noop,set:u.noop,remove:u.noop,clear:u.noop,isExpired:u.noop}}u.mixin(b.prototype,d);return b;function c(){return new Date().getTime()}function a(h){return JSON.stringify(u.isUndefined(h)?null:h)}function f(h){return JSON.parse(h)}}();var v=function(){var d=0,c={},f=6,g=new H(10);function b(i){i=i||{};this._send=i.send?a(i.send):J.ajax;this._get=i.rateLimiter?i.rateLimiter(this._get):this._get}b.setMaxPendingRequests=function e(i){f=i};b.resetCache=function h(){g=new H(10)};u.mixin(b.prototype,{_get:function(l,i,n){var j=this,k;if(k=c[l]){k.done(m)}else{if(d<f){d++;c[l]=this._send(l,i).done(m).always(o)}else{this.onDeckRequestArgs=[].slice.call(arguments,0)}}function m(p){n&&n(p);g.set(l,p)}function o(){d--;delete c[l];if(j.onDeckRequestArgs){j._get.apply(j,j.onDeckRequestArgs);j.onDeckRequestArgs=null}}},get:function(l,i,m){var k=this,j;if(u.isFunction(i)){m=i;i={}}if(j=g.get(l)){u.defer(function(){m&&m(j)})}else{this._get(l,i,m)}return !!j}});return b;function a(j){return function i(n,k){var o=J.Deferred();j(n,k,l,m);return o;function l(p){u.defer(function(){o.resolve(p)})}function m(p){u.defer(function(){o.reject(p)})}}}}();var B=function(){function h(i){i=i||{};if(!i.datumTokenizer||!i.queryTokenizer){J.error("datumTokenizer and queryTokenizer are both required")}this.datumTokenizer=i.datumTokenizer;this.queryTokenizer=i.queryTokenizer;this.datums=[];this.trie=d()}u.mixin(h.prototype,{bootstrap:function c(i){this.datums=i.datums;this.trie=i.trie},add:function(i){var j=this;i=u.isArray(i)?i:[i];u.each(i,function(m){var k,l;k=j.datums.push(m)-1;l=f(j.datumTokenizer(m));u.each(l,function(r){var n,o,p,q;n=j.trie;o=r.split("");while(p=o.shift()){n=n.children[p]||(n.children[p]=d());n.ids.push(k)}})})},get:function e(j){var l=this,i,k;i=f(this.queryTokenizer(j));u.each(i,function(q){var m,n,o,p;if(k&&k.length===0){return false}m=l.trie;n=q.split("");while(m&&(o=n.shift())){m=m.children[o]}if(m&&n.length===0){p=m.ids.slice(0);k=k?g(k,p):p}else{k=[];return false}});return k?u.map(a(k),function(m){return l.datums[m]}):[]},serialize:function b(){return{datums:this.datums,trie:this.trie}}});return h;function f(i){i=u.filter(i,function(j){return !!j});i=u.map(i,function(j){return j.toLowerCase()});return i}function d(){return{ids:[],children:{}}}function a(i){var l={},j=[];for(var k=0;k<i.length;k++){if(!l[i[k]]){l[i[k]]=true;j.push(i[k])}}return j}function g(k,m){var n=0,l=0,i=[];k=k.sort(j);m=m.sort(j);while(n<k.length&&l<m.length){if(k[n]<m[l]){n++}else{if(k[n]>m[l]){l++}else{i.push(k[n]);n++;l++}}}return i;function j(o,p){return o-p}}}();var E=function(){return{local:a,prefetch:c,remote:b};function a(d){return d.local||null}function c(f){var d,e;e={url:null,thumbprint:"",ttl:24*60*60*1000,filter:null,ajax:{}};if(d=f.prefetch||null){d=u.isString(d)?{url:d}:d;d=u.mixin(e,d);d.thumbprint=x+d.thumbprint;d.ajax.method=d.ajax.method||"get";d.ajax.dataType=d.ajax.dataType||"json";!d.url&&J.error("prefetch requires url to be set")}return d}function b(e){var h,g;g={url:null,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}};if(h=e.remote||null){h=u.isString(h)?{url:h}:h;h=u.mixin(g,h);h.rateLimiter=/^throttle$/i.test(h.rateLimitBy)?d(h.rateLimitWait):f(h.rateLimitWait);h.ajax.method=h.ajax.method||"get";h.ajax.dataType=h.ajax.dataType||"json";delete h.rateLimitBy;delete h.rateLimitWait;!h.url&&J.error("remote requires url to be set")}return h;function f(i){return function(j){return u.debounce(j,i)}}function d(i){return function(j){return u.throttle(j,i)}}}}();var L=window.Bloodhound=function(){var j;j={data:"data",protocol:"protocol",thumbprint:"thumbprint"};function d(o){if(!o||!o.local&&!o.prefetch&&!o.remote){J.error("one of local, prefetch, or remote is required")}this.limit=o.limit||5;this.sorter=o.sorter||b;this.dupDetector=o.dupDetector||i;this.local=E.local(o);this.prefetch=E.prefetch(o);this.remote=E.remote(o);this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null;this.index=new B({datumTokenizer:o.datumTokenizer,queryTokenizer:o.queryTokenizer});this.storage=this.cacheKey?new w(this.cacheKey):null}d.tokenizers={whitespace:function g(o){return o.split(/\s+/)},nonword:function e(o){return o.split(/\W+/)}};u.mixin(d.prototype,{_loadPrefetch:function m(o){var r=this,p,s;if(p=this._readFromStorage(o.thumbprint)){this.index.bootstrap(p);s=J.Deferred().resolve()}else{s=J.ajax(o.url,o.ajax).done(q)}return s;function q(O){var P;P=o.filter?o.filter(O):O;r.add(P);r._saveToStorage(r.index.serialize(),o.thumbprint,o.ttl)}},_getFromRemote:function k(N,s){var o=this,q,p;N=N||"";p=encodeURIComponent(N);q=this.remote.replace?this.remote.replace(this.remote.url,N):this.remote.url.replace(this.remote.wildcard,p);return this.transport.get(q,this.remote.ajax,r);function r(M){var P=o.remote.filter?o.remote.filter(M):M;s(P)}},_saveToStorage:function a(o,p,q){if(this.storage){this.storage.set(j.data,o,q);this.storage.set(j.protocol,location.protocol,q);this.storage.set(j.thumbprint,p,q)}},_readFromStorage:function l(o){var p={};if(this.storage){p.data=this.storage.get(j.data);p.protocol=this.storage.get(j.protocol);p.thumbprint=this.storage.get(j.thumbprint)}isExpired=p.thumbprint!==o||p.protocol!==location.protocol;return p.data&&!isExpired?p.data:null},initialize:function f(){var o=this,q;q=this.prefetch?this._loadPrefetch(this.prefetch):J.Deferred().resolve();this.local&&q.done(p);this.transport=this.remote?new v(this.remote):null;this.initialize=function r(){return q.promise()};return q.promise();function p(){o.add(o.local)}},add:function n(o){this.index.add(o)},get:function h(o,s){var q=this,p,r=false;p=this.index.get(o).sort(this.sorter).slice(0,this.limit);if(p.length<this.limit&&this.transport){r=this._getFromRemote(o,N)}!r&&s&&s(p);function N(M){var P=p.slice(0);u.each(M,function(O){var R;R=u.some(P,function(Q){return q.dupDetector(O,Q)});!R&&P.push(O);return P.length<q.limit});s&&s(P.sort(q.sorter))}},ttAdapter:function c(){return u.bind(this.get,this)}});return d;function b(){return 0}function i(){return false}}();var C={wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion">%BODY%</div>'};var D={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};if(u.isMsie()){u.mixin(D.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"})}if(u.isMsie()&&u.isMsie()<=7){u.mixin(D.input,{marginTop:"-1px"})}var K=function(){var a="typeahead:";function b(c){if(!c||!c.el){J.error("EventBus initialized without el")}this.$el=J(c.el)}u.mixin(b.prototype,{trigger:function(c){var d=[].slice.call(arguments,1);this.$el.trigger(a+c,d)}});return b}();var F=function(){var h=/\s+/,d=j();return{onSync:c,onAsync:i,off:g,trigger:f};function b(k,m,o,n){var l;if(!o){return this}m=m.split(h);o=n?a(o,n):o;this._callbacks=this._callbacks||{};while(l=m.shift()){this._callbacks[l]=this._callbacks[l]||{sync:[],async:[]};this._callbacks[l][k].push(o)}return this}function i(k,m,l){return b.call(this,"async",k,m,l)}function c(k,m,l){return b.call(this,"sync",k,m,l)}function g(l){var k;if(!this._callbacks){return this}l=l.split(h);while(k=l.shift()){delete this._callbacks[k]}return this}function f(p){var m=this,o,n,q,l,k;if(!this._callbacks){return this}p=p.split(h);q=[].slice.call(arguments,1);while((o=p.shift())&&(n=this._callbacks[o])){l=e(n.sync,this,[o].concat(q));k=e(n.async,this,[o].concat(q));l()&&d(k)}return this}function e(k,l,m){return n;function n(){var o;for(var p=0;!o&&p<k.length;p+=1){o=k[p].apply(l,m)===false}return !o}}function j(){var m,k;if(window.setImmediate){m=function l(o){setImmediate(function(){o()})}}else{m=function n(o){setTimeout(function(){o()},0)}}return m}function a(k,l){return k.bind?k.bind(l):function(){k.apply(l,[].slice.call(arguments,0))}}}();var I=function(a){var b={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:false,caseSensitive:false};return function c(f){var e;f=u.mixin({},b,f);if(!f.node||!f.pattern){return}f.pattern=u.isArray(f.pattern)?f.pattern:[f.pattern];e=d(f.pattern,f.caseSensitive,f.wordsOnly);h(f.node,g);function g(i){var j,k;if(j=e.exec(i.data)){wrapperNode=a.createElement(f.tagName);f.className&&(wrapperNode.className=f.className);k=i.splitText(j.index);k.splitText(j[0].length);wrapperNode.appendChild(k.cloneNode(true));i.parentNode.replaceChild(wrapperNode,k)}return !!j}function h(j,i){var l,k=3;for(var m=0;m<j.childNodes.length;m++){l=j.childNodes[m];if(l.nodeType===k){m+=i(l)?1:0}else{h(l,i)}}}};function d(h,f,g){var j=[],e;for(var i=0;i<h.length;i++){j.push(u.escapeRegExChars(h[i]))}e=g?"\\b("+j.join("|")+")\\b":"("+j.join("|")+")";return f?new RegExp(e):new RegExp(e,"i")}}(window.document);var z=function(){var d;d={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"};function g(R){var N=this,M,Q,O,P;R=R||{};if(!R.input){J.error("input is missing")}M=u.bind(this._onBlur,this);Q=u.bind(this._onFocus,this);O=u.bind(this._onKeydown,this);P=u.bind(this._onInput,this);this.$hint=J(R.hint);this.$input=J(R.input).on("blur.tt",M).on("focus.tt",Q).on("keydown.tt",O);if(this.$hint.length===0){this.setHintValue=this.getHintValue=this.clearHint=u.noop}if(!u.isMsie()){this.$input.on("input.tt",P)}else{this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(Z){if(d[Z.which||Z.keyCode]){return}u.defer(u.bind(N._onInput,N,Z))})}this.query=this.$input.val();this.$overflowHelper=S(this.$input)}g.normalizeQuery=function(M){return(M||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")};u.mixin(g.prototype,F,{_onBlur:function V(M){this.resetInputValue();this.trigger("blurred")},_onFocus:function q(M){this.trigger("focused")},_onKeydown:function b(N){var M=d[N.which||N.keyCode];this._managePreventDefault(M,N);if(M&&this._shouldTrigger(M,N)){this.trigger(M+"Keyed",N)}},_onInput:function T(M){this._checkInputValue()},_managePreventDefault:function m(M,N){var O,P,Q;switch(M){case"tab":P=this.getHintValue();Q=this.getInputValue();O=P&&P!==Q&&!r(N);break;case"up":case"down":O=!r(N);break;default:O=false}O&&N.preventDefault()},_shouldTrigger:function a(M,N){var O;switch(M){case"tab":O=!r(N);break;default:O=true}return O},_checkInputValue:function i(){var O,N,M;O=this.getInputValue();N=W(O,this.query);M=N?this.query.length!==O.length:false;if(!N){this.trigger("queryChanged",this.query=O)}else{if(M){this.trigger("whitespaceChanged",this.query)}}},focus:function n(){this.$input.focus()},blur:function f(){this.$input.blur()},getQuery:function j(){return this.query},setQuery:function l(M){this.query=M},getInputValue:function o(){return this.$input.val()},setInputValue:function X(M,N){this.$input.val(M);!N&&this._checkInputValue()},getHintValue:function e(){return this.$hint.val()},setHintValue:function k(M){this.$hint.val(M)},resetInputValue:function s(){this.$input.val(this.query)},clearHint:function U(){this.$hint.val("")},getLanguageDirection:function p(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function h(){var M=this.$input.width()-2;this.$overflowHelper.text(this.getInputValue());return this.$overflowHelper.width()>=M},isCursorAtEnd:function(){var N,M,O;N=this.$input.val().length;M=this.$input[0].selectionStart;if(u.isNumber(M)){return M===N}else{if(document.selection){O=document.selection.createRange();O.moveStart("character",-N);return N===O.text.length}}return true},destroy:function c(){this.$hint.off(".tt");this.$input.off(".tt");this.$hint=this.$input=this.$overflowHelper=null}});return g;function S(M){return J('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"nowrap",fontFamily:M.css("font-family"),fontSize:M.css("font-size"),fontStyle:M.css("font-style"),fontVariant:M.css("font-variant"),fontWeight:M.css("font-weight"),wordSpacing:M.css("word-spacing"),letterSpacing:M.css("letter-spacing"),textIndent:M.css("text-indent"),textRendering:M.css("text-rendering"),textTransform:M.css("text-transform")}).insertAfter(M)}function W(M,N){return g.normalizeQuery(M)===g.normalizeQuery(N)}function r(M){return M.altKey||M.ctrlKey||M.metaKey||M.shiftKey}}();var t=function(){var j="ttDataset",k="ttValue",d="ttDatum";function l(n){n=n||{};n.templates=n.templates||{};if(!n.source){J.error("missing source")}this.query=null;this.highlight=!!n.highlight;this.name=n.name||u.getUniqueId();this.source=n.source;this.valueKey=n.displayKey||"value";this.templates=h(n.templates,this.valueKey);this.$el=J(C.dataset.replace("%CLASS%",this.name))}l.extractDatasetName=function m(n){return J(n).data(j)};l.extractValue=function c(n){return J(n).data(k)};l.extractDatum=function c(n){return J(n).data(d)};u.mixin(l.prototype,F,{_render:function i(P,s){if(!this.$el){return}var n=this,q;this.$el.empty();q=s&&s.length;if(!q&&this.templates.empty){this.$el.html(r()).prepend(n.templates.header?o():null).append(n.templates.footer?p():null)}else{if(q){this.$el.html(O()).prepend(n.templates.header?o():null).append(n.templates.footer?p():null)}}this.trigger("rendered");function r(){return n.templates.empty({query:P})}function O(){var N;N=J(C.suggestions).css(D.suggestions).append(u.map(s,M));n.highlight&&I({node:N[0],pattern:P});return N;function M(V){var U,W,X;W=n.templates.suggestion(V);X=C.suggestion.replace("%BODY%",W);U=J(X).data(j,n.name).data(k,V[n.valueKey]).data(d,V);U.children().each(function(){J(this).css(D.suggestionChild)});return U}}function o(){return n.templates.header({query:P,isEmpty:!q})}function p(){return n.templates.footer({query:P,isEmpty:!q})}},getRoot:function b(){return this.$el},update:function g(n){var o=this;this.query=n;this.source(n,p);function p(q){n===o.query&&o._render(n,q)}},clear:function e(){this._render(this.query||"")},isEmpty:function f(){return this.$el.is(":empty")},destroy:function a(){this.$el=null}});return l;function h(o,n){return{empty:o.empty&&u.templatify(o.empty),header:o.header&&u.templatify(o.header),footer:o.footer&&u.templatify(o.footer),suggestion:o.suggestion||p};function p(q){return"<p>"+q[n]+"</p>"}}}();var y=function(){function f(Q){var M=this,S,P,O,R,N;Q=Q||{};if(!Q.menu){J.error("menu is required")}this.isOpen=false;this.isEmpty=true;this.isMouseOverDropdown=false;this.datasets=u.map(Q.datasets,W);S=u.bind(this._onMouseEnter,this);P=u.bind(this._onMouseLeave,this);O=u.bind(this._onSuggestionClick,this);R=u.bind(this._onSuggestionMouseEnter,this);N=u.bind(this._onSuggestionMouseLeave,this);this.$menu=J(Q.menu).on("mouseenter.tt",S).on("mouseleave.tt",P).on("click.tt",".tt-suggestion",O).on("mouseenter.tt",".tt-suggestion",R).on("mouseleave.tt",".tt-suggestion",N);u.each(this.datasets,function(ab){M.$menu.append(ab.getRoot());ab.onSync("rendered",M._onRendered,M)})}u.mixin(f.prototype,F,{_onMouseEnter:function s(M){this.isMouseOverDropdown=true},_onMouseLeave:function a(M){this.isMouseOverDropdown=false},_onSuggestionClick:function g(M){this.trigger("suggestionClicked",J(M.currentTarget))},_onSuggestionMouseEnter:function V(M){this._removeCursor();this._setCursor(J(M.currentTarget),true)},_onSuggestionMouseLeave:function o(M){this._removeCursor()},_onRendered:function j(){this.isEmpty=u.every(this.datasets,M);this.isEmpty?this._hide():this.isOpen&&this._show();this.trigger("datasetRendered");function M(N){return N.isEmpty()}},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function l(){return this.$menu.find(".tt-suggestion")},_getCursor:function p(){return this.$menu.find(".tt-cursor").first()},_setCursor:function d(M,N){M.first().addClass("tt-cursor");!N&&this.trigger("cursorMoved")},_removeCursor:function r(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function T(P){var N,O,Q,M;if(!this.isOpen){return}O=this._getCursor();N=this._getSuggestions();this._removeCursor();Q=N.index(O)+P;Q=(Q+1)%(N.length+1)-1;if(Q===-1){this.trigger("cursorRemoved");return}else{if(Q<-1){Q=N.length-1}}this._setCursor(M=N.eq(Q));this._ensureVisible(M)},_ensureVisible:function h(M){var P,N,O,Q;P=M.position().top;N=P+M.outerHeight(true);O=this.$menu.scrollTop();Q=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10);if(P<0){this.$menu.scrollTop(O+P)}else{if(Q<N){this.$menu.scrollTop(O+(N-Q))}}},close:function n(){if(this.isOpen){this.isOpen=this.isMouseOverDropdown=false;this._removeCursor();this._hide();this.trigger("closed")}},open:function q(){if(!this.isOpen){this.isOpen=true;!this.isEmpty&&this._show();this.trigger("opened")}},setLanguageDirection:function c(M){this.$menu.css(M==="ltr"?D.ltr:D.rtl)},moveCursorUp:function Z(){this._moveCursor(-1)},moveCursorDown:function b(){this._moveCursor(+1)},getDatumForSuggestion:function X(M){var N=null;if(M.length){N={raw:t.extractDatum(M),value:t.extractValue(M),datasetName:t.extractDatasetName(M)}}return N},getDatumForCursor:function m(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function i(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function Y(N){u.each(this.datasets,M);function M(O){O.update(N)}},empty:function U(){u.each(this.datasets,M);function M(N){N.clear()}},isVisible:function k(){return this.isOpen&&!this.isEmpty},destroy:function e(){this.$menu.off(".tt");this.$menu=null;u.each(this.datasets,M);function M(N){N.destroy()}}});return f;function W(M){return new t(M)}}();var A=function(){var d="ttAttrs";function ah(N){var P,M,O,Q;N=N||{};if(!N.input){J.error("missing input")}this.autoselect=!!N.autoselect;this.minLength=u.isNumber(N.minLength)?N.minLength:1;this.$node=ac(N.input,N.withHint);P=this.$node.find(".tt-dropdown-menu");M=this.$node.find(".tt-input");O=this.$node.find(".tt-hint");this.eventBus=N.eventBus||new K({el:M});this.dropdown=new y({menu:P,datasets:N.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this);this.input=new z({input:M,hint:O}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this);P.on("mousedown.tt",function(R){if(u.isMsie()&&u.isMsie()<9){M[0].onbeforedeactivate=function(){window.event.returnValue=false;M[0].onbeforedeactivate=null}}R.preventDefault()})}u.mixin(ah.prototype,{_onSuggestionClicked:function ad(N,M){var O;if(O=this.dropdown.getDatumForSuggestion(M)){this._select(O)}},_onCursorMoved:function i(){var M=this.dropdown.getDatumForCursor();this.input.clearHint();this.input.setInputValue(M.value,true);this.eventBus.trigger("cursorchanged",M.raw,M.datasetName)},_onCursorRemoved:function s(){this.input.resetInputValue();this._updateHint()},_onDatasetRendered:function m(){this._updateHint()},_onOpened:function ab(){this._updateHint();this.eventBus.trigger("opened")},_onClosed:function aj(){this.input.clearHint();this.eventBus.trigger("closed")},_onFocused:function k(){this.dropdown.open()},_onBlurred:function j(){!this.dropdown.isMouseOverDropdown&&this.dropdown.close()},_onEnterKeyed:function r(O,P){var N,M;N=this.dropdown.getDatumForCursor();M=this.dropdown.getDatumForTopSuggestion();if(N){this._select(N);P.preventDefault()}else{if(this.autoselect&&M){this._select(M);P.preventDefault()}}},_onTabKeyed:function a(N,M){var O;if(O=this.dropdown.getDatumForCursor()){this._select(O);M.preventDefault()}else{this._autocomplete()}},_onEscKeyed:function f(){this.dropdown.close();this.input.resetInputValue()},_onUpKeyed:function af(){var M=this.input.getQuery();if(!this.dropdown.isOpen&&M.length>=this.minLength){this.dropdown.update(M)}this.dropdown.open();this.dropdown.moveCursorUp()},_onDownKeyed:function q(){var M=this.input.getQuery();if(!this.dropdown.isOpen&&M.length>=this.minLength){this.dropdown.update(M)}this.dropdown.open();this.dropdown.moveCursorDown()},_onLeftKeyed:function b(){this.dir==="rtl"&&this._autocomplete()},_onRightKeyed:function o(){this.dir==="ltr"&&this._autocomplete()},_onQueryChanged:function ae(M,N){this.input.clearHint();this.dropdown.empty();N.length>=this.minLength&&this.dropdown.update(N);this.dropdown.open();this._setLanguageDirection()},_onWhitespaceChanged:function e(){this._updateHint();this.dropdown.open()},_setLanguageDirection:function g(){var M;if(this.dir!==(M=this.input.getLanguageDirection())){this.dir=M;this.$node.css("direction",M);this.dropdown.setLanguageDirection(M)}},_updateHint:function l(){var Q,P,M,N,R,O;Q=this.dropdown.getDatumForTopSuggestion();if(Q&&this.dropdown.isVisible()&&!this.input.hasOverflow()){P=this.input.getInputValue();M=z.normalizeQuery(P);N=u.escapeRegExChars(M);R=new RegExp("^(?:"+N+")(.*$)","i");O=R.exec(Q.value);this.input.setHintValue(P+(O?O[1]:""))}},_autocomplete:function c(){var N,M,O;N=this.input.getHintValue();M=this.input.getQuery();if(N&&M!==N&&this.input.isCursorAtEnd()){O=this.dropdown.getDatumForTopSuggestion();O&&this.input.setInputValue(O.value);this.eventBus.trigger("autocompleted",O.raw,O.datasetName)}},_select:function aa(M){this.input.clearHint();this.input.setQuery(M.value);this.input.setInputValue(M.value,true);this.dropdown.empty();this._setLanguageDirection();u.defer(u.bind(this.dropdown.close,this.dropdown));this.eventBus.trigger("selected",M.raw,M.datasetName)},open:function ai(){this.dropdown.open()},close:function ag(){this.dropdown.close()},getQuery:function p(){return this.input.getQuery()},setQuery:function Z(M){this.input.setInputValue(M)},destroy:function h(){this.input.destroy();this.dropdown.destroy();Y(this.$node);this.$node=null}});return ah;function ac(S,N){var M,R,O,Q;M=J(S);R=J(C.wrapper).css(D.wrapper);O=J(C.dropdown).css(D.dropdown);Q=M.clone().css(D.hint).css(n(M));Q.removeData().addClass("tt-hint").removeAttr("id name placeholder").prop("disabled",true).attr({autocomplete:"off",spellcheck:"false"});M.data(d,{dir:M.attr("dir"),autocomplete:M.attr("autocomplete"),spellcheck:M.attr("spellcheck"),style:M.attr("style")});M.addClass("tt-input").attr({autocomplete:"off",spellcheck:false}).css(N?D.input:D.inputWithNoHint);try{!M.attr("dir")&&M.attr("dir","auto")}catch(P){}return M.wrap(R).parent().prepend(N?Q:null).append(O)}function n(M){return{backgroundAttachment:M.css("background-attachment"),backgroundClip:M.css("background-clip"),backgroundColor:M.css("background-color"),backgroundImage:M.css("background-image"),backgroundOrigin:M.css("background-origin"),backgroundPosition:M.css("background-position"),backgroundRepeat:M.css("background-repeat"),backgroundSize:M.css("background-size")}}function Y(N){var M=N.find(".tt-input");u.each(M.data(d),function(O,P){u.isUndefined(O)?M.removeAttr(P):M.attr(P,O)});M.detach().removeData(d).removeClass("tt-input").insertAfter(N);N.remove()}}();(function(){var d,c;d="ttTypeahead";c={initialize:function e(i){var j=[].slice.call(arguments,1);i=i||{};return this.each(h);function h(){var k=J(this),n,l;u.each(j,function(o){o.highlight=!!i.highlight});l=new A({input:k,eventBus:n=new K({el:k}),withHint:u.isUndefined(i.hint)?true:!!i.hint,minLength:i.minLength,autoselect:i.autoselect,datasets:j});k.data(d,l);function m(o){return function(){u.defer(function(){n.trigger(o)})}}}},open:function b(){return this.each(h);function h(){var i=J(this),j;if(j=i.data(d)){j.open()}}},close:function f(){return this.each(h);function h(){var i=J(this),j;if(j=i.data(d)){j.close()}}},val:function g(j){return u.isString(j)?this.each(i):this.map(h).get();function i(){var k=J(this),l;if(l=k.data(d)){l.setQuery(j)}}function h(){var k=J(this),l,m;if(l=k.data(d)){m=l.getQuery()}return m}},destroy:function a(){return this.each(h);function h(){var i=J(this),j;if(j=i.data(d)){j.destroy();i.removeData(d)}}}};jQuery.fn.typeahead=function(h){if(c[h]){return c[h].apply(this,[].slice.call(arguments,1))}else{return c.initialize.apply(this,arguments)}}})()})(window.jQuery);