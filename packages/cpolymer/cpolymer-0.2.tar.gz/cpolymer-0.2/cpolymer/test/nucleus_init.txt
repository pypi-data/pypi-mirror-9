################################
#Template
#Must contain the variables
#  typecell 
#  outtraj
#  outfile
#  interaction
#  run_length
#  samplingrate
#  particle

# VARIABLES
variable typecell index yeast
variable fname index yeastconf2.txt    # configuration initiale
variable simname index test


#package cuda override/bpa 1


# Initialization
#correspond to x=y=z=1
lattice fcc 4
units		lj
boundary	f f f
atom_style	molecular
log 		log.${simname}.txt
read_data	${fname}



neighbor 2.0 multi


include interactions
include variables


#####################################################
# Equilibration (Langevin dynamics at 5000 K)

group telo type 2
group norm type 1 2 4 6
group ribo type 3
group centro type 4
group spb  type 5
group particle type 1 2 3 4 6
#compute hic particle pair/local dist
#compute hicp particle property/local patom1 patom2



dump 		init all dcd 1000 dump_init.yeast.comp.dcd



###########################################################
#Definiton of nucleus and its interaction
#the telomere part is added when the nuceus has the right size

variable rad equal ${frad}

region mySphere sphere 0.0 0.0 0.0 v_rad side in

fix wall1 norm wall/region mySphere lj126 ${eNorm} ${sigNorm} ${sigNormCut} 
fix wall2 ribo wall/region mySphere lj126 ${eRibo} ${sigRibo} ${sigRiboCut}
fix wall telo wall/region mySphere  lj93  ${etelo} ${sigtelo} ${cuttelo}


velocity 	particle create 1.0 1231
fix		1 particle nve/limit 0.0005
fix		2 particle langevin 1.0 1.0 ${damp} 904297
run 10000

unfix 1

thermo_style	custom step temp 
thermo          10000
fix		1 particle nve/limit 0.05
timestep	0.005 
run		100000


write_data final.xyz



#####################################################
