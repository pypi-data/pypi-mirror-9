<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ROA (Resource Oriented Architecture)</title>
    
    <link rel="stylesheet" href="../_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> 
  </head>
  <body>

    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="roa/rest_standard.html" title="REST API standard"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cors.html" title="CORS"
             accesskey="P">previous</a> |</li>
        <li><a href="../index.html">fantastico 0.7.0-b141 documentation</a> &raquo;</li>
          <li><a href="features.html" accesskey="U">Fantastico features</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body">
            
  <div class="section" id="roa-resource-oriented-architecture">
<h1>ROA (Resource Oriented Architecture)</h1>
<p>Resource Oriented Architecture (REST) is incredible popular nowadays for the following reasons:</p>
<blockquote>
<div><ul class="simple">
<li>Increased scalability of applications.</li>
<li>Easy integration of systems.</li>
<li>Intuitive modelling of business problems.</li>
<li>Stateful imperative programming pains removed.</li>
</ul>
</div></blockquote>
<p>You can find many information about advantages of REST and why it is recommended to use such an architecure. For further reading
you can visit <a class="reference external" href="http://en.wikipedia.org/wiki/Representational_state_transfer">http://en.wikipedia.org/wiki/Representational_state_transfer</a>.</p>
<p>In Fantastisco framework we firmly encourage REST approach into projects. We even go a step further in this direction, by
standardising REST APIs and providing REST APIs generator over implemented models.</p>
<div class="section" id="examples">
<h2>Examples</h2>
</div>
<div class="section" id="application-settings-stored-in-database">
<h2>Application settings stored in database</h2>
<p>Imagine you have a model called <strong>AppSetting</strong> meant to define custom settings attributes which influence your application.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AppSetting</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&quot;app_settings&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
<p>In a standard <strong>MVC</strong> (<a class="reference internal" href="mvc.html"><em>Model View Controller</em></a>) web application once you have defined the above mentioned fantastico model you would
have to do the following: (for providing minimal CRUD)</p>
<blockquote>
<div><ol class="arabic simple">
<li>Create a <a class="reference internal" href="mvc.html#fantastico.mvc.controller_decorators.Controller" title="fantastico.mvc.controller_decorators.Controller"><tt class="xref py py-class docutils literal"><span class="pre">fantastico.mvc.controller_decorators.Controller</span></tt></a></li>
<li>Implement listing of custom settings<ol class="arabic">
<li>Support pagination.</li>
<li>Support filtering.</li>
<li>Support ordering.</li>
</ol>
</li>
<li>Implement individual custom setting retrieval (by id).</li>
<li>Implement Create custom setting.</li>
<li>Implement Update custom setting.</li>
<li>Implement Delete custom setting.</li>
<li>For each operation implemented provide validation logic.</li>
<li>For each operation implemented provide error handling logic.</li>
</ol>
</div></blockquote>
<p>This is an extremely repetitive task and involves quite a lot of boiler plate. In addition no standard is imposed for how
pagination, sorting and filtering work.</p>
<p>A more convenient way for this problem is to provide some additional information about the model:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;app-setting&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/app-settings&quot;</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AppSetting</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&quot;app_settings&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
<p>Once the model is decorated, I expect to have a fully functional API which I can easily invoke through HTTP calls:</p>
<blockquote>
<div><ul class="simple">
<li>GET    - /api/latest/app-settings - list all application settings (supports filtering, ordering and pagination)</li>
<li>POST   - /api/latest/app-settings - create a new app setting.</li>
<li>PUT    - /api/latest/app-settings/:id - update an existing application setting.</li>
<li>DELETE - /api/latest/app-settings/:id - delete an existing application setting.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="versioning">
<h2>Versioning</h2>
<p>It is always a good practice to support API versioning. Going a step further with AppSetting resource:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;app-setting&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/app-settings&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AppSetting</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&quot;app_settings&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>

<span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;app-setting&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/app-settings&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AppSettingV2</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&quot;app_settings&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
<p>The above example will actually provide the following endpoints which can be easily accessible:</p>
<blockquote>
<div><ul class="simple">
<li>/api/1.0/app-settings</li>
<li>/api/2.0/app-settings</li>
<li>/api/latest/app-settings (which at this moment points to the most recent version of the api)</li>
</ul>
</div></blockquote>
<p>If we want to retrieve all application settings using version 1.0 we open a browser and point it to <strong>/api/1.0/app-settings</strong>. For
avoiding multiple APIs chaos we strongly encourage to use the latest available API.</p>
</div>
<div class="section" id="validation">
<h2>Validation</h2>
<p>Each resource requires validation for create / update operations. Validation is harder to be achieved through code introspection
so in Fantastico for each defined resource you can define a validator which will be invoked automatically.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">AppSettingValidator</span><span class="p">(</span><span class="n">ResourceValidator</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">existing_resource_id</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">if</span> <span class="n">resource</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s">&quot;unsupported&quot;</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Invalid setting name: </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">resource</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">resource</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot;Setting </span><span class="si">%s</span><span class="s"> value can not be empty. </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">resource</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">raise</span> <span class="n">FantasticoRoaError</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;app-setting&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/app-settings&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">validator</span><span class="o">=</span><span class="n">AppSettingValidator</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">AppSettingV2</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="n">unique</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;value&quot;</span><span class="p">,</span> <span class="n">Text</span><span class="p">,</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
</pre></div>
</div>
<p>If no validator is provided no validation is done on the given resource. Also, it is important to always remember that validators
are only invoked for <strong>Create</strong> and <strong>Update</strong>:</p>
<blockquote>
<div><ul class="simple">
<li>POST   - /api/latest/app-settings - create a new app setting. (validate method will be invoked).</li>
<li>PUT    - /api/latest/app-settings/:id - update an existing app setting. (validate method will be invoked).</li>
</ul>
</div></blockquote>
<p>We are aware that there are some common validation cases which can be reused:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Email validation</li>
<li>Phone number validation</li>
<li>Credit Card number validation</li>
</ol>
</div></blockquote>
<p>All common validation cases  are provided out of the box as methods part of ResourceValidator class. You can easily use them into
your resource validator.</p>
<p>There are some rare cases when a resource contains sensitive data (e.g user passwords / credit card numbers). In order to alter or
suppress such sensitive data you can simply override <strong>format_resource</strong> method. Below you can find a simple example of user
data retrieval where password is never sent back to client even if requested:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UserValidator</span><span class="p">(</span><span class="n">ResourceValidator</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">format_resource</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
      <span class="n">user</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</div>
<p>With the above example, whenever you request GET on /users or GET on /user/:userid password will be suppressed.</p>
</div>
<div class="section" id="partial-object-representation">
<span id="id1"></span><h2>Partial object representation</h2>
<p>There are cases when a resource contains many fields but you actually need only a few of them:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;address&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/addresses&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">Address</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">line1</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line1&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">),</span> <span class="n">nullable</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">line2</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line2&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">line3</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line3&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">line4</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line4&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">line5</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line5&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">line6</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;line6&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">200</span><span class="p">))</span>
    <span class="n">city</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;city&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
    <span class="n">country</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;country&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
    <span class="n">zip_code</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;zip_code&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line1</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">line2</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">line3</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">line4</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">line5</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">line6</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>
               <span class="n">city</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">country</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">zip_code</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line1</span> <span class="o">=</span> <span class="n">line1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line2</span> <span class="o">=</span> <span class="n">line2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line3</span> <span class="o">=</span> <span class="n">line3</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line4</span> <span class="o">=</span> <span class="n">line4</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line5</span> <span class="o">=</span> <span class="n">line5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line6</span> <span class="o">=</span> <span class="n">line6</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">city</span> <span class="o">=</span> <span class="n">city</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">country</span> <span class="o">=</span> <span class="n">country</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zip_code</span> <span class="o">=</span> <span class="n">zip_code</span>
</pre></div>
</div>
<p>When working with the Address resource there will be cases when we do not need all fields to be transferred to client. For this,
partial representation is supported out of the box into Fantastico:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// retrieve only city,zip_code and line1 of a given address</span>
<span class="kd">var</span> <span class="nx">url</span> <span class="o">=</span> <span class="s2">&quot;/api/1.0/addresses/1?fields=city,zip_code,line1&quot;</span><span class="p">;</span>
</pre></div>
</div>
<p>A possible response for this request might be:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
    <span class="nx">city</span><span class="o">:</span> <span class="s2">&quot;Bucharest&quot;</span><span class="p">,</span>
    <span class="nx">zip_code</span><span class="o">:</span> <span class="s2">&quot;B00001&quot;</span><span class="p">,</span>
    <span class="nx">line1</span><span class="o">:</span> <span class="s2">&quot;First line of this wonderful address&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>fields</strong> Query parameter is optional. If you omit this query parameter all fields are retrieved in the response. <strong>fields</strong>
query parameter makes sense for:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Listing a collection</li>
<li>Retrieving information about an individual item.</li>
</ol>
</div></blockquote>
<p>All other operations simply ignore <strong>fields</strong>.</p>
</div>
<div class="section" id="resource-composed-attributes">
<h2>Resource composed attributes</h2>
<p>There are resources which have attributes which points to another resource:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@Resource</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;person&quot;</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="s">&quot;/persons&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
          <span class="n">subresources</span><span class="o">=</span><span class="p">{</span><span class="s">&quot;bill_address&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;bill_address_id&quot;</span><span class="p">],</span>
                        <span class="s">&quot;mail_address&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;mail_address_id&quot;</span><span class="p">],</span>
                        <span class="s">&quot;ship_address:&quot;</span> <span class="p">[</span><span class="s">&quot;ship_address_id&quot;</span><span class="p">]})</span>
<span class="k">class</span> <span class="nc">Person</span><span class="p">(</span><span class="n">BASEMODEL</span><span class="p">):</span>
    <span class="n">__tablename__</span> <span class="o">=</span> <span class="s">&quot;persons&quot;</span>

    <span class="nb">id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="n">Integer</span><span class="p">,</span> <span class="n">primary_key</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">autoincrement</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">first_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;first_name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">80</span><span class="p">))</span>
    <span class="n">last_name</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;last_name&quot;</span><span class="p">,</span> <span class="n">String</span><span class="p">(</span><span class="mi">50</span><span class="p">))</span>
    <span class="n">bill_address_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;bill_address_id&quot;</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s">&quot;addresses.id&quot;</span><span class="p">))</span>
    <span class="n">bill_address</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Address</span><span class="p">,</span> <span class="n">primaryjoin</span><span class="o">=</span><span class="n">bill_address_id</span> <span class="o">==</span> <span class="n">Address</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">ship_address_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;ship_address_id&quot;</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s">&quot;addresses.id&quot;</span><span class="p">))</span>
    <span class="n">ship_address</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Address</span><span class="p">,</span> <span class="n">primaryjoin</span><span class="o">=</span><span class="n">ship_address_id</span> <span class="o">==</span> <span class="n">Address</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
    <span class="n">mail_address_id</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="s">&quot;ship_address_id&quot;</span><span class="p">,</span> <span class="n">ForeignKey</span><span class="p">(</span><span class="s">&quot;addresses.id&quot;</span><span class="p">))</span>
    <span class="n">ship_address</span> <span class="o">=</span> <span class="n">relationship</span><span class="p">(</span><span class="n">Address</span><span class="p">,</span> <span class="n">primaryjoin</span><span class="o">=</span><span class="n">mail_address_id</span> <span class="o">==</span> <span class="n">Address</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
<p>The above definition shows you how to mark the subresources of <strong>person</strong> resource. By default they will not be retrieved in
requests. Only subresource identifier keys pointing from <strong>person</strong> to various <strong>address</strong> objects are retrieved. If you want
to obtain details about a specific address (e.g bill_address) you can use example below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">var</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;/api/1.0/persons/1?fields=first_name, last_name, bill_address(line1, city, zip_code)&quot;</span>
</pre></div>
</div>
<p>The above example url might return:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span class="p">{</span>
   <span class="s2">&quot;first_name&quot;</span><span class="o">:</span> <span class="s2">&quot;John&quot;</span><span class="p">,</span>
   <span class="s2">&quot;last_name&quot;</span><span class="o">:</span> <span class="s2">&quot;Doe&quot;</span><span class="p">,</span>
   <span class="s2">&quot;bill_address&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;line1&quot;</span><span class="o">:</span> <span class="s2">&quot;First line of this wonderful address&quot;</span><span class="p">,</span>
      <span class="s2">&quot;city&quot;</span><span class="o">:</span> <span class="s2">&quot;Bucharest&quot;</span><span class="p">,</span>
      <span class="s2">&quot;zip_code&quot;</span><span class="o">:</span> <span class="s2">&quot;B00001&quot;</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Composed attributes usage is limited to below mentioned operations:</p>
<blockquote>
<div><ul class="simple">
<li>Listing collections.</li>
<li>Retrieving information about an individual item.</li>
<li>First level subresources.</li>
</ul>
</div></blockquote>
<p>We do not support update / create of multiple resources using one single request.</p>
</div>
<div class="section" id="security">
<h2>Security</h2>
<p>Fantastico provides a compliant OAuth 2 RFC implementation which is also integrated with ROA. For more information about enabling
OAuth 2 authorization on ROA please read <a class="reference internal" href="oauth2/controllers_security.html"><em>Controllers security</em></a>.</p>
</div>
<div class="section" id="advantages">
<h2>Advantages</h2>
<blockquote>
<div><ul class="simple">
<li>Extremely fast development of uniform APIs which behave predictable.</li>
<li>Extremely easy to enforce exception handling logic.</li>
<li>Extremely easy to enforce security for APIs.</li>
<li>Extremely easy to keep APIs in sync with resource changes.</li>
<li>DRY (don&#8217;t repeat yourself).</li>
</ul>
</div></blockquote>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="roa/rest_standard.html">REST API standard</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roa/rest_standard.html#resource-collection">Resource collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#pagination">Pagination</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#sorting">Sorting</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#filtering">Filtering</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="roa/rest_standard.html#resource-item">Resource item</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#create-a-new-item">Create a new item</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#update-an-existing-item">Update an existing item</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_standard.html#delete-an-existing-item">Delete an existing item</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roa/rest_responses.html">REST Responses</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roa/rest_responses.html#common-responses">Common responses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#internal-server-error">Internal Server Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#concrete-errors">Concrete errors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="roa/rest_responses.html#resource-item">Resource Item</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#retrieve-resource-item">Retrieve resource item</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#create-a-new-resource-item">Create a new resource item</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="roa/rest_responses.html#update-an-existing-resource">Update an existing resource</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#delete-an-existing-resource">Delete an existing resource</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/rest_responses.html#bulk-creation-of-items">Bulk creation of items</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="roa/technical_summary.html">ROA Technical Summary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="roa/technical_summary.html#exceptions">Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="roa/technical_summary.html#api-generic-controller">API generic controller</a></li>
<li class="toctree-l2"><a class="reference internal" href="roa/technical_summary.html#api-error-responses">API error responses</a><ul>
<li class="toctree-l3"><a class="reference internal" href="roa/errors/error_10000.html">10000 - Resource Collection Not Found</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/errors/error_10010.html">10010 - Resource Invalid</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/errors/error_10020.html">10020 - No body given</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/errors/error_10030.html">10030 - Unexpected database error</a></li>
<li class="toctree-l3"><a class="reference internal" href="roa/errors/error_10040.html">10040 - Resource item not found</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>


    <div class="footer">
        &copy; Copyright 2013, Radu Viorel Cosnita.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-42788125-1', 'rcosnita.github.io');
  ga('send', 'pageview');
</script>

  </body>
</html>