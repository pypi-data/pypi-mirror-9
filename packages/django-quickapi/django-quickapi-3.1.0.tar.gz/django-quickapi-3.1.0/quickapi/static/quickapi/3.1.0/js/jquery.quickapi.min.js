(function(a){a.quickAPI=function(d){var f,b=d||new Object();if(!b.data){b.data=b.args||{method:"quickapi.test"}}if(b.simple_request){f=b.data;if(!f.language){f.language=b.language||window.LANGUAGE_CODE}}else{f={jsonData:a.toJSON(b.data),language:b.language||window.LANGUAGE_CODE}}var g,c={type:b.type||"POST",async:b.sync===true?false:b.async===false?false:true,timeout:b.timeout||window.AJAX_TIMEOUT||3000,url:b.url||window.QUICKAPI_URL||"/api/",data:f,dataType:"json",},h=b.callback||function(j,i,k){},e=b.handlerShowAlert||window.handlerShowAlert||function(l,m,j,i){var k;if(a.type(m)=="object"){m=a.toJSON(m).replace(/\,\"/g,', "').replace(/\"\:/g,'": ')}else{if(m.match(/<\!DOCTYPE/)){k=m.match(/<[title,TITLE]+>(.*)<\/[title,TITLE]+>/);if(k){l=k[1]}k=m.match(/<[body,BODY]+>([^+]*)<\/[body,BODY]+>/);if(k){m=k[1].replace(/<\/?[^>]+>/g,"").replace(/ [ ]+/g," ").replace(/\n[\n]+/g,"\n")}}}if(m.length>512){m=m.substring(0,512)+" ..."}alert(l+"\n"+m);if(i){return i()}return null};g=a.ajax(c).fail(function(k,i,j){if(k.getResponseHeader("Location")){window.location.replace(k.getResponseHeader("Location").replace(/\/[\#\-\w]*$/,"/?").replace(/\?.*$/,"?next="+window.location.pathname));console.info("REDIRECT:"+k.getResponseHeader("Location"))}else{if(k.responseText){console.error("ERROR:",k.responseText);e("ERROR:",k.responseText,"alert-danger")}}}).done(function(k,j,l){if(b.log&&window.DEBUG){console.debug(b.log)}if((k.status>=300)&&(k.status<400)&&(k.data.Location!=undefined)){var i=k.data.Location.replace(/\/[\#\-\w]*$/,"/?").replace(/\?.*$/,"?next="+window.location.pathname),m=function(){window.location.replace(i)};console.info("REDIRECT:"+i);if(k.message){e("REDIRECT:",k.message,"alert-danger",m)}else{m()}}else{if(k.status>=400){e("ERROR:",k.message,"alert-danger")}else{if(window.DEBUG){console.debug(a.toJSON(k.message));if(b.data.method=="quickapi.test"){console.debug(k.data)}}return h(k,j,l)}}});return g}}(jQuery));