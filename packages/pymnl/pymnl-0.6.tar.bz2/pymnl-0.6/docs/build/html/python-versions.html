<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Using pymnl with Python 2 vs Python 3 &mdash; pymnl 0.6 documentation</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.6',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="pymnl 0.6 documentation" href="index.html" />
    <link rel="next" title="libmnl to pymnl API checklist" href="api-checklist.html" />
    <link rel="prev" title="pymnl.nlsocket Module" href="nlsocket.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner"><h1 class="heading"><a href="index.html">
          <span>pymnl 0.6 documentation</span></a></h1>
        <h2 class="heading"><span>Using pymnl with Python 2 vs Python 3</span></h2>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="nlsocket.html">pymnl.nlsocket Module</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="api-checklist.html">libmnl to pymnl API checklist</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="using-pymnl-with-python-2-vs-python-3">
<h1>Using pymnl with Python 2 vs Python 3<a class="headerlink" href="#using-pymnl-with-python-2-vs-python-3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="using-pymnl-with-python-2">
<h2>Using pymnl With Python 2<a class="headerlink" href="#using-pymnl-with-python-2" title="Permalink to this headline">¶</a></h2>
<div class="section" id="recommend-using-b-for-strings">
<h3>Recommend Using b'' For Strings<a class="headerlink" href="#recommend-using-b-for-strings" title="Permalink to this headline">¶</a></h3>
<p>To help you remember that strings are treated as 8-bit (non-unicode), use
the b'' decoration on strings headed for Netlink.  If you want to hardcode
the genl family name nl80211 in your script, using b'nl80211' should
highlight the type of the string.  While this is not vital in Py2, it will
make it easier to transfer your code to Py3 in the future.</p>
</div>
<div class="section" id="attr-expects-8-bit-strings">
<h3>Attr Expects 8-bit Strings<a class="headerlink" href="#attr-expects-8-bit-strings" title="Permalink to this headline">¶</a></h3>
<p>Attr.new_str() and Attr.new_strz() expect an 8-bit (non-unicode) string.
Because this is the default type for Py2 strings, no special considerations
are required, but it is recommended to use the b'' decoration as shown
above.</p>
</div>
<div class="section" id="examples-use-future-print">
<h3>Examples Use __future__ print()<a class="headerlink" href="#examples-use-future-print" title="Permalink to this headline">¶</a></h3>
<p>To be compatible with Py2 and Py3, the example scripts in ./examples/ use
the new print function included starting in Python 2.6.  I.E.:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
</pre></div>
</div>
<p>While the library should work with Python versions greater than 2.4, the
examples, as written, require at least Python 2.6.</p>
</div>
</div>
<div class="section" id="using-pymnl-with-python-3">
<h2>Using pymnl With Python 3<a class="headerlink" href="#using-pymnl-with-python-3" title="Permalink to this headline">¶</a></h2>
<div class="section" id="bytes-versus-string">
<h3>bytes Versus string<a class="headerlink" href="#bytes-versus-string" title="Permalink to this headline">¶</a></h3>
<p>pymnl uses 8-bit (non-unicode) strings.  Passing unicode strings into pymnl
will cause problems, either immediately or once your data is passed to
Netlink.  To ensure your strings are of the right type, use the b''
decoration.  So, the hardcoded genl family name nl80211 in your script
should be written as b'nl80211'.</p>
<p>Conversely, the strings coming out of Netlink are 8-bit and will print like
b'string'.  At some point, you may want to decode the bytes into a string.
In Python 3.x, this code snippet (adapted from genl-family-get.py):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">print</span><span class="p">(</span><span class="s">&quot;name=</span><span class="si">%s</span><span class="se">\t</span><span class="s">id=</span><span class="si">%u</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">],</span> <span class="n">attrs</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="s">&quot;name=</span><span class="si">%s</span><span class="se">\t</span><span class="s">id=</span><span class="si">%u</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">attrs</span><span class="p">[</span><span class="s">&#39;name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">decode</span><span class="p">(),</span> <span class="n">attrs</span><span class="p">[</span><span class="s">&#39;id&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<p>would have an output similar to this:</p>
<div class="highlight-python"><div class="highlight"><pre>name=b&#39;nl80211&#39; id=17
name=nl80211    id=17
</pre></div>
</div>
</div>
<div class="section" id="id1">
<h3>Attr Expects 8-bit Strings<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Attr.new_str() and Attr.new_strz() expect an 8-bit (non-unicode) string.
To ensure that you are passing the correct string type, use strings.encode().
An example (adapted from genl-family-get.py):</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">Attr</span><span class="o">.</span><span class="n">new_strz</span><span class="p">(</span><span class="n">CTRL_ATTR_FAMILY_NAME</span><span class="p">,</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</pre></div>
</div>
<p>Notice that sys.argv[1] is encoded before being passed to new_strz().</p>
</div>
<div class="section" id="attr-returns-8-bit-strings">
<h3>Attr Returns 8-bit Strings<a class="headerlink" href="#attr-returns-8-bit-strings" title="Permalink to this headline">¶</a></h3>
<p>Attr.get_str_stripped() and Attr.get_str() return an 8-bit string, which
in Py3 is a bytes.  An example, while code in Py2 would return &quot;nl80211&quot;
(without double quotes), Py3 will return &quot;b'nl80211'&quot; (with single quotes,
but without double quotes).  So, be aware that the return value will be a
bytes in Py3, but a string in Py2.</p>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="nlsocket.html">pymnl.nlsocket Module</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="api-checklist.html">libmnl to pymnl API checklist</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Sean Robinson.
      Last updated on 2015-03-21.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>