'\" t
.\"     Title: cdist-type__consul_agent
.\"    Author: Steven Armstrong <steven-cdist--@--armstrong.cc>
.\" Generator: DocBook XSL Stylesheets v1.78.1 <http://docbook.sf.net/>
.\"      Date: 03/19/2015
.\"    Manual: \ \&
.\"    Source: \ \&
.\"  Language: English
.\"
.TH "CDIST\-TYPE__CONSUL_" "7" "03/19/2015" "\ \&" "\ \&"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
cdist-type__consul_agent \- manage the consul agent
.SH "DESCRIPTION"
.sp
Configure and manage the consul agent\&.
.SH "REQUIRED PARAMETERS"
.sp
None\&.
.SH "OPTIONAL PARAMETERS"
.PP
acl\-datacenter
.RS 4
only used by servers\&. This designates the datacenter which is authoritative for ACL information\&.
.RE
.PP
acl\-default\-policy
.RS 4
either "allow" or "deny"; defaults to "allow"\&. The default policy controls the behavior of a token when there is no matching rule\&.
.RE
.PP
acl\-down\-policy
.RS 4
either "allow", "deny" or "extend\-cache"; "extend\-cache" is the default\&.
.RE
.PP
acl\-master\-token
.RS 4
only used for servers in the acl_datacenter\&. This token will be created with management\-level permissions if it does not exist\&. It allows operators to bootstrap the ACL system with a token ID that is well\-known\&.
.RE
.PP
acl\-token
.RS 4
when provided, the agent will use this token when making requests to the Consul servers\&.
.RE
.PP
acl\-ttl
.RS 4
used to control Time\-To\-Live caching of ACLs\&.
.RE
.PP
bind\-addr
.RS 4
sets the bind address for cluster communication
.RE
.PP
bootstrap\-expect
.RS 4
sets server to expect bootstrap mode
.RE
.PP
ca\-file\-source
.RS 4
path to a PEM encoded certificate authority file which will be uploaded and configure using the ca_file config option\&.
.RE
.PP
cert\-file\-source
.RS 4
path to a PEM encoded certificate file which will be uploaded and configure using the cert_file config option\&.
.RE
.PP
client\-addr
.RS 4
sets the address to bind for client access
.RE
.PP
datacenter
.RS 4
datacenter of the agent
.RE
.PP
encrypt
.RS 4
provides the gossip encryption key
.RE
.PP
group
.RS 4
the primary group for the agent
.RE
.PP
json\-config
.RS 4
path to a partial json config file without leading { and trailing }\&. If json\-config is
\fI\-\fR
(dash), take what was written to stdin as the file content\&.
.RE
.PP
key\-file\-source
.RS 4
path to a PEM encoded private key file which will be uploaded and configure using the key_file config option\&.
.RE
.PP
node\-name
.RS 4
name of this node\&. Must be unique in the cluster
.RE
.PP
retry\-join
.RS 4
address to attempt joining every retry_interval until at least one join works\&. Can be specified multiple times\&.
.RE
.PP
user
.RS 4
the user to run the agent as
.RE
.PP
state
.RS 4
if the agent is
\fIpresent\fR
or
\fIabsent\fR\&. Defaults to
\fIpresent\fR\&. Currently state=absent is not working due to some dependency issues\&.
.RE
.SH "BOOLEAN PARAMETERS"
.PP
disable\-remote\-exec
.RS 4
disables support for remote execution\&. When set to true, the agent will ignore any incoming remote exec requests\&.
.RE
.PP
disable\-update\-check
.RS 4
disables automatic checking for security bulletins and new version releases
.RE
.PP
leave\-on\-terminate
.RS 4
gracefully leave cluster on SIGTERM
.RE
.PP
rejoin\-after\-leave
.RS 4
rejoin the cluster using the previous state after leaving
.RE
.PP
server
.RS 4
used to control if an agent is in server or client mode
.RE
.PP
syslog
.RS 4
enables logging to syslog
.RE
.PP
verify\-incoming
.RS 4
enforce the use of TLS and verify a client\(cqs authenticity on incomming connections
.RE
.PP
verify\-outgoing
.RS 4
enforce the use of TLS and verify the peers authenticity on outgoing connections
.RE
.SH "EXAMPLES"
.sp
.if n \{\
.RS 4
.\}
.nf
# configure as server, bootstrap and rejoin
hostname="$(cat "$__global/explorer/hostname")"
__consul_agent \e
   \-\-datacenter dc1 \e
   \-\-node\-name "${hostname%%\&.*}" \e
   \-\-disable\-update\-check \e
   \-\-server \e
   \-\-rejoin\-after\-leave \e
   \-\-bootstrap\-expect 3 \e
   \-\-retry\-join consul\-01 \e
   \-\-retry\-join consul\-02 \e
   \-\-retry\-join consul\-03

# configure as server, bootstrap and rejoin with ssl support
hostname="$(cat "$__global/explorer/hostname")"
__consul_agent \e
   \-\-datacenter dc1 \e
   \-\-node\-name "${hostname%%\&.*}" \e
   \-\-disable\-update\-check \e
   \-\-server \e
   \-\-rejoin\-after\-leave \e
   \-\-bootstrap\-expect 3 \e
   \-\-retry\-join consul\-01 \e
   \-\-retry\-join consul\-02 \e
   \-\-retry\-join consul\-03 \e
   \-\-ca\-file\-source /path/to/ca\&.pem \e
   \-\-cert\-file\-source /path/to/cert\&.pem \e
   \-\-key\-file\-source /path/to/key\&.pem \e
   \-\-verify\-incoming \e
   \-\-verify\-outgoing

# configure as client and try joining existing cluster
__consul_agent \e
   \-\-datacenter dc1 \e
   \-\-node\-name "${hostname%%\&.*}" \e
   \-\-disable\-update\-check \e
   \-\-retry\-join consul\-01 \e
   \-\-retry\-join consul\-02 \e
   \-\-retry\-join consul\-03
.fi
.if n \{\
.RE
.\}
.SH "SEE ALSO"
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
cdist\-type(7)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
http://www\&.consul\&.io/docs/agent/options\&.html
.RE
.SH "COPYING"
.sp
Copyright (C) 2015 Steven Armstrong\&. Free use of this software is granted under the terms of the GNU General Public License version 3 (GPLv3)\&.
.SH "AUTHOR"
.PP
\fBSteven Armstrong\fR <\&steven\-cdist\-\-@\-\-armstrong\&.cc\&>
.RS 4
Author.
.RE
