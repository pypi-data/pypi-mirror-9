'\" t
.\"     Title: cdist-stages
.\"    Author: Nico Schottelius <nico-cdist--@--schottelius.org>
.\" Generator: DocBook XSL Stylesheets v1.78.1 <http://docbook.sf.net/>
.\"      Date: 02/10/2015
.\"    Manual: \ \&
.\"    Source: \ \&
.\"  Language: English
.\"
.TH "CDIST\-STAGES" "7" "02/10/2015" "\ \&" "\ \&"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
cdist-stages \- Stages used during configuration deployment
.SH "DESCRIPTION"
.sp
Starting the execution of deployment with cdist, cdist passes through different stages\&.
.SH "STAGE 1: TARGET INFORMATION RETRIEVAL"
.sp
In this stage information is collected about the target host using so called explorers\&. Every existing explorer is run on the target and the output of all explorers are copied back into the local cache\&. The results can be used by manifests and types\&.
.SH "STAGE 2: RUN THE INITIAL MANIFEST"
.sp
The initial manifest, which should be used for mappings of hosts to types, is executed\&. This stage creates objects in a cconfig database that contains the objects as defined in the manifest for the specific host\&. In this stage, no conflicts may occur, i\&.e\&. no object of the same type with the same id may be created, if it has different parameters\&.
.SH "STAGE 3: OBJECT INFORMATION RETRIEVAL"
.sp
Every object is checked whether its type has explorers and if so, these are executed on the target host\&. The results are transferred back and can be used in the following stages to decide what changes need to be made on the target to implement the desired state\&.
.SH "STAGE 4: RUN THE OBJECT MANIFEST"
.sp
Every object is checked whether its type has a executable manifest\&. The manifest script may generate and change the created objects\&. In other words, one type can reuse other types\&.
.sp
For instance the object \fIapache/www\&.example\&.org is of type \fRapache, which may contain a manifest script, which creates new objects of type __file\&.
.sp
The newly created objects are merged back into the existing tree\&. No conflicts may occur during the merge\&. A conflict would mean that two different objects try to create the same object, which indicates a broken configuration\&.
.SH "STAGE 5: CODE GENERATION"
.sp
In this stage for every created object its type is checked for executable gencode scripts\&. The gencode scripts generate the code to be executed on the target on stdout\&. If the gencode executables fail, they must print diagnostic messages on stderr and exit non\-zero\&.
.SH "STAGE 6: CODE EXECUTION"
.sp
For every object the resulting code from the previous stage is transferred to the target host and executed there to apply the configuration changes\&.
.SH "STAGE 7: CACHE"
.sp
The cache stores the information from the current run for later use\&.
.SH "SUMMARY"
.sp
If, and only if, all the stages complete without an errors, the configuration will be applied to the target\&.
.SH "SEE ALSO"
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
cdist(1)
.RE
.sp
.RS 4
.ie n \{\
\h'-04'\(bu\h'+03'\c
.\}
.el \{\
.sp -1
.IP \(bu 2.3
.\}
cdist\-reference(7)
.RE
.SH "COPYING"
.sp
Copyright (C) 2010\-2012 Nico Schottelius, Steven Armstrong\&. Free use of this software is granted under the terms of the GNU General Public License version 3 (GPLv3)\&.
.SH "AUTHOR"
.PP
\fBNico Schottelius\fR <\&nico\-cdist\-\-@\-\-schottelius\&.org\&>
.RS 4
Author.
.RE
