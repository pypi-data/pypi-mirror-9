<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8"> 

<head>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap-theme.min.css">

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.3.14/angular.min.js"></script>
    <script src="http://angular-ui.github.io/bootstrap/ui-bootstrap-tpls-0.12.1.js"></script>
    <script src="http://www.google.com/jsapi?ext.js"></script>

    <style>
        body {
            padding: 20px!important;
        }

        .table thead > tr > th.orange {
            color: #FF9900;
            font-size: 10pt;
            text-align: right;
        }

        .agora-table {
            font-size: 8pt;
            text-align: right;
        }

        .table-extra-condensed > thead > tr > th,
        .table-extra-condensed > tbody > tr > th,
        .table-extra-condensed > tfoot > tr > th,
        .table-extra-condensed > thead > tr > td,
        .table-extra-condensed > tbody > tr > td,
        .table-extra-condensed > tfoot > tr > td {
            padding: 1px;
        }

        .red {
            font-weight: bold;
            color: #CC3300;
        }

        .green {
            font-weight: bold;
            color: #339900;
        }

        .soft-warning {
            background-color: #FFFF00!important;
        }

        .hard-warning {
            background-color: #FFA700!important;
        }

        .limit-breached {
            background-color: #FF3800!important;
        }

    </style>
</head>

<body ng-app="riskServerApp" >

    <!-- header -->
    <div class="page-header container-fluid">

        <!--
        <div class="row">
            <div class="pull-left">
                <h2>Risk Server</h2>
            </div>
        </div>
        -->

        <div class="row">
            <div class="pull-right" ng-controller="ReportCtrl">
                <form class="form-inline">
    
                    <div class="input-group">
                        <select class="form-control"
                                ng-model="fundSelected"
                                ng-options="fund for fund in funds">
                        </select>
                    </div>
    
                    <div class="input-group">
                        <select class="form-control"
                                ng-model="portSelected"
                                ng-options="port for port in info.portfolios">
                        </select>
                    </div>
        
                    <div class="input-group">
                        <input type="text" class="form-control" datepicker-popup="dd-MMMM-yyyy"
                               ng-model="dateSelected" is-open="opened" ng-required="true" close-text="Close"/>
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-default" ng-click="openCalendar($event)">
                                <i class="glyphicon glyphicon-calendar"></i>
                            </button>
                        </span>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div class="container-fluid">
        <div class="row">

            <div class="col-sm-2">
                <ul class="nav nav-pills nav-stacked">
                    <li role="presentation" class="active">
                        <a href="#positions" data-toggle="pill">Positions</a>
                    </li>
                    <li role="presentation">
                        <a href="#exposures" data-toggle="pill">Risk Exposures</a>
                    </li>
                    <li role="presentation">
                        <a href="#attributions" data-toggle="pill">Risk Attributions</a>
                    </li>
                    <li role="presentation">
                        <a href="#stress" data-toggle="pill">Stress Scenarios</a>
                    </li>
                    <li role="presentation">
                        <a href="#commodity" data-toggle="pill">Commodity Exposures</a>
                    </li>
                    <li role="presentation">
                        <a href="#whatif" data-toggle="pill">What-If Analysis</a>
                    </li>
                    <li role="presentation">
                        <a href="#admin" data-toggle="pill">Administration</a>
                    </li>
                </ul>
            </div>

            <div class="tab-content col-sm-10">
                <div role="tabpanel" class="tab-pane active" id="positions">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Positions</h3>
                        </div>
                        <div ng-include src="'templates/positions.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="exposures">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Risk Exposures</h3>
                        </div>
                        <div ng-include src="'templates/exposures.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="attributions">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Risk Attributions</h3>
                        </div>
                        <div ng-include src="'templates/attributions.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="stress">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Stress Scenarios</h3>
                        </div>
                        <div ng-include src="'templates/stress.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="commodity">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Commodity Exposures</h3>
                        </div>
                        <div ng-include src="'templates/commod.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="whatif">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">What-If Analysis</h3>
                        </div>
                        <div ng-include src="'templates/whatif.tpl.html'"></div>
                    </div>
                </div>

                <div role="tabpanel" class="tab-pane" id="admin">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Administration</h3>
                        </div>
                        <div class="panel-body"></div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="modules/agoraServices.js"></script>
    <script src="modules/agoraFormatters.js"></script>
    <script src="modules/agoraGoogleCharts.js"></script>

    <script>
        angular.module("riskServerApp", ["ui.bootstrap",
                                         "agoraServices", "agoraFormatters", "agoraGoogleCharts"])

            .factory("baseValidator", function(){
                // base validator: sets warnings at 80%, 90% and 100% of the set limit
                return function(value, limit){
                    if (value > 1.0*limit){ return "limit-breached"; };
                    if (value > 0.9*limit){ return "hard-warning"; };
                    if (value > 0.8*limit){ return "soft-warning"; };
                    return "plain";
                 };
            });

        google.setOnLoadCallback(function(){
            angular.bootstrap(document.body, ["riskServerApp"]);
        });
        google.load("visualization", "1", {packages: ["corechart"]});
    </script>

    <script src="controllers/report.js"></script>
    <script src="controllers/positions.js"></script>
    <script src="controllers/exposures.js"></script>
    <script src="controllers/attributions.js"></script>
    <script src="controllers/stress.js"></script>
    <script src="controllers/commod.js"></script>
    <script src="controllers/whatif.js"></script>

</body>
</html>